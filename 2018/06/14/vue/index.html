<!DOCTYPE HTML>
<html lang="zh-CN">


<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    <meta name="keywords" content="Vue + Webpack, HTML CSS JavaScript">
    <meta name="description" content="Vue简介Vue是一款用于动态构建用户界面的渐进式JavaScript框架, 核心功能是基于 MVVM 架构模式的视图模板引擎
MVVMMVC ( Model-View-Controller )和 MVVM (Model-View-View">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Vue + Webpack | Mon</title>
    <link rel="icon" type="image/png" href="medias/ico.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">
    <style type="text/css">
        
    </style>

    <script src="/libs/jquery/jquery-2.2.0.min.js"></script>
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


<body>

<header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/hi.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Mon</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fa fa-navicon"></i></a>
<ul class="right">
    
    <li class="hide-on-med-and-down">
        <a href="/" class="waves-effect waves-light">
            
            <i class="fa fa-home"></i>
            
            <span>首页</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/tags" class="waves-effect waves-light">
            
            <i class="fa fa-tags"></i>
            
            <span>标签</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/categories" class="waves-effect waves-light">
            
            <i class="fa fa-bookmark"></i>
            
            <span>分类</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/archives" class="waves-effect waves-light">
            
            <i class="fa fa-archive"></i>
            
            <span>归档</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/about" class="waves-effect waves-light">
            
            <i class="fa fa-user-circle-o"></i>
            
            <span>关于</span>
        </a>
    </li>
    
    <li>
        <a href="#searchModal" class="modal-trigger waves-effect waves-light">
            <i id="searchIcon" class="fa fa-search" title="搜索"></i>
        </a>
    </li>
</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="medias/hi.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Mon</div>
        <div class="logo-desc">
            
            Some Essays about H5
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li>
            <a href="/" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-home"></i>
                
                首页
            </a>
        </li>
        
        <li>
            <a href="/tags" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-tags"></i>
                
                标签
            </a>
        </li>
        
        <li>
            <a href="/categories" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-bookmark"></i>
                
                分类
            </a>
        </li>
        
        <li>
            <a href="/archives" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-archive"></i>
                
                归档
            </a>
        </li>
        
        <li>
            <a href="/about" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-user-circle-o"></i>
                
                关于
            </a>
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/TendernessCJS" class="waves-effect waves-light" target="_blank">
                <i class="fa fa-github-square fa-fw"></i>My GitHub
            </a>
        </li>
        
    </ul>
</div>

        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/TendernessCJS" class="github-corner tooltipped hide-on-med-and-down" target="_blank" data-tooltip="My GitHub" data-position="left" data-delay="50">
    <svg viewbox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/>
    </svg>
</a>
        
    </nav>

</header>





<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/14.jpg')">
    <div class="container">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <div class="description center-align post-title">
                        Vue + Webpack
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 20px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/Vue/" target="_blank">
                                <span class="chip bg-color">Vue</span>
                            </a>
                        
                            <a href="/tags/Webpack/" target="_blank">
                                <span class="chip bg-color">Webpack</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fa fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/Vue/" class="post-category" target="_blank">
                                Vue
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                <div class="post-date info-break-policy">
                    <i class="fa fa-calendar-minus-o fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2018-06-14
                </div>

                
                    
                    <div class="info-break-policy">
                        <i class="fa fa-file-word-o fa-fw"></i>文章字数:&nbsp;&nbsp;
                        27.4k
                    </div>
                    

                    
                    <div class="info-break-policy">
                        <i class="fa fa-clock-o fa-fw"></i>阅读时长:&nbsp;&nbsp;
                        117 分
                    </div>
                    
                
				
				
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="fa fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="Vue简介"><a href="#Vue简介" class="headerlink" title="Vue简介"></a>Vue简介</h2><p>Vue是一款用于<font color="yellowgreen">动态构建用户界面</font>的<font color="yellowgreen">渐进式</font>JavaScript框架, 核心功能是基于 <font color="tomato"><strong>MVVM</strong></font> 架构模式的视图模板引擎</p>
<h3 id="MVVM"><a href="#MVVM" class="headerlink" title="MVVM"></a>MVVM</h3><p><strong>MVC</strong> ( Model-View-Controller )和 <strong>MVVM</strong> (Model-View-ViewModel) 都是前端开发的<font color="yellowgreen">架构模式</font>, <strong>MVVM</strong> 的本质是 <strong>MVC</strong> 的<font color="tomato"><strong>改进版</strong></font></p>
<h4 id="MVVM的出现"><a href="#MVVM的出现" class="headerlink" title="MVVM的出现"></a>MVVM的出现</h4><p>在HTML5兴起前, 标准的Web应用程式由三部分组成:</p>
<ol>
<li>View: 把数据以某种方式呈现给用户</li>
<li>Model: 数据模型, 就是从后台接收到的数据</li>
<li>Controller: 接收并处理用户的请求, 返回对应的 Model 给用户</li>
</ol>
<p>当时Web应用的 View 层相对比较简单, 前端所需要的数据基本在后端可以处理好 ( 这也是一些 <strong>老项目前后端不分离</strong> 的原因 ), View 层主要负责数据展示, 而复杂的业务逻辑由 Controller 来处理, MVC架构模式是当时Web应用的最佳实践</p>
<p>随着H5的兴起, H5为移动设备提供了一些非常有用的功能( API ), 使得H5具备开发App的能力, 实现<font color="yellowgreen">跨平台, 快速迭代和上线, 节省人力成本并提高开发效率</font>, 但同时也使得 View 层不再是简单的数据展示, 还得管理复杂的数据状态以及处理移动设备的各种操作行为, MVC发展成:</p>
<ol>
<li>View: 展示数据, 整体UI布局</li>
<li>Model: 接收并管理数据</li>
<li>Controller: 响应用户操作, 并将 Model 更新到 View 上</li>
</ol>
<p>这种 MVC 架构模式对于简单的应用是OK的, 也符合软件架构的分层思想, 但随着H5的发展, 前端应用的复杂程度越发复杂, <strong>前后端逐渐分离</strong>, 而前端开发暴露出三个痛心的问题:</p>
<ol>
<li>开发者在代码中大量调用相同的 DOM API, 处理繁琐, 操作冗余, 代码难以维护</li>
<li>大量的DOM操作是的页面渲染性能降低, 加载速度变慢, 影响用户体验</li>
<li>当 Model 频繁变动, 开发者需要主动更新到 View; 同样, 当用户操作导致数据发生变化, 开发者需要主动将更新后的数据同步到 Model 中, 工作繁琐且难以维护复杂多变的数据状态</li>
</ol>
<p>此时, 早期提倡的 “Write less, do more”的 jQuery 就是为了简化DOM操作而设计的, 但这仅仅解决了第一个问题, 前端开发依旧繁琐而艰难</p>
<font color="tomato"><strong>MVVM 的出现, 完美解决了以上三个问题</strong></font>

<p>MVVM 由 Model, View, ViewModel 组成:</p>
<ol>
<li>Model: 数据模型, 定义修改数据和处理业务逻辑</li>
<li>View: 视图(UI组件), 负责将数据模型转化成UI展现给用户</li>
<li><strong>ViewModel</strong> 是一个同步 View 和 Model 的对象(核心), 通过双向数据绑定把 View 和 Model 连接起来, 且 View 和 Model 的同步工作是完全自动的, 无需人为干涉, 因此开发者只需关注业务逻辑, 不再需要主动操作DOM, 也无需担心数据状态的同步问题, 所有繁琐艰难的操作全交给 ViewModel 实现</li>
</ol>
<p><img src="/images/MVVM.jpg" alt="MVVM架构模式"></p>
<font color="tomato"><strong>ViewModel</strong> 是 Vue.js 的核心, 是Vue的一个实例</font>

<p><strong>DOM Listeners</strong> (DOM监听器) 和 <strong>Data Bindings</strong> (数据绑定) 是 <strong>View Model</strong> 实现双向绑定的关键:</p>
<ol>
<li><strong>DOM Listeners</strong> 会监测页面上 <strong>DOM</strong> 元素的变化, 更新 <strong>Model</strong> 中的数据 </li>
<li>当 <strong>Model</strong> 中数据更新时, <strong>Data Bindings</strong> 会刷新页面中的 <strong>DOM</strong> 元素</li>
</ol>
<h4 id="ViewModel核心实现"><a href="#ViewModel核心实现" class="headerlink" title="ViewModel核心实现"></a>ViewModel核心实现</h4><p>在MVVM架构模式下, <font color="yellowgreen">View</font> 和 <font color="yellowgreen">Model</font> 之间没有 <strong>直接的联系</strong>, 而是通过 <font color="yellowgreen">ViewModel</font> ( 简称: <font color="yellowgreen">VM</font> ) 进行交互, 而 <font color="yellowgreen">VM</font> 可以通过 <font color="deepskyblue"><strong>观察者模式</strong></font> 或者 <font color="deepskyblue"><strong>订阅发布模式</strong></font> 2种模式实现</p>
<p>在 <font color="tomato"><strong>Vue.js</strong></font> 中 <font color="yellowgreen"><strong>vm实例</strong></font> 的核心是 <strong>对象劫持</strong>, 采用 <code>Object.defineProperty</code> 的 <code>getter</code> 和 <code>setter</code>, 结合 <font color="deepskyblue"><strong>观察者模式</strong></font> 实现 <font color="deep">对象劫持 ( defineProperty )</font> 和 <font color="deep">模板编译 ( complier )</font> 的响应</p>
<p><img src="/images/Vue.jpg" alt="Vue核心"></p>
<ol>
<li><strong>Observer</strong> 数据监听器( 观察者 ), 内部通过 <code>Object.defineProperty</code>的<code>getter</code>和<code>setter</code>实现, 对劫持对象的所有属性进行监听, 如有变动获取最新值并通知订阅者( <strong>Watcher</strong> )</li>
<li><strong>Compile</strong> 指令解析器, 对每个DOM元素节点的指令进行扫描和解析, 根据指令模板替换数据, 并绑定响应的更新( 回调 )函数</li>
<li><strong>Watcher</strong> 订阅者, 连接 <strong>Observer</strong> 和 <strong>Compile</strong>, 订阅并接收每个属性的变动通知, 执行对应的更新( 回调 )函数</li>
<li><strong>Dep</strong> 消息订阅器( 公众号 ), 内部维护一个数组, 收集所有订阅者( <strong>Watcher</strong> ), 数据变动执行<code>Dep.notify()</code>函数, 再调用订阅者的<code>Watcher.update()</code>方法</li>
</ol>
<font color="yellowgreen"><strong>Vue 工作流程</strong></font>

<p>当执行<code>new Vue()</code>时, VM实例进入初始化阶段, 一方面遍历实例<code>data</code>配置项中的属性并劫持, 监听劫持属性; 另一方面, Compile 编译器对元素节点的指令进行扫描和解析, 初始化视图, 并订阅 Watcher 来更新视图, Watcher 将自己添加到 Dep 管理的数组中, 初始化完毕</p>
<font color="deepskyblue">当数据发生变化时, <code>Ovserver</code> 的 <code>setter</code> 方法被触发, <code>setter</code> 会立即调用<code>Dep.notify()</code>, <code>Dep</code>开始遍历所有订阅者(<code>Watcher</code>), 并调用<code>Watcher.update()</code>, 订阅者接收到哦通知后对视图进行响应的更新</font>

<h3 id="了解Vue的渐进式"><a href="#了解Vue的渐进式" class="headerlink" title="了解Vue的渐进式"></a>了解Vue的渐进式</h3><p>符合MVVM架构模式的前端三大框架: <strong>Angular</strong>、<strong>React</strong>、<strong>Vue</strong></p>
<p>其中 <strong>Vue</strong> 是国内中小型项目首选的框架, Vue 的实现:</p>
<ol>
<li>借鉴了 <strong>Angular</strong> 的<font color="yellowgreen">模板</font>和<font color="yellowgreen">数据绑定</font>技术</li>
<li>借鉴了 <strong>React</strong> 的<font color="yellowgreen">组件化</font>和<font color="yellowgreen">虚拟DOM</font>技术</li>
</ol>
<p><strong>Vue</strong> 是一款渐进式框架, 即本身有一个<font color="deepskyblue">轻量级的核心库</font>( <font color="yellowgreen">Vue.js Core</font> ), <font color="deepskyblue">核心库只关注视图层</font>( <font color="yellowgreen">View</font> ), 开发者在构建界面时可根据需要添加插件( <font color="yellowgreen">Vue 全家桶</font>)或者第三方库进行拓展, 而且 <font color="yellowgreen">Vue 全家桶</font>是互相独立的功能, 在<font color="deepskyblue">核心库</font>的基础上可任意选用, 不一定要全部整合在一起</p>
<p><img src="/images/vuejianjinshi.png" alt="Vue的渐进式"></p>
<h2 id="声明式渲染"><a href="#声明式渲染" class="headerlink" title="声明式渲染"></a>声明式渲染</h2><h3 id="Vue-和-jQuery-对比"><a href="#Vue-和-jQuery-对比" class="headerlink" title="Vue 和 jQuery 对比"></a>Vue 和 jQuery 对比</h3><h4 id="使用对比1"><a href="#使用对比1" class="headerlink" title="使用对比1"></a>使用对比1</h4><p>需求: 数据回显, 将后台返回的数据( 伪数据 )渲染到页面上</p>
<p>jQuery</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
姓名: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>
年龄: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>age<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>
班级: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>className<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>js/jquery.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
    <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">'Tenderness'</span><span class="token punctuation">,</span>
        age<span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
        className<span class="token punctuation">:</span> <span class="token string">'electronic commerce'</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#name'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#age'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#className'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>className<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
<p>Vue</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>box<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    姓名: {{name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>
    年龄: {{age}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>
    班级: {{className}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>js/vue.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
    <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">'Tenderness'</span><span class="token punctuation">,</span>
        age<span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
        className<span class="token punctuation">:</span> <span class="token string">'electronic commerce'</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        el<span class="token punctuation">:</span> <span class="token string">'#box'</span><span class="token punctuation">,</span>
        data
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
<h4 id="使用对比2"><a href="#使用对比2" class="headerlink" title="使用对比2"></a>使用对比2</h4><p>需求: 数据绑定, 将用户输入信息直接回显到页面上</p>
<p>jQuery ( <font color="tomato">在以下demo中, jQuery只能做到储存数据和回显数据, 并未实现数据绑定</font> )</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>user<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>
你输入的是: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>js/jquery.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
    <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
        msg<span class="token punctuation">:</span> <span class="token string">''</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#user'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        data<span class="token punctuation">.</span>msg <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> user <span class="token operator">=</span> data<span class="token punctuation">.</span>msg
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#text'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
<p>Vue</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>box<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>msg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>
    你输入的是: {{msg}}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>js/vue.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
    <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        el<span class="token punctuation">:</span> <span class="token string">'#box'</span><span class="token punctuation">,</span>
        data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            msg<span class="token punctuation">:</span> <span class="token string">''</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
<h4 id="对比结论"><a href="#对比结论" class="headerlink" title="对比结论"></a>对比结论</h4><p>通过以上两简单的使用对比可以发现, 使用 <strong>Vue</strong> 能大量减少 <strong>DOM操作</strong> 并实现 <strong>数据双向绑定</strong></p>
<h3 id="Vue实例"><a href="#Vue实例" class="headerlink" title="Vue实例"></a>Vue实例</h3><p>语法: <code>var vm = new Vue({ /*选项*/ })</code></p>
<p>在创建Vue实例时, 可以传入一个 <strong>配置对象</strong>, 以下列表是配置对象可选的 <strong>配置项</strong></p>
<h4 id="数据相关配置项"><a href="#数据相关配置项" class="headerlink" title="数据相关配置项"></a>数据相关配置项</h4><table>
<thead>
<tr>
<th>配置项</th>
<th>接收类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><font color="yellowgreen">data</font></td>
<td>Object/Function</td>
<td>Vue实例的数据对象</td>
</tr>
<tr>
<td><font color="yellowgreen">props</font></td>
<td>Array/Object</td>
<td>接收来自父组件的数据</td>
</tr>
<tr>
<td><font color="yellowgreen">computed</font></td>
<td>{[key: String]: Function}</td>
<td>储存计算属性的对象</td>
</tr>
<tr>
<td><font color="yellowgreen">methods</font></td>
<td>{[key: String]: Function}</td>
<td>储存实例方法的对象</td>
</tr>
<tr>
<td><font color="yellowgreen">watch</font></td>
<td>{[key: String]: Function/Object}</td>
<td>储存监测函数的对象</td>
</tr>
</tbody>
</table>
<p>注意点:</p>
<ol>
<li><p>在定义 <strong>组件</strong> 时, <font color="yellowgreen">data</font> 只能接收<code>Function</code>, 该函数返回真正的数据对象, 原因是<font color="deepskyblue">引用数据共享问题</font></p>
</li>
<li><p><a href="#props"><font color="tomato">对于 <font color="yellowgreen">props</font> 的描述, 放在 <strong>Vue组件</strong> 部分</font></a></p>
</li>
<li><p><font color="yellowgreen">computed</font> 对象中的方法需要有<font color="deepskyblue">返回值</font>, 该返回值就是计算属性值</p>
</li>
<li><p><font color="yellowgreen">watch</font> 对象中的<code>key</code>键在 <font color="yellowgreen">data</font> 中必须有对应的<code>key</code>键一一对应, 绑定的监测函数接收2参数, 第一个参数是监测属性的当前值(变化后的值), 第二个参数表示监测属性旧值(变化前的值)</p>
</li>
<li><p><font color="yellowgreen">methods</font>、<font color="yellowgreen">computed</font>、<font color="yellowgreen">watch</font> 三者的区别:</p>
<p>a) <font color="yellowgreen">methods</font> 中的方法是经常 <strong>被实例主动调用</strong> 的方法</p>
<p>b) <font color="yellowgreen">computed</font> 中的方法在 <strong>实例初始化</strong> 时会 <strong>立即执行</strong>, 得到返回值(计算属性), 并<font color="deepskyblue">混入到实例中</font>并 <font color="deepskyblue"><strong>缓存</strong></font> 起来, 当依赖的 <strong>响应式属性</strong> 发生变化, 会 <strong>自动执行</strong> 对应方法, 并把最新计算属性值缓存(更新)</p>
<p>c) <font color="yellowgreen">watch</font> 中的方法在 <strong>实例初始化</strong> 后会 <strong>自动监测</strong> <font color="yellowgreen">data</font> 中的数据变化, 当监听的数据发生变化 <strong>自动执行</strong> 对应监测函数, 实现相关业务逻辑( 如数据存储等 )</p>
</li>
<li><font color="yellowgreen">methods</font>、<font color="yellowgreen">computed</font>、<font color="yellowgreen">watch</font> 对象中的方法不建议使用 <strong>箭头函数</strong>, 原因是<code>this</code>指向发生变化, 不再指向<font color="deepskyblue">Vue实例</font>
</li>
<li><p><font color="yellowgreen">computed</font> 中的对象用法( 即<code>getter</code>和<code>setter</code>)</p>
<pre class=" language-js"><code class="language-js"><span class="token comment" spellcheck="true">// 首先, 计算属性默认只有getter, 不过可以通过对象的写法为计算属性提供一个setter</span>
<span class="token keyword">var</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        firstName<span class="token punctuation">:</span> <span class="token string">'Tenderness'</span><span class="token punctuation">,</span>
        lastName<span class="token punctuation">:</span> <span class="token string">'Chen'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        fullName<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>firstName <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lastName
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token keyword">set</span><span class="token punctuation">(</span>newVal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment" spellcheck="true">// 当计算属性fullName放生改变时, vm.firstName和vm.lastName也会响应更新</span>
                <span class="token keyword">let</span> newName <span class="token operator">=</span> newVal<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>firstName <span class="token operator">=</span> newName<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>lastName <span class="token operator">=</span> newName<span class="token punctuation">[</span>newName<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
</li>
<li><p><font color="yellowgreen">watch</font> 中的键值对(<code>k:v</code>), 值为对象的使用方法</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">var</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        a<span class="token punctuation">:</span> <span class="token string">'基本数据类型'</span><span class="token punctuation">,</span>
        b<span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'对象1'</span><span class="token punctuation">,</span> age<span class="token punctuation">:</span> <span class="token number">16</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'对象2'</span><span class="token punctuation">,</span> age<span class="token punctuation">:</span> <span class="token number">17</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'对象3'</span><span class="token punctuation">,</span> age<span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    watch<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        a<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token function">handler</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span> oldVal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'val: '</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'old: '</span><span class="token punctuation">,</span> oldVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            immediate<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token comment" spellcheck="true">// 绑定监测函数后, 立即执行一次</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        b<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token function">handler</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span> oldVal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment" spellcheck="true">// 引用类型数据的性质(都是指针), val和oldVal是一样的值</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'val: '</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'old: '</span><span class="token punctuation">,</span> oldVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            deep<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token comment" spellcheck="true">// 深度(递归)监测, 当数组b中对象内属性发生变化时会执行监测函数</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
</li>
</ol>
<h4 id="DOM相关配置项"><a href="#DOM相关配置项" class="headerlink" title="DOM相关配置项"></a>DOM相关配置项</h4><table>
<thead>
<tr>
<th>配置项</th>
<th>接收类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><font color="yellowgreen">el</font></td>
<td>String/Element</td>
<td>提供 <font color="tomato"><strong>一个</strong></font> 页面中已存在的DOM元素作为 Vue 实例的挂载目标</td>
</tr>
<tr>
<td><font color="yellowgreen">template</font></td>
<td>String</td>
<td>提供一个字符串模板作为 Vue 实例的标识使用</td>
</tr>
<tr>
<td><font color="yellowgreen">render</font></td>
<td>Function</td>
<td>使用<code>render</code>函数创建虚拟DOM</td>
</tr>
</tbody>
</table>
<p>注意点</p>
<ol>
<li><p><font color="yellowgreen"><strong>el</strong></font> 相关:</p>
<p>a) <font color="yellowgreen">el</font> 只在由<code>new</code>关键字创建的实例中遵守, 建议使用 <font color="tomato"><strong>id选择器</strong></font> 与实例一一对应</p>
<p>b) 提供的元素只作为 <strong>挂载点</strong>, <font color="yellowgreen">所有的挂载元素会被 Vue 生成的 DOM 替换</font>, 因此 <font color="tomato"><strong>禁止</strong></font> 将实例挂载到<code>&lt;html&gt;</code>或者<code>&lt;body&gt;</code>中</p>
<p>c) 当 <font color="yellowgreen">template</font> 和 <font color="yellowgreen">render</font> 都不存在,  提供的挂在元素会被提取出来作为模板, 此时需要使用 <font color="deepskyblue"><strong>Runtime + Compiler</strong></font> (运行时 + 编译器) 构建的 Vue 库</p>
<p>d) 当 <strong>实例挂载</strong> 完成, <strong>根元素</strong> 可以通过<code>vm.$el</code>访问</p>
<p>e) 如果有 <font color="yellowgreen">el</font> 配置项, 实例会立即进入编译过程, 否则需要调用<code>vm.$mount()</code>手动开启编译</p>
</li>
<li><p><font color="yellowgreen"><strong>template</strong></font>相关</p>
<p>a) 模板会 <strong>替换</strong> 挂载元素, 挂载元素的内容将被忽略, 除非模板内容有分发 <strong>插槽</strong></p>
<p>b) 模板内容需要有一个 <strong>根元素</strong> 包裹着</p>
<p>c) <font color="yellowgreen">建议模板和 JavaScript 代码分离</font>, 常用技巧:</p>
<pre class=" language-html"><code class="language-html"><span class="token comment" spellcheck="true">&lt;!-- 方式1 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/x-template<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>myTemp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
        <span class="token comment" spellcheck="true">&lt;!-- 模板内容 --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!-- 方式2 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>myTemp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
        <span class="token comment" spellcheck="true">&lt;!-- 模板内容 --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!-- 
注意: 移上2中方法中, script 和 template 标签都只做环境, 不会在页面上渲染, 模板内容需要有一层根元素包裹 
--></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
    <span class="token keyword">var</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`#myTemp`</span></span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
<p>d) 如果 <font color="yellowgreen">render</font> 函数存在, <font color="yellowgreen">template</font> 配置项将被忽略</p>
<p>e) 如果 <font color="yellowgreen">render</font> 函数不存在, 需要使用 <font color="deepskyblue"><strong>Runtime + Compiler</strong></font> (运行时 + 编译器) 构建的 Vue 库</p>
</li>
<li><p><font color="yellowgreen"><strong>render</strong></font> 相关</p>
<p>a) 设置了 <font color="yellowgreen">render</font> 函数, Vue实例就不会从配置项 <font color="yellowgreen">template</font> 或者 <font color="yellowgreen">el</font> 提取的 <code>innerHTML</code> 作为模板编译渲染函数</p>
<p>b) <a href="#render"><font color="tomato">对于 <font color="yellowgreen">render</font> 函数的更多描述, 放在 <strong>Vue+Webpack</strong> 部分</font></a>.</p>
</li>
</ol>
<h4 id="其他配置项"><a href="#其他配置项" class="headerlink" title="其他配置项"></a>其他配置项</h4><p>在创建Vue实例时, 还可以接受更多配置项, 如 <strong>生命周期钩子</strong>、<strong>自定义指令</strong>、<strong>组件</strong>、<strong>混入</strong> 等, 对于这些配置项的描述, 将在对应部分描述</p>
<h3 id="模板语法"><a href="#模板语法" class="headerlink" title="模板语法"></a>模板语法</h3><p>Vue.js 使用了基于 HTML 的模板语法，允许开发者声明式地将 DOM 绑定至底层 Vue 实例的数据, 实现动态 html 页面, 主要包含2类: a) <code>Mustache</code>语法(双大括号), 放在元素的<font color="yellowgreen">文本内容</font>中 b) 指令, 以<code>v-</code>开头放置在元素<font color="yellowgreen">标签属性</font>上</p>
<h4 id="Mustache语法"><a href="#Mustache语法" class="headerlink" title="Mustache语法"></a>Mustache语法</h4><p>往元素文本内容中 <strong>插值</strong> </p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>姓名: {{name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>年龄: {{age}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
    <span class="token comment" spellcheck="true">&lt;!-- 支持简单的JS表达式, 但不支持语句 --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>性别: {{age?'男':'女'}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>

    <span class="token comment" spellcheck="true">&lt;!-- 显示结果:
            姓名: Tenderness
            年龄: 18
            性别: 男
    --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>js/vue.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
    <span class="token keyword">var</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        el<span class="token punctuation">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
        data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            name<span class="token punctuation">:</span> <span class="token string">'Tenderness'</span><span class="token punctuation">,</span>
            sex<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            age<span class="token punctuation">:</span> <span class="token number">18</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
</code></pre>
<h4 id="指令"><a href="#指令" class="headerlink" title="指令"></a>指令</h4><ol>
<li><p><code>v-html</code>和<code>v-text</code>, 与<code>innerHTML</code>和<code>innerText</code>用法类似</p>
<p>注意点:</p>
<p>a) 在网络较差环境下, 使用<code>v-text</code>代替<code>Mustache</code>语法能避免未编译的双大括号表达式直接渲染在页面上的问题, 但<font color="tomato">不推荐</font>, 建议使用<code>v-cloak</code>解决</p>
<p>b) <font color="deep">谨慎使用</font><code>v-html</code>, 原因和<code>innerHTML</code>一样, 容易导致 <font color="tomato">XSS 攻击</font></p>
<p>c) <code>v-html</code>内部结构内容不会作为 Vue 模板进行编译, 因此在<font color="yellowgreen">单文件组件</font>( 即 <font color="deepskyblue"><strong>.vue</strong></font> 文件)中, <code>scoped</code>的样式不会应用在<code>v-html</code>内部</p>
</li>
<li><p><code>v-cloak</code>这个指令保持在元素上直到关联实例结束编译</p>
<p>注意点:</p>
<p>a) 不需要表达式, 相当于元素的一个属性</p>
<p>b) 配合CSS使用可以隐藏未编译的<code>Mustache</code>标签</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>v-cloak演示<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">
        <span class="token selector"><span class="token attribute">[v-cloak]</span> </span><span class="token punctuation">{</span>
            <span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span> <span class="token attr-name">v-cloak</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>姓名: {{name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>js/vue.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
    <span class="token keyword">var</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        el<span class="token punctuation">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
        data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            name<span class="token punctuation">:</span> <span class="token string">'Tenderness'</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
</code></pre>
</li>
<li><p><code>v-show</code>控制元素的显示隐藏</p>
<p>注意点:</p>
<p>a) <code>v-show=&quot;true&quot;</code> 显示( 使用元素默认的<code>display</code>样式 ), <code>v-show=&quot;false&quot;</code>隐藏(<code>display: none</code>)</p>
</li>
<li><p><code>v-once</code>只渲染元素或组件<strong>一次</strong></p>
<p>注意点:</p>
<p>a) Vue实例挂载时, 渲染一次, 然后该元素或组件将被视为静态内容, 即响应性数据发生变化时该元素不会发生变化</p>
</li>
<li><p><code>v-for</code>列表渲染, 基于源数据多次渲染元素或模板块</p>
<p>用法:</p>
<pre class=" language-html"><code class="language-html"><span class="token comment" spellcheck="true">&lt;!-- 遍历数组数据进行渲染 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>(item, index) in array<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token comment" spellcheck="true">&lt;!-- 遍历对象数据进行渲染 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>(val, key, index) in object<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token comment" spellcheck="true">&lt;!-- 接收整数多次渲染 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>n in number<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
</code></pre>
<p>注意点: </p>
<p>a) 在组件中使用<code>v-for</code>, 必须加上<code>key</code></p>
<p>b) 在同一元素中<code>v-for</code>和<code>v-if</code><strong>不建议</strong>一起使用</p>
</li>
<li><p><code>v-if</code>条件渲染系列</p>
<p>用法: </p>
<p>a) <code>v-if</code>根据表达式的布尔值判断是否渲染该元素</p>
<p>b) <code>v-else</code>和<code>v-else-if</code>配合<code>v-if</code>使用, 规则与<code>if-else</code>语句一样</p>
<p>注意点:</p>
<p>a) Vue会尽可能高效地渲染元素, 对已有元素会进行复用而不是重新渲染, 如果想让复用的元素重新渲染( 如用户切换登录方式时, <code>input</code>输入框重新渲染清空已输入值 ), 可以为复用元素加上<code>key</code>, 让元素重新渲染</p>
<p>b) <code>v-if</code>与<code>v-show</code>, <code>v-if</code>是 <strong>条件渲染</strong>, <code>v-show</code>只是简单的 <strong>控制CSS样式</strong> (元素已经被渲染); 两者相比, <code>v-if</code>有更高的切换开销, 而<code>v-show</code>有更高的初始渲染开销; 因此, 如果需要频繁切换使用<code>v-show</code>否则使用<code>v-if</code></p>
<p>c) <code>v-if</code>与<code>v-for</code>一起使用, 统一元素中<code>v-for</code>优先级比<code>v-if</code>高, 即每次循环都会进行<code>v-if</code>判断</p>
</li>
<li><p><code>v-bind</code>动态绑定特性或者组件<code>prop</code>到表达式</p>
<p>语法糖: <code>:</code></p>
<p>用法:</p>
<pre class=" language-html"><code class="language-html"><span class="token comment" spellcheck="true">&lt;!-- 绑定属性, Vue实例中data的imageSrc --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name"><span class="token namespace">v-bind:</span>src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>imageSrc<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>imageSrc<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!-- 绑定属性, 简单表达式 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">'</span>/basePath/images/<span class="token punctuation">'</span>+imageSrc<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!-- 绑定class, 表达式为对象 --></span>
<span class="token comment" spellcheck="true">&lt;!-- 根据isActive布尔值判断是否加类名 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{active: isActive}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!-- 绑定class, 表达式为数组 --></span>
<span class="token comment" spellcheck="true">&lt;!-- 一次性添加多个类名 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>[active, otherClass]<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token comment" spellcheck="true">&lt;!-- 结合三目条件判断 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>[isActive ? active : <span class="token punctuation">'</span><span class="token punctuation">'</span>, otherClass]<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token comment" spellcheck="true">&lt;!-- 结合对象条件判断 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>[{active: isActive}, otherClass]<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!-- 绑定style, 表达式为对象 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">:</span><span class="token style-attr language-css"><span class="token attr-name"><span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token punctuation">{</span><span class="token property">width</span><span class="token punctuation">:</span> widthSize + <span class="token string">'px'</span><span class="token punctuation">}</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token comment" spellcheck="true">&lt;!-- 绑定style, 表达式为数组 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">:</span><span class="token style-attr language-css"><span class="token attr-name"><span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value">[styleObjectA, styleObjectB]</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!-- 绑定prop, "propName"需在my-comp组件中声明 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-comp</span> <span class="token attr-name">:propName</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>someData<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-comp</span><span class="token punctuation">></span></span>
<span class="token comment" spellcheck="true">&lt;!-- 绑定$prop, 将父组件的props传给子组件 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sub-comp</span> <span class="token attr-name">:propName</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>$props<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sub-comp</span><span class="token punctuation">></span></span>
</code></pre>
</li>
<li><p><code>v-on</code>绑定DOM事件</p>
<p>语法糖:<code>@</code></p>
<p><strong>常见用法:</strong></p>
<pre class=" language-html"><code class="language-html"><span class="token comment" spellcheck="true">&lt;!-- 绑定单击事件, doSomething为methods中方法 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name"><span class="token namespace">v-on:</span>click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>doSomething<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>doSomething<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!-- 事件对象, $event --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>doSomething($event)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
<span class="token comment" spellcheck="true">&lt;!-- 不使用()括号, 默认会把$event传到dosomething的第一个参数中 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>doSomething<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!-- 绑定单次点击事件 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click.once</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>doSomething($event)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!-- 事件修饰符, 阻止默认行为 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">@click.prevent</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>prevent($event)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!-- 事件修饰符, 阻止默认行为, 没有表达式 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">@submit.prevent</span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!-- 事件修饰符, 阻止冒泡 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">@click.stop</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stop($event)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!-- 键修饰符, enter/键代码(keyCode) --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">@keydown.enter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>onEnter($event)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token comment" spellcheck="true">&lt;!-- Vue封装的键修饰符
        .enter
        .tab
        .delete (捕获delete键和backspace键)
        .esc
        .space
        .up
        .down
        .left
        .right
--></span>

<span class="token comment" spellcheck="true">&lt;!-- 系统修饰符
        .ctrl
        .alt
        .shift
        .meta(Mac系统的Command键, Windows系统的WIN键)
--></span>

<span class="token comment" spellcheck="true">&lt;!-- 鼠标修饰符
        .left
        .right
        .middle
--></span>

<span class="token comment" spellcheck="true">&lt;!-- .exact修饰符
        允许你控制由精确的系统修饰符组合触发的事件
--></span>
</code></pre>
<p><strong>组件中的用法:</strong></p>
<pre class=" language-html"><code class="language-html"><span class="token comment" spellcheck="true">&lt;!-- 自定义事件, 父组件不传参数时不能加(), 否则接收不了子组件传来的参数, 
     具体请查看 组件数据通信 章节 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-comp</span> <span class="token attr-name">@myEvent</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleEvent<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-comp</span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!-- 给组件根元素绑定事件 --></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-comp</span> <span class="token attr-name">@click.native</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>onClick<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-comp</span><span class="token punctuation">></span></span>
</code></pre>
<p><strong>其他用法(事件捕获, 移动端优化等):</strong></p>
<pre class=" language-html"><code class="language-html"><span class="token comment" spellcheck="true">&lt;!-- 添加事件监听器时使用事件捕获模式 --></span>
<span class="token comment" spellcheck="true">&lt;!-- 即元素自身触发的事件先在此处理，然后才交由内部元素进行处理 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name"><span class="token namespace">v-on:</span>click.capture</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>doThis<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!-- 只当在 event.target 是当前元素自身时触发处理函数 --></span>
<span class="token comment" spellcheck="true">&lt;!-- 即事件不是从内部元素触发的 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name"><span class="token namespace">v-on:</span>click.self</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>doThat<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!-- 滚动事件的默认行为 (即滚动行为) 将会立即触发 --></span>
<span class="token comment" spellcheck="true">&lt;!-- 而不会等待 `onScroll` 完成  --></span>
<span class="token comment" spellcheck="true">&lt;!-- 一般用于提升移动端性能 --></span>
<span class="token comment" spellcheck="true">&lt;!-- 不要和 .prevent 一起使用, 因为 .passive 会忽略 .prevent --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name"><span class="token namespace">v-on:</span>scroll.passive</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>onScroll<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
</code></pre>
</li>
<li><p><code>v-model</code>表单元素双向数据绑定</p>
<p>对于不同元素的表现:</p>
<p>a) <strong>text</strong>类型 和 <strong>textarea</strong>元素 使用 <code>value</code> 属性和 <code>input</code> 事件</p>
<p>b) <strong>checkbox</strong>类型 和 <strong>radio</strong>类型 使用 <code>checked</code> 属性和 <code>change</code> 事件</p>
<p>c) <strong>select</strong> 元素将 <code>value</code> 作为 prop 并将 <code>change</code> 作为事件</p>
<p>注意点:</p>
<p>a) 绑定了<code>v-model</code>的表单元素将忽视<code>value</code>、<code>checked</code>、<code>selected</code>初始值并始终与Vue实例的数据双向数据绑定</p>
<p>b) 对于文本输出框, 可通过<code>.lazy</code>修饰符把<code>input</code>事件转为<code>change</code>事件进行数据同步</p>
<p>c) 文本输入框<code>.trim</code>修饰符会自动删除用户输入的<code>value</code>字符串的首尾空白字符</p>
<p>d) 文本输入框<code>.number</code>修饰符会尝试将用户输入的<code>value</code>字符串通过<code>parseFloat()</code>方法转成数字, <font color="deepskyblue">如果无法转换, 返回原始值</font></p>
</li>
</ol>
<h3 id="数组和对象的更新监测-响应性修改"><a href="#数组和对象的更新监测-响应性修改" class="headerlink" title="数组和对象的更新监测(响应性修改)"></a>数组和对象的更新监测(响应性修改)</h3><h4 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h4><p>由于 JavaScript 的限制, Vue 不能监测以下数组的变动:</p>
<ol>
<li>利用索引值修改数组元素, <code>vm.array[index] = newValue</code></li>
<li>改变数组长度, <code>vm.array.length = newLength</code></li>
</ol>
<p>但支持监测数组的一些变异方法( mutation method )以及非变异方法( 返回新数组, 替换数组 )</p>
<p><strong>变异方法</strong></p>
<ul>
<li><code>push()</code></li>
<li><code>pop()</code></li>
<li><code>shift()</code></li>
<li><code>unshift()</code></li>
<li><code>splice()</code></li>
<li><code>sort()</code></li>
<li><code>reverse()</code></li>
</ul>
<p><strong>替换数组( 非变异方法 )</strong></p>
<ul>
<li><code>filter()</code></li>
<li><code>map()</code></li>
<li><code>concat()</code></li>
<li><code>slice()</code></li>
</ul>
<p><strong>Vue自带方法修改数组</strong></p>
<ul>
<li><code>Vue.set(vm.items, index, newValue)</code></li>
<li><code>vm.$set(vm.items, index, newValue)</code></li>
</ul>
<h4 id="对象"><a href="#对象" class="headerlink" title="对象"></a>对象</h4><p>还是由于 JavaScript 的限制，<strong>Vue 不能检测对象属性的添加或删除</strong></p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">var</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    a<span class="token punctuation">:</span> <span class="token number">1</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">/*
在控制台中输入
    vm.a = 2
    视图会响应, a是响应属性
    vm.b = 1
    视图不会响应, b不是响应属性
*/</span>
</code></pre>
<p><strong>Vue提供2种方法修改对象</strong></p>
<ul>
<li><code>Vue.set(object, key, newValue)</code></li>
<li><code>vm.$set(object, key, newValue)</code></li>
</ul>
<p><font color="tomato">注意: 当Vue实例创建后, 不允许动态添加根级响应属性</font>, 即</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">var</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    a<span class="token punctuation">:</span> <span class="token number">1</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Vue<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>b<span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 会报错, 不允许添加根级响应属性</span>
</code></pre>
<p><strong>如需给已有响应对象添加多个属性:</strong></p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">var</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    person<span class="token punctuation">:</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'Tenderness'</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>person<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    age<span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
    <span class="token keyword">class</span><span class="token punctuation">:</span> <span class="token string">'H5'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 这样vm.person的引用不会变, 即对原对象 person 添加属性, 不会响应</span>

<span class="token comment" spellcheck="true">// 应该这样做</span>
vm<span class="token punctuation">.</span>person <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> vm<span class="token punctuation">.</span>person<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    age<span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
    <span class="token keyword">class</span><span class="token punctuation">:</span> <span class="token string">'H5'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="Vue自带的delete方法"><a href="#Vue自带的delete方法" class="headerlink" title="Vue自带的delete方法"></a>Vue自带的delete方法</h4><p></p><p>Vue提供了<code>delete</code>方法, 通过该方法删除响应式的数组或对象中的成员可以更新视图, 但是开发者应该 <font color="deep"><strong>尽量少用该方法</strong></font>, 使用方法如下:</p> <p></p>
<ul>
<li><code>Vue.delete(array, index)</code>和<code>vm.$delete(array, index)</code>, 删除数组元素</li>
<li><code>Vue.delete(object, key)</code>和<code>vm.$delete(object, key)</code>, 删除对象成员</li>
</ul>
<h2 id="Vue组件"><a href="#Vue组件" class="headerlink" title="Vue组件"></a>Vue组件</h2><h3 id="模块化与组件化"><a href="#模块化与组件化" class="headerlink" title="模块化与组件化"></a>模块化与组件化</h3><p>首先模块化和组件化开发都为了代码复用, 方便维护</p>
<ol>
<li>模块化是从 <font color="yellowgreen"><strong>代码逻辑</strong></font> 层面上划分( 一般就是 JS 代码的封装 ), <font color="yellowgreen"><strong>功能解耦</strong></font></li>
<li>组件化是从整个 <font color="yellowgreen"><strong>UI页面布局</strong></font> 层面上划分( 包含HTML, CSS, JavaScript ), 更像是模块化的进一步封装, <font color="yellowgreen"><strong>封装隔离</strong></font>, 是一个具有一定功能特性的独立个体</li>
</ol>
<h3 id="组件化历史"><a href="#组件化历史" class="headerlink" title="组件化历史"></a>组件化历史</h3><ol>
<li>前期的 <font color="yellowgreen"><strong>UI组件库</strong></font> ( JS组件库 ), 通过JS代码控制HTML+CSS+JavaScript, JS负责做的事情太多( 即大量JS代码 ), 不好维护</li>
<li><font color="yellowgreen"><strong>组件化开发</strong></font>, 单文件组件( template 模板编译 + CSS + JavaScript ), 在Vue中即 <font color="tomato"><strong>.vue</strong></font> 文件</li>
</ol>
<h3 id="Vue组件注册和使用"><a href="#Vue组件注册和使用" class="headerlink" title="Vue组件注册和使用"></a>Vue组件注册和使用</h3><p><font color="yellowgreen">Vue组件的本质也是 Vue 的一个实例</font>, 创建时可以设置所有 Vue 实例的配置项</p>
<h4 id="全局组件注册"><a href="#全局组件注册" class="headerlink" title="全局组件注册"></a>全局组件注册</h4><p></p><p><font color="tomato">注意, 全局组件需要在实例创建之前注册</font></p><p></p>
<pre class=" language-js"><code class="language-js"><span class="token comment" spellcheck="true">// 组件的名称可以用 kebab-case(烤串形式)、PascalCase(大驼峰形式)命名 </span>
Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'gobal-comp'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`&lt;div>全局组件&lt;/div>`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<h4 id="局部组件注册"><a href="#局部组件注册" class="headerlink" title="局部组件注册"></a>局部组件注册</h4><pre class=" language-js"><code class="language-js"><span class="token keyword">var</span> myComp <span class="token operator">=</span> <span class="token punctuation">{</span>
    template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`&lt;div>局部组件&lt;/div>`</span></span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    el<span class="token punctuation">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
    components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// 建议使用大驼峰形式命名, 因为对象key键如果含有'-', 需要加上引号</span>
        PrivateComp<span class="token punctuation">:</span> myComp <span class="token comment" spellcheck="true">// 可以给局部组件起别名</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<h4 id="组件使用-复用"><a href="#组件使用-复用" class="headerlink" title="组件使用(复用)"></a>组件使用(复用)</h4><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token comment" spellcheck="true">&lt;!-- 组件标签的使用可以建议用烤串形式书写, 因为HTML元素标签不分大小写 --></span>
    <span class="token comment" spellcheck="true">&lt;!-- 不要使用H5内置标签名作为组件的名字, 防止浏览器识别错误 --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gobal-comp</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gobal-comp</span><span class="token punctuation">></span></span> <span class="token comment" spellcheck="true">&lt;!-- 全局组件使用 --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>private-comp</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>private-comp</span><span class="token punctuation">></span></span> <span class="token comment" spellcheck="true">&lt;!-- 局部组件使用 --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>private-comp</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>private-comp</span><span class="token punctuation">></span></span> <span class="token comment" spellcheck="true">&lt;!-- 组件复用 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
</code></pre>
<h4 id="组件嵌套"><a href="#组件嵌套" class="headerlink" title="组件嵌套"></a>组件嵌套</h4><p><font color="tomato">局部注册的组件在其子组件中不可用</font>, 如需在子组件中使用其他局部组件, 需要使用<strong>组件嵌套</strong></p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">var</span> CompA <span class="token operator">=</span> <span class="token punctuation">{</span>
    template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`&lt;&lt;div>CompA&lt;/div>>`</span></span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> CompB <span class="token operator">=</span> <span class="token punctuation">{</span>
    template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`&lt;&lt;div>&lt;comp-a>&lt;/comp-a>&lt;/div>>`</span></span><span class="token punctuation">,</span>
    <span class="token comment" spellcheck="true">// CompB组件不能直接使用CompA组件, CompA需要在CompB中注册绑定才能正常使用</span>
    <span class="token comment" spellcheck="true">// 即局部组件在哪注册(绑定), 只能在哪使用</span>
    components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        CompA
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    el<span class="token punctuation">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
    components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        CompA<span class="token punctuation">,</span>
        CompB
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<h4 id="组件数据通信"><a href="#组件数据通信" class="headerlink" title="组件数据通信"></a>组件数据通信</h4><h5 id="组件父向子传递数据"><a href="#组件父向子传递数据" class="headerlink" title="组件父向子传递数据"></a>组件父向子传递数据</h5><p>父组件使用子组件时, 通过<code>v-bind:propName</code>传递数据, 子组件在配置项<code>props</code>中接收数据</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token comment" spellcheck="true">&lt;!-- 使用MyComp组件, 传递实例data对象中的name和age数据 --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-comp</span> <span class="token attr-name">:name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span> <span class="token attr-name">:age</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>age<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-comp</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>myComp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
        这是 MyComp 组件, 接收数据 {{name}}, {{age}}
        <span class="token comment" spellcheck="true">&lt;!-- 使用SubComp组件, 把MyComp从父组件接收的props对象传递到SubComp的data中 --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sub-comp</span> <span class="token attr-name">:data</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>$props<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sub-comp</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sub<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
        这是 SubComp 组件, 接收数据 {{data}}
        <span class="token comment" spellcheck="true">&lt;!-- 将接收的data渲染到组件上 --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>名字: {{data.name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>年龄: {{data.age}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>js/vue.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
    <span class="token keyword">var</span> SubComp <span class="token operator">=</span> <span class="token punctuation">{</span>
        template<span class="token punctuation">:</span> <span class="token string">'#sub'</span><span class="token punctuation">,</span>
        <span class="token comment" spellcheck="true">// SubComp组件接收 data 数据</span>
        props<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> MyComp <span class="token operator">=</span> <span class="token punctuation">{</span>
        template<span class="token punctuation">:</span> <span class="token string">'#myComp'</span><span class="token punctuation">,</span>
        <span class="token comment" spellcheck="true">// MyComp组件接收 name 和 age 俩数据</span>
        props<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token comment" spellcheck="true">// MyComp组件绑定(嵌套)子组件SubComp</span>
        components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            SubComp
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        el<span class="token punctuation">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
        components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// 实例绑定局部(子)组件MyComp</span>
            MyComp
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            name<span class="token punctuation">:</span> <span class="token string">'Tenderness'</span><span class="token punctuation">,</span>
            age<span class="token punctuation">:</span> <span class="token number">18</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
<p><span id="props"></span></p>
<h5 id="props配置项详细描述"><a href="#props配置项详细描述" class="headerlink" title="props配置项详细描述"></a>props配置项详细描述</h5><p>首先, 传递的prop(数据名字)命名规则(大小写)与 <strong>组件命名</strong> 一样, 因为HTML元素特性名大小写不敏感</p>
<h6 id="prop传递数据细节"><a href="#prop传递数据细节" class="headerlink" title="prop传递数据细节:"></a><strong>prop传递数据细节:</strong></h6><ol>
<li><p>prop传递动态数据, 必须加上<code>v-bind:</code>, 表示引号中数据的是一个变量而不是字符串</p>
</li>
<li><p>prop传递静态数据</p>
<pre class=" language-html"><code class="language-html"><span class="token comment" spellcheck="true">&lt;!-- 传递静态简单字符串, 不需要v-bind: --></span>
<span class="token comment" spellcheck="true">&lt;!-- 将str静态字符串传递给SubComp组件 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sub-comp</span> <span class="token attr-name">str</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>这是静态字符串<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sub-comp</span><span class="token punctuation">></span></span>
<span class="token comment" spellcheck="true">&lt;!-- 当传递的字符串需要拼接, 需要加上v-bind:, 让Vue将数据解析成表达式 --></span>
<span class="token comment" spellcheck="true">&lt;!-- 静态字符串拼接时, 注意单引号和双引号的使用, 推荐里单外双 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sub-comp</span> <span class="token attr-name">:str</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">'</span>字符串拼接<span class="token punctuation">'</span>+<span class="token punctuation">'</span>这是静态字符串<span class="token punctuation">'</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sub-comp</span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!-- 传递其他静态数据类型时, 需要加上v-bind:, 让Vue正确解析数据类型 --></span>
<span class="token comment" spellcheck="true">&lt;!-- 传递数字 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sub-comp</span> <span class="token attr-name">:num</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>520<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sub-comp</span><span class="token punctuation">></span></span>
<span class="token comment" spellcheck="true">&lt;!-- 传递数组 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sub-comp</span> <span class="token attr-name">:arr</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>[<span class="token punctuation">'</span>item1<span class="token punctuation">'</span>, <span class="token punctuation">'</span>item2<span class="token punctuation">'</span>]<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sub-comp</span><span class="token punctuation">></span></span>
<span class="token comment" spellcheck="true">&lt;!-- 传递对象 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sub-comp</span> <span class="token attr-name">:obj</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{name: <span class="token punctuation">'</span>Tenderness<span class="token punctuation">'</span>, age: 18}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sub-comp</span><span class="token punctuation">></span></span>
<span class="token comment" spellcheck="true">&lt;!-- 传递布尔值 --></span>
<span class="token comment" spellcheck="true">&lt;!-- 特殊情况: prop没有值时, 表示传递true, 不需要v-bind: --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sub-comp</span> <span class="token attr-name">is-active</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sub-comp</span><span class="token punctuation">></span></span>
<span class="token comment" spellcheck="true">&lt;!-- 等同于 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sub-comp</span> <span class="token attr-name">:is-active</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sub-comp</span><span class="token punctuation">></span></span>
</code></pre>
</li>
<li><p>prop传递一个对象的所有属性</p>
<p>如果你想要将一个对象的所有属性都作为 prop 传入，你可以使用不带参数的 <code>v-bind</code> (取代 <code>v-bind:prop-name</code>), 因此 <strong>组件父向子传递数据</strong> 中代码可以改造成:</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>myComp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
        这是 MyComp 组件, 接收数据 {{name}}, {{age}}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sub-comp</span> <span class="token attr-name"><span class="token namespace">v:</span>bind</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>$props<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sub-comp</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>subComp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
        这是 SubComp 组件, 接收数据 {{name}}, {{age}}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>名字: {{name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>年龄: {{age}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
     <span class="token keyword">var</span> SubComp <span class="token operator">=</span> <span class="token punctuation">{</span>
        template<span class="token punctuation">:</span> <span class="token string">'#sub'</span><span class="token punctuation">,</span>
        props<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">,</span><span class="token string">'age'</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
</li>
</ol>
<h6 id="props配置项验证数据"><a href="#props配置项验证数据" class="headerlink" title="props配置项验证数据"></a><strong>props配置项验证数据</strong></h6><p>在 SubComp 组件中, <code>props</code>配置项接收2数据<code>name</code>和<code>age</code>, 并期望<code>name</code>是 string 类型, <code>age</code>是 number 类型, 但通过 <strong>数组</strong> 的方式接收, 只能做到 <strong>简单接收</strong> , Vue并不会验证父组件所传来的数据, 如需定制 prop 验证方式, 需要通过 <strong>对象</strong> 的方式验证接收:</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">var</span> SubComp <span class="token operator">=</span> <span class="token punctuation">{</span>
    template<span class="token punctuation">:</span> <span class="token string">'#sub'</span><span class="token punctuation">,</span>
    props<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
        age<span class="token punctuation">:</span> Number
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/* 类型检查通过构造函数, 本质是通过 instanceof 进行验证, 
    注意: 设置为 null 和 undefined 会通过任何类型检测
    原生构造函数:
    String
    Number
    Boolean
    Array
    Object
    Date
    Function
    Symbol
    自定义构造函数
*/</span>
</code></pre>
<p>还可以为prop配置对象, 设置 <strong>必须值</strong> (<code>required</code>)或者<strong>默认值</strong>(<code>default</code>):</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">var</span> SubComp <span class="token operator">=</span> <span class="token punctuation">{</span>
    template<span class="token punctuation">:</span> <span class="token string">'#sub'</span><span class="token punctuation">,</span>
    props<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
            <span class="token comment" spellcheck="true">// 必须值</span>
            required<span class="token punctuation">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        age<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// Number 或者 String 类型都能通过</span>
            type<span class="token punctuation">:</span> <span class="token punctuation">[</span>Number<span class="token punctuation">,</span> String<span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token comment" spellcheck="true">// 默认值</span>
            <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token number">18</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        bestFriend<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            type<span class="token punctuation">:</span> Object<span class="token punctuation">,</span>
            <span class="token comment" spellcheck="true">// 对象或者数组的默认值必须从一个工厂函数中获取</span>
            <span class="token keyword">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token punctuation">{</span>
                    name<span class="token punctuation">:</span> <span class="token string">'Jacky'</span><span class="token punctuation">,</span>
                    age<span class="token punctuation">:</span> <span class="token number">18</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token keyword">class</span><span class="token punctuation">:</span><span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// 自定义验证函数</span>
            <span class="token function">validator</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string">'H5'</span><span class="token punctuation">,</span><span class="token string">'Java'</span><span class="token punctuation">,</span><span class="token string">'UI'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p><font color="deep"><strong>注意点</strong></font>: <code>props</code>会在 <strong>组件实例创建之前</strong> (<code>beforeCreate</code>)验证, 所以所有实例属性(包括<code>data</code>和<code>computed</code>)在<code>default</code>或者<code>validator</code>中不可用</p>
<h5 id="组件子向父传递数据"><a href="#组件子向父传递数据" class="headerlink" title="组件子向父传递数据"></a>组件子向父传递数据</h5><h6 id="单向数据流"><a href="#单向数据流" class="headerlink" title="单向数据流"></a><strong>单向数据流</strong></h6><p>所有<code>prop</code>使得父子<code>prop</code>间形成一个 <strong>单向下行绑定</strong>, 即父级<code>prop</code>的更新会向下流动到子组件中, 但是反过来不行, 这样的处理能 <font color="deep"><strong>防止</strong></font> 子组件意外改变父级组件的状态, 导致应用的数据流向难以理解</p>
<p>所以, 父级组件发生更新时, 子组件<code>prop</code>刷新保持最新值, <font color="deep"><strong>子组件不能直接操作</strong></font><code>prop</code></p>
<h6 id="自定义事件"><a href="#自定义事件" class="headerlink" title="自定义事件"></a><strong>自定义事件</strong></h6><p>单向数据流就像是水顺流而下的道理, 但是我们可以通过泵让水逆流而上, 这就是 <strong>组件子向父传递数据</strong> 的原理, 而 <strong>自定义事件</strong> 就相当于这个泵, 以下是一个简易版的 <font color="deepskyblue"><strong>todo-list</strong></font> 诠释组件子向父传递数据的过程</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>user<span class="token punctuation">"</span></span> <span class="token attr-name">@keydown.enter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>add<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token comment" spellcheck="true">&lt;!-- 父组件使用子组件时, 绑定自定义事件'del' --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>news-list</span> <span class="token attr-name">:list</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>list<span class="token punctuation">"</span></span> <span class="token attr-name">@del</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>del<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>news-list</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>list<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>(item,index) in list<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>index<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>{{item}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>emitDel(index)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token entity" title="&times;">&amp;times;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>js/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
    <span class="token keyword">var</span> NewsList <span class="token operator">=</span> <span class="token punctuation">{</span>
        template<span class="token punctuation">:</span> <span class="token string">'#list'</span><span class="token punctuation">,</span>
        props<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            list<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                type<span class="token punctuation">:</span> Array<span class="token punctuation">,</span>
                <span class="token keyword">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token function">emitDel</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment" spellcheck="true">// 子组件中触发'del'自定义事件, 并把index传递给父组件</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'del'</span><span class="token punctuation">,</span> index<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        el<span class="token punctuation">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
        components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            NewsList
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            user<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
            list<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>user <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>user <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token function">del</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment" spellcheck="true">// 自定义事件处理父组件中list数组</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
<h5 id="非父子组件传递数据"><a href="#非父子组件传递数据" class="headerlink" title="非父子组件传递数据"></a>非父子组件传递数据</h5><p>非父子组件传递数据可通过三种方式实现</p>
<ol>
<li>中央事件总线</li>
<li>混入<code>store</code>模式</li>
<li><code>vuex</code>插件 </li>
</ol>
<p>本章节只介绍 <strong>中央事件总线</strong> , 其余2方法在<code>vuex</code>中介绍</p>
<h6 id="组件数据私有化"><a href="#组件数据私有化" class="headerlink" title="组件数据私有化"></a><strong>组件数据私有化</strong></h6><p>在介绍中央事件总线之前, 先说下组件数据私有化, 即 <strong>组件的<code>data</code>配置项必须是一个函数</strong></p>
<p>在<code>data</code>配置项中设置一个函数, 该函数返回真正的 <strong>数据对象</strong>, 即每次绑定注册组件时, 该组件实例的<code>data</code>数据对象都是一个新的引用, 即每个组件实例管理一个<code>data</code>数据对象的独立拷贝, 这样的处理能让组件 <strong>数据私有化</strong>, <strong>复用时组件数据互不影响</strong></p>
<p><img src="/images/privatedata.png" alt="组件数据私有化示例"></p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-comp</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-comp</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-comp</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-comp</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>my-comp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">border</span><span class="token punctuation">:</span> <span class="token number">1</span>px solid <span class="token hexcode">#000</span><span class="token punctuation">;</span><span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span><span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">15</span>px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>组件私有num: {{num}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
        <span class="token comment" spellcheck="true">&lt;!-- 每个组件实例的add()方法, 只会对当前实例的私有num进行累加 --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>add<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>自增<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>js/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
    <span class="token keyword">var</span> MyComp <span class="token operator">=</span> <span class="token punctuation">{</span>
        template<span class="token punctuation">:</span> <span class="token string">'#my-comp'</span><span class="token punctuation">,</span>
        <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                num<span class="token punctuation">:</span> <span class="token number">0</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>num<span class="token operator">++</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        el<span class="token punctuation">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
        components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            MyComp
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
<h6 id="中央事件总线"><a href="#中央事件总线" class="headerlink" title="中央事件总线"></a><strong>中央事件总线</strong></h6><p><strong>中央事件总线</strong> 本质也是通过 <strong>自定义事件</strong> 实现数据传递, 使用过程中 <strong><font color="deep">注意事件名字重复</font></strong></p>
<p><img src="/images/vuebus.png" alt="vue bus 中央事件总线"></p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-comp</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-comp</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-comp</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-comp</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>other-comp</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>other-comp</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>my-comp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">border</span><span class="token punctuation">:</span> <span class="token number">1</span>px solid <span class="token hexcode">#000</span><span class="token punctuation">;</span><span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span><span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">15</span>px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>组件私有num: {{num}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>add<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>自增<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>other-comp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
        <span class="token comment" spellcheck="true">&lt;!-- 点击第一个按钮时, 触发bus的addNum自定义事件 --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>emitAdd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>MyComp组件的num自增<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
            <span class="token comment" spellcheck="true">&lt;!-- input输入框v-model绑定OtherComp组件实例私有数据num --></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>number<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>num<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token comment" spellcheck="true">&lt;!-- 点击第一个按钮时, 触发bus的changeNum自定义事件 --></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>emitChange<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>修改MyComp组件的num<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>js/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
    <span class="token keyword">var</span> bus <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//全局公交车, 当前script环境下任何都能使用</span>

    <span class="token keyword">var</span> MyComp <span class="token operator">=</span> <span class="token punctuation">{</span>
        template<span class="token punctuation">:</span> <span class="token string">'#my-comp'</span><span class="token punctuation">,</span>
        <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                num<span class="token punctuation">:</span> <span class="token number">0</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>num<span class="token operator">++</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment" spellcheck="true">// 生命周期钩子函数, 当实例挂载完成后, 执行的函数</span>
        <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// 给bus监听addNum自定义事件, 用箭头函数改变this指向(当前实例), MyComp组件实例的私有Num自增</span>
            bus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'addNum'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">this</span><span class="token punctuation">.</span>num<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// 给bus监听changeNum自定义事件, 接收一个newVal参数, 并赋值给MyComp组件实例的私有Num</span>
            bus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'changeNum'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>newVal<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">this</span><span class="token punctuation">.</span>num <span class="token operator">=</span> newVal<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> OtherComp <span class="token operator">=</span> <span class="token punctuation">{</span>
        template<span class="token punctuation">:</span> <span class="token string">'#other-comp'</span><span class="token punctuation">,</span>
        <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                num<span class="token punctuation">:</span> <span class="token number">0</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token function">emitAdd</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment" spellcheck="true">// 触发bus的addNum自定义事件</span>
                bus<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'addNum'</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token function">emitChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment" spellcheck="true">// 触发bus的changeNum自定义事件, 并把OtherComp的私有num传递过去</span>
                bus<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'changeNum'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>num<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        el<span class="token punctuation">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
        components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            MyComp<span class="token punctuation">,</span>
            OtherComp
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
<h3 id="插槽"><a href="#插槽" class="headerlink" title="插槽"></a>插槽</h3><h4 id="插槽的作用"><a href="#插槽的作用" class="headerlink" title="插槽的作用"></a>插槽的作用</h4><h5 id="简单数据通信"><a href="#简单数据通信" class="headerlink" title="简单数据通信"></a>简单数据通信</h5><p>在上一章节中, 我们提及了组件间的数据通信问题, 在组件嵌套层次较深的组件中, 父组件向后代组件传递数据时, 如果通过父向子传递, 则需要一层一层逐层传递和接收<code>prop</code>, 逻辑可能会出现混乱并且不好维护</p>
<p><strong>插槽</strong> 的出现能 <font color="deepskyblue"><strong>简化</strong></font> 层级较深组件中的父组件向后代组件传递数据的逻辑关系</p>
<p><img src="/images/slot-prop.png" alt="传递简单数据"></p>
<h6 id="使用父向子prop传递"><a href="#使用父向子prop传递" class="headerlink" title="使用父向子prop传递"></a><strong>使用父向子prop传递</strong></h6><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">500</span>px<span class="token punctuation">;</span><span class="token property">background</span><span class="token punctuation">:</span> pink<span class="token punctuation">;</span><span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">15</span>px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>#app实例<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>msg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>v-model绑定#app实例msg<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
    <span class="token comment" spellcheck="true">&lt;!-- 将msg传递到MyComp中 --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-comp</span> <span class="token attr-name">:msg</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>msg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-comp</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>my-comp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">background</span><span class="token punctuation">:</span> skyblue<span class="token punctuation">;</span><span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">15</span>px<span class="token punctuation">;</span><span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">15</span>px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>MyComp组件<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
        <span class="token comment" spellcheck="true">&lt;!-- 将接收过来的msg传递到SubComp中 --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sub-comp</span> <span class="token attr-name">:msg</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>msg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sub-comp</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sub-comp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">background</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span><span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">15</span>px<span class="token punctuation">;</span><span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">15</span>px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>SubComp组件<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>#app实例传递过来的msg: {{msg}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>js/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
    <span class="token keyword">var</span> SubComp <span class="token operator">=</span> <span class="token punctuation">{</span>
        template<span class="token punctuation">:</span> <span class="token string">'#sub-comp'</span><span class="token punctuation">,</span>
        <span class="token comment" spellcheck="true">// 接收MyComp传递过来的msg数据</span>
        props<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> MyComp <span class="token operator">=</span> <span class="token punctuation">{</span>
        template<span class="token punctuation">:</span> <span class="token string">'#my-comp'</span><span class="token punctuation">,</span>
        components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            SubComp
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment" spellcheck="true">// 接收#app传递过来的msg数据</span>
        props<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        el<span class="token punctuation">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
        components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            MyComp
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            msg<span class="token punctuation">:</span> <span class="token string">''</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
<h6 id="使用slot插槽简化"><a href="#使用slot插槽简化" class="headerlink" title="使用slot插槽简化"></a><strong>使用slot插槽简化</strong></h6><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">500</span>px<span class="token punctuation">;</span><span class="token property">background</span><span class="token punctuation">:</span> pink<span class="token punctuation">;</span><span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">15</span>px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>#app实例<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>msg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>v-model绑定#app实例msg<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
    <span class="token comment" spellcheck="true">&lt;!-- 往MyComp组件插槽插入#app实例msg, 传递到SubComp组件中 --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-comp</span><span class="token punctuation">></span></span>{{msg}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-comp</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>my-comp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">background</span><span class="token punctuation">:</span> skyblue<span class="token punctuation">;</span><span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">15</span>px<span class="token punctuation">;</span><span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">15</span>px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>MyComp组件<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sub-comp</span><span class="token punctuation">></span></span>
            <span class="token comment" spellcheck="true">&lt;!-- 提供插槽 --></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sub-comp</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sub-comp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">background</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span><span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">15</span>px<span class="token punctuation">;</span><span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">15</span>px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>SubComp组件<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
        <span class="token comment" spellcheck="true">&lt;!-- 提供插槽 --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>#app实例传递过来的msg: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>js/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
    <span class="token comment" spellcheck="true">// SubComp和MyComp组件不再需要props配置项接收msg</span>
    <span class="token keyword">var</span> SubComp <span class="token operator">=</span> <span class="token punctuation">{</span>
        template<span class="token punctuation">:</span> <span class="token string">'#sub-comp'</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> MyComp <span class="token operator">=</span> <span class="token punctuation">{</span>
        template<span class="token punctuation">:</span> <span class="token string">'#my-comp'</span><span class="token punctuation">,</span>
        components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            SubComp
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        el<span class="token punctuation">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
        components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            MyComp
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            msg<span class="token punctuation">:</span> <span class="token string">''</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
<h5 id="slot传递元素标签或者组件"><a href="#slot传递元素标签或者组件" class="headerlink" title="slot传递元素标签或者组件"></a>slot传递元素标签或者组件</h5><p><img src="/images/slot-el-comp.png" alt="slot传递元素或者组件"></p>
<ol>
<li><p><strong>slot传递元素标签</strong></p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">500</span>px<span class="token punctuation">;</span><span class="token property">background</span><span class="token punctuation">:</span> pink<span class="token punctuation">;</span><span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">15</span>px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>#app实例<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>msg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>v-model绑定#app实例msg<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-comp</span><span class="token punctuation">></span></span>
        <span class="token comment" spellcheck="true">&lt;!-- 往MyComp组件插槽插入元素, 传递到SubComp组件中 --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">background</span><span class="token punctuation">:</span> yellowgreen<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>这是#app实例传来的p元素<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>这是#app实例传来的msg: {{msg}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-comp</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>my-comp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">background</span><span class="token punctuation">:</span> skyblue<span class="token punctuation">;</span><span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">15</span>px<span class="token punctuation">;</span><span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">15</span>px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>MyComp组件<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sub-comp</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sub-comp</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sub-comp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">background</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span><span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">15</span>px<span class="token punctuation">;</span><span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">15</span>px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>SubComp组件<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>
</code></pre>
</li>
<li><p><strong>slot传递组件</strong></p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">500</span>px<span class="token punctuation">;</span><span class="token property">background</span><span class="token punctuation">:</span> pink<span class="token punctuation">;</span><span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">15</span>px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>#app实例<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>msg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>v-model绑定#app实例msg<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-comp</span><span class="token punctuation">></span></span>
        <span class="token comment" spellcheck="true">&lt;!-- 往MyComp组件插槽中插入SubComp组件 --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sub-comp</span><span class="token punctuation">></span></span>
            <span class="token comment" spellcheck="true">&lt;!-- 往SubComp组件插槽中插入元素 --></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">background</span><span class="token punctuation">:</span> yellowgreen<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>这是#app实例传来的p元素<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>这是#app实例传来的msg: {{msg}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sub-comp</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-comp</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>my-comp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">background</span><span class="token punctuation">:</span> skyblue<span class="token punctuation">;</span><span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">15</span>px<span class="token punctuation">;</span><span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">15</span>px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>MyComp组件<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sub-comp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">background</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span><span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">15</span>px<span class="token punctuation">;</span><span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">15</span>px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>SubComp组件<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>js/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
    <span class="token keyword">var</span> SubComp <span class="token operator">=</span> <span class="token punctuation">{</span>
        template<span class="token punctuation">:</span> <span class="token string">'#sub-comp'</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">// MyComp 不再需要绑定SubComp组件</span>
    <span class="token keyword">var</span> MyComp <span class="token operator">=</span> <span class="token punctuation">{</span>
        template<span class="token punctuation">:</span> <span class="token string">'#my-comp'</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">// #app实例中绑定MyComp和SubComp组件</span>
    <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        el<span class="token punctuation">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
        components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            MyComp<span class="token punctuation">,</span>
            SubComp
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            msg<span class="token punctuation">:</span> <span class="token string">''</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
</li>
</ol>
<h4 id="插槽的后备内容-默认内容"><a href="#插槽的后备内容-默认内容" class="headerlink" title="插槽的后备内容(默认内容)"></a>插槽的后备内容(默认内容)</h4><p>与<code>prop</code>类似, <code>slot</code>可以设置默认内容</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token comment" spellcheck="true">&lt;!-- 显示默认内容提交 --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-btn</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-btn</span><span class="token punctuation">></span></span>
        <span class="token comment" spellcheck="true">&lt;!-- 显示插入内容重置 --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-btn</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>reset<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>重置<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-btn</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>my-btn<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>type<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">></span></span>提交<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>js/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
    <span class="token keyword">var</span> MyBtn <span class="token operator">=</span> <span class="token punctuation">{</span>
        template<span class="token punctuation">:</span> <span class="token string">'#my-btn'</span><span class="token punctuation">,</span>
        props<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            type<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
                <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token string">'submit'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        el<span class="token punctuation">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
        components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            MyBtn
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
<h4 id="具名插槽"><a href="#具名插槽" class="headerlink" title="具名插槽"></a>具名插槽</h4><p>在一个组件中, 我们可能需要提供多个插槽, 如一个简单的三栏布局:</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>my-header<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">360</span>px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">50</span>px<span class="token punctuation">;</span><span class="token property">line-height</span><span class="token punctuation">:</span> <span class="token number">50</span>px<span class="token punctuation">;</span><span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>left<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">80</span>px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100%</span><span class="token punctuation">;</span><span class="token property">background</span><span class="token punctuation">:</span> pink</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token comment" spellcheck="true">&lt;!-- 期待插入左栏内容 --></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">flex</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token property">background</span><span class="token punctuation">:</span> skyblue<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token comment" spellcheck="true">&lt;!-- 期待插入中间部分内容 --></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>right<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">80</span>px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100%</span><span class="token punctuation">;</span><span class="token property">background</span><span class="token punctuation">:</span> pink</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token comment" spellcheck="true">&lt;!-- 期待插入右栏内容 --></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>
</code></pre>
<p>那么问题来了, 在使用时, 该怎么把对应内容插到对应位置呢</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token comment" spellcheck="true">&lt;!-- 尝试一下是否按顺序插入 --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-header</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>左<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>中<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>右<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-header</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
</code></pre>
<p><img src="/images/slot-repeat.png" alt="匿名插槽"></p>
<p>结果是, 三个<code>&lt;span&gt;</code>元素重复了三次</p>
<p>由以上结果可知, <font color="yellowgreen">有多少个匿名插槽, 插入的匿名内容就会重复多少次</font>.</p>
<p><font color="tomato">使用 <font color="yellowgreen"><strong>具名插槽</strong></font> 进行改造</font>:</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-header</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>左<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>中<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>right<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>右<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-header</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>my-header<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">360</span>px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">50</span>px<span class="token punctuation">;</span><span class="token property">line-height</span><span class="token punctuation">:</span> <span class="token number">50</span>px<span class="token punctuation">;</span><span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>left<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">80</span>px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100%</span><span class="token punctuation">;</span><span class="token property">background</span><span class="token punctuation">:</span> pink</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token comment" spellcheck="true">&lt;!-- 期待插入左栏内容 --></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">flex</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token property">background</span><span class="token punctuation">:</span> skyblue<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token comment" spellcheck="true">&lt;!-- 期待插入中间部分内容 --></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>right<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">80</span>px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100%</span><span class="token punctuation">;</span><span class="token property">background</span><span class="token punctuation">:</span> pink</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token comment" spellcheck="true">&lt;!-- 期待插入右栏内容 --></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>right<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>
</code></pre>
<p><img src="/images/slot-name.png" alt="具名插槽"></p>
<p>使用具名插槽改造后, 达到我们需要的显示效果</p>
<p>注意点: </p>
<ol>
<li>具名插槽是通过<code>&lt;slot&gt;</code>标签的<code>name</code>属性和插入元素的<code>slot</code>特性相关联的</li>
<li>匿名插槽默认<code>name</code>属性为<code>defalut</code>, 可以省略</li>
</ol>
<h4 id="作用域插槽"><a href="#作用域插槽" class="headerlink" title="作用域插槽"></a>作用域插槽</h4><h5 id="插槽的编译作用域"><a href="#插槽的编译作用域" class="headerlink" title="插槽的编译作用域"></a>插槽的编译作用域</h5><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token comment" spellcheck="true">&lt;!-- 不插入内容, 使用默认内容, 在MyComp组件作用域寻找name --></span>
    <span class="token comment" spellcheck="true">&lt;!-- 结果是"MyComp" --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-comp</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-comp</span><span class="token punctuation">></span></span>

    <span class="token comment" spellcheck="true">&lt;!-- 不插入内容name, 在当前实例作用域寻找name --></span>
    <span class="token comment" spellcheck="true">&lt;!-- 结果是"Tenderness" --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-comp</span><span class="token punctuation">></span></span>
        {{name}}
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-comp</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>js/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
    <span class="token keyword">var</span> MyComp <span class="token operator">=</span> <span class="token punctuation">{</span>
        template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`&lt;div>&lt;slot>{{name}}&lt;/slot>&lt;/div>`</span></span><span class="token punctuation">,</span>
        <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                name<span class="token punctuation">:</span> <span class="token string">'MyComp'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        el<span class="token punctuation">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
        components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            MyComp
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            name<span class="token punctuation">:</span> <span class="token string">'Tenderness'</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
<p>小结: <strong>父级模板里的所有内容都是在父级作用域中编译的; 子模板里的所有内容都是在子作用域中编译的</strong></p>
<h5 id="作用域插槽-1"><a href="#作用域插槽-1" class="headerlink" title="作用域插槽"></a>作用域插槽</h5><p>就像组件子向父传递数据一样, 在插槽中, 我们有时也需要 <strong>从子组件中获取数据</strong>, 而这通信的桥梁就是具名插槽</p>
<p>在 <strong>子组件</strong> <code>&lt;slot&gt;</code>标签中, 通过<code>v-bind:propName</code>传递数据</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">var</span> MyComp <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 注意, 传递的数据名字不能是H5元素标签的属性名</span>
    template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`&lt;div>&lt;slot :msg="msg">&lt;/slot>&lt;/div>`</span></span><span class="token punctuation">,</span>
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            msg<span class="token punctuation">:</span> <span class="token string">'MyComp'</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>在 <strong>父组件</strong> 插入插槽内容时, 通过<code>slot-scope</code>特性接收数据</p>
<p><font color="yellowgreen"><strong>使用插槽建议始终使用完整的基于<code>&lt;template&gt;</code>的语法</strong></font>.</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-comp</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">slot-scope</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>slotProps<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            {{slotProps.msg}}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-comp</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
</code></pre>
<p><code>slot-scope</code>特性接收的是包含插槽所有<code>prop</code>的对象, 一般取名<code>slotProps</code>接收该对象, 当然你也可以像变量名一样取任意名字</p>
<p>同时, <code>slot-scope</code>特性还支持 <strong>对象解构赋值</strong></p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-comp</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">slot-scope</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{msg}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            {{msg}}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-comp</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
</code></pre>
<h4 id="v-slot指令"><a href="#v-slot指令" class="headerlink" title="v-slot指令"></a>v-slot指令</h4><p>Vue从2.6.0开始, 废弃<code>slot</code>和<code>slot-scope</code>特性( 目前还能使用 ), 用<code>v-slot</code>指令代替</p>
<p><strong>注意, <code>v-slot</code>指令只能写在<code>&lt;template&gt;</code>标签上</strong></p>
<ol>
<li><p><code>v-slot</code>指令使用 <strong>具名插槽</strong>, 对简单三栏布局改造</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-header</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name"><span class="token namespace">v-slot:</span>left</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>左<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>
        <span class="token comment" spellcheck="true">&lt;!-- 不用v-slot指令, 默认是v-slot:default --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>中<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name"><span class="token namespace">v-slot:</span>right</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>右<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-header</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
</code></pre>
</li>
<li><p>使用语法糖<code>#</code></p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-header</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">#left</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>左<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>中<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">#right</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>右<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-header</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
</code></pre>
</li>
<li><p><code>v-slot</code>指令使用 <strong>作用域插槽</strong></p>
<p>组件模板:</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>my-header<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">360</span>px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">50</span>px<span class="token punctuation">;</span><span class="token property">line-height</span><span class="token punctuation">:</span> <span class="token number">50</span>px<span class="token punctuation">;</span><span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>left<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">80</span>px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100%</span><span class="token punctuation">;</span><span class="token property">background</span><span class="token punctuation">:</span> pink</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>left<span class="token punctuation">"</span></span> <span class="token attr-name">msg</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>左侧<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">flex</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token property">background</span><span class="token punctuation">:</span> skyblue<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token attr-name">msg</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>中间<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>right<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">80</span>px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100%</span><span class="token punctuation">;</span><span class="token property">background</span><span class="token punctuation">:</span> pink</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>right<span class="token punctuation">"</span></span> <span class="token attr-name">msg</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>右侧<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>
</code></pre>
<p>具名插槽接收数据:</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-header</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">#left</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{msg}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>{{msg}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>
        <span class="token comment" spellcheck="true">&lt;!-- 等同于 v-slot:default="{msg} 或者 #default="{msg} --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-slot</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{msg}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>{{msg}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">#right</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{msg}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>{{msg}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-header</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
</code></pre>
</li>
</ol>
<h2 id="Vue核心补充与进阶"><a href="#Vue核心补充与进阶" class="headerlink" title="Vue核心补充与进阶"></a>Vue核心补充与进阶</h2><h3 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h3><h4 id="实例的生命周期钩子"><a href="#实例的生命周期钩子" class="headerlink" title="实例的生命周期钩子"></a>实例的生命周期钩子</h4><p>每个Vue实例在被创建时会经过一系列的初始化过程, 在这些过程执行的函数叫做 <strong>生命周期钩子函数</strong>, 以下是 Vue 官方文档提供的生命周期图示</p>
<p><img src="/images/lifecycle.png" alt="生命周期"></p>
<table>
<thead>
<tr>
<th>生命周期钩子</th>
<th>描述和作用</th>
<th style="text-align:center">操作数据(<code>data</code>)</th>
<th style="text-align:center">操作元素(<code>el</code>)</th>
</tr>
</thead>
<tbody>
<tr>
<td>beforeCreate()</td>
<td>劫持数据对象前</td>
<td style="text-align:center">×</td>
<td style="text-align:center">×</td>
</tr>
<tr>
<td>created()</td>
<td>劫持数据对象后</td>
<td style="text-align:center">√</td>
<td style="text-align:center">×</td>
</tr>
<tr>
<td>beforeMount()</td>
<td>实例挂载前</td>
<td style="text-align:center">√</td>
<td style="text-align:center">×</td>
</tr>
<tr>
<td>mounted()</td>
<td>实例挂载后</td>
<td style="text-align:center">√</td>
<td style="text-align:center">√</td>
</tr>
<tr>
<td>beforeUpdate()</td>
<td>数据对象更新前</td>
<td style="text-align:center">√</td>
<td style="text-align:center">√</td>
</tr>
<tr>
<td>updated()</td>
<td>数据对象更新后</td>
<td style="text-align:center">√</td>
<td style="text-align:center">√</td>
</tr>
<tr>
<td>beforeDestroy()</td>
<td>实例销毁前</td>
<td style="text-align:center">√</td>
<td style="text-align:center">√</td>
</tr>
<tr>
<td>destroyed()</td>
<td>实例销毁后</td>
<td style="text-align:center">×</td>
<td style="text-align:center">×</td>
</tr>
</tbody>
</table>
<p><strong>常用的钩子函数:</strong></p>
<ol>
<li><code>created()</code> 发起 <strong>ajax</strong> 异步请求, 获取数据</li>
<li><code>mounted()</code> <strong>设置定时器</strong></li>
<li><code>beforeDestory()</code> <strong>清除定时器</strong></li>
</ol>
<p>注意点:</p>
<ol>
<li><p><font color="tomato"><strong>不要使用箭头函数来定义生命周期钩子函数</strong></font>, 因为生命周期钩子函数<code>this</code>指向当前 Vue 实例</p>
</li>
<li><p><code>beforeUpdate</code>钩子函数获取的是 <strong>更新前</strong> 的数据, <code>updated</code>获取的是 <strong>最新</strong> 的数据</p>
</li>
<li><p><code>mounted</code>和<code>updated</code>不会等待其 <strong>子组件</strong> 的挂载/重绘状态, 如需等待整个视图渲染完毕才调用对应的 <strong>钩子函数</strong>, 需要用<code>vm.$nextTick</code>替换对应钩子函数</p>
<pre class=" language-js"><code class="language-js"><span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">/* 全视图挂载后(rendered)执行的代码 */</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">/* 全视图重绘(re-rendered)后执行的代码 */</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
</li>
<li><p><a href="#keepalive"><code>activated</code>和<code>deactivated</code>两钩子在 <font color="tomato"><strong>路由</strong></font> 部分描述</a></p>
</li>
</ol>
<h4 id="生命周期相关实例方法"><a href="#生命周期相关实例方法" class="headerlink" title="生命周期相关实例方法"></a>生命周期相关实例方法</h4><h5 id="vm-mount"><a href="#vm-mount" class="headerlink" title="vm.$mount()"></a>vm.$mount()</h5><p>当创建 Vue 时, 没有<code>el</code>配置项, 实例处于 <strong>未挂载</strong>(<code>beforeMount</code>)状态, 需要调用<code>vm.$mount()</code>方法手动挂载</p>
<p>注意点:</p>
<ol>
<li>该方法可以接受 <strong>元素</strong>(<code>element</code>) 或者 <strong>元素选择器</strong>(<code>querySelector</code>) 两种参数, 表示挂载(被替换)的元素</li>
<li>如果 <strong>不传参数</strong>, 表示模板将渲染成文档之外的元素( 相当于<code>document.createElement()</code> ) , 需要使用原生 DOM API 将它插入文档中( 如 <code>appendChild</code>,<code>insertBefore</code> )</li>
<li><code>vm.$mount()</code>返回<code>vm</code>实例本身, 所以支持链式操作, 如<code>vm.$mount().$el</code>访问根元素</li>
</ol>
<h5 id="vm-destroy"><a href="#vm-destroy" class="headerlink" title="vm.$destroy()"></a>vm.$destroy()</h5><p>完全销毁一个实例, 清理它与其他实例的链接, 解绑它身上的所有指令和事件监听器</p>
<p>注意点, 该方法会同时触发<code>beforeDestroy</code>和<code>destroy</code>两个钩子</p>
<h5 id="vm-forceUpdate"><a href="#vm-forceUpdate" class="headerlink" title="vm.$forceUpdate()"></a>vm.$forceUpdate()</h5><p>强制让 Vue 实例 <strong>重新渲染</strong>, 仅影响当前实例及其插槽内容, 自她子组件不受影响, <font color="deep"><strong>一般不会使用</strong></font>.</p>
<h5 id="vm-nextTick-callback"><a href="#vm-nextTick-callback" class="headerlink" title="vm.$nextTick([callback])"></a>vm.$nextTick([callback])</h5><p>将回调函数延迟到 DOM 更新循环( 挂载/重绘 )之后执行</p>
<h3 id="访问元素和组件"><a href="#访问元素和组件" class="headerlink" title="访问元素和组件"></a>访问元素和组件</h3><p>在使用 Vue 时, 不建议触达另一个组件实例内部或者手动操作 DOM 元素, 但确实存在这需求让我们的操作更便捷, 因此 Vue 也提供了几个Api:</p>
<ol>
<li><p><code>$root</code>, 访问 <strong>根实例</strong>, 后代组件实例可以通过<code>this.$root</code>访问到根实例</p>
</li>
<li><p><code>$parent</code>, 访问 <strong>父组件</strong>, 与<code>$root</code>类似, 子组件实例可通过<code>this.$parent</code>访问其父组件</p>
</li>
<li><p><code>$children</code>, 访问当前实例的 <strong>直接子组件</strong>, <font color="deep"><strong>基本不用</strong></font>.</p>
</li>
<li><p><code>$refs</code>, 访问 <strong>子组件或子元素</strong>, 相对<code>$root</code>和<code>$parent</code>而言比较常用, 常用于操作 DOM 元素</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>普通div<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token comment" spellcheck="true">&lt;!-- 实例模板中通过ref特性绑定需要访问的元素或者组件实例 --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>targetDiv<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>目标div<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>js/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
    <span class="token keyword">var</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        el<span class="token punctuation">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
        <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// 在父组件中, 通过vm.$refs访问对应的子元素或子组件</span>
            <span class="token comment" spellcheck="true">// 只能在挂载后的生命周期钩子函数中操作访问</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>targetDiv<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
</li>
</ol>
<h3 id="事件接口API"><a href="#事件接口API" class="headerlink" title="事件接口API"></a>事件接口API</h3><ol>
<li><p><code>$on(eventName, eventHandler)</code> 监听一个事件</p>
</li>
<li><p><code>$once(eventName, eventHandler)</code> 监听一个一次性事件</p>
</li>
<li><p><code>$emit(eventName, [...args])</code> 触发实例事件</p>
</li>
<li><p><code>$off([eventName, callback])</code> 移除事件监听器</p>
<p>注意点:</p>
<p>a) 没有参数, 表示移除所有事件监听器</p>
<p>b) 只提供事件( eventName ), 移除该事件所有监听器</p>
<p>c) 同时提供事件( eventName )和回调( callback ), 只移除这个回调的监听器</p>
</li>
</ol>
<h3 id="watch接口进阶监测"><a href="#watch接口进阶监测" class="headerlink" title="$watch接口进阶监测"></a>$watch接口进阶监测</h3><p>语法: <code>vm.$watch(exp|Fn, callback, [options])</code></p>
<p>示例 Vue 实例:</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">var</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        groupName<span class="token punctuation">:</span> <span class="token string">'Vue电商项目'</span><span class="token punctuation">,</span>
        members<span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'成员1'</span><span class="token punctuation">,</span> wages<span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'成员2'</span><span class="token punctuation">,</span> wages<span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'成员3'</span><span class="token punctuation">,</span> wages<span class="token punctuation">:</span> <span class="token number">15</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>和<code>watch</code>配置项类似的监测</p>
<pre class=" language-js"><code class="language-js"><span class="token comment" spellcheck="true">// 第一个参数为字符串, 表示监测的数据名称</span>
<span class="token comment" spellcheck="true">// 第二个参数为处理函数</span>
<span class="token comment" spellcheck="true">// 第三个参数为配置对象, 如 immediate 和 deep</span>
vm<span class="token punctuation">.</span><span class="token function">$watch</span><span class="token punctuation">(</span><span class="token string">'groupName'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>newVal<span class="token punctuation">,</span> oldVal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'当前值:'</span><span class="token punctuation">,</span> newVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'旧值:'</span><span class="token punctuation">,</span> oldVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>immediate<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 立即执行处理函数</span>

vm<span class="token punctuation">.</span><span class="token function">$watch</span><span class="token punctuation">(</span><span class="token string">'members'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>newVal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>deep<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 深度监测</span>
</code></pre>
<p>第一个参数接收一个 <strong>函数</strong></p>
<pre class=" language-js"><code class="language-js">vm<span class="token punctuation">.</span><span class="token function">$watch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 相当于监测一个未定义的计算值( computed )</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>members<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>tar<span class="token punctuation">,</span> cur<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> tar <span class="token operator">+</span> cur<span class="token punctuation">.</span>wages
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>newVal<span class="token punctuation">,</span> oldVal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'当前值:'</span><span class="token punctuation">,</span> newVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'旧值:'</span><span class="token punctuation">,</span> oldVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p><code>$watch</code>的 <strong>返回值</strong></p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">let</span> unwatch <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">$watch</span><span class="token punctuation">(</span><span class="token string">'groupName'</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// vm.$watch 返回一个取消监测函数, 用来停止触发回调( handler )</span>
<span class="token function">unwatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<h3 id="key特殊特性"><a href="#key特殊特性" class="headerlink" title="key特殊特性"></a>key特殊特性</h3><p><code>key</code>主要用在 Vue 的虚拟 DOM 算法, <strong>接收一个<code>number</code>或者<code>string</code>类型的值</strong>, 在新旧 nodes 对比时辨识 VNodes. 如果不用<code>key</code>, Vue 会尽可能的复用相同的元素 <strong>重新渲染数据</strong>; 使用<code>key</code>后, Vue会 <strong>基于<code>key</code>的变化</strong> 重新排列元素顺序, 并移除<code>key</code>不存在的元素</p>
<p><font color="deepskyblue"><strong><code>key</code>特性常与<code>v-for</code>指令搭配使用</strong></font>.</p>
<p><font color="deep"><strong>注意: 相同父元素的子元素<code>key</code>不能重复, 否则会造成渲染错误</strong></font>.</p>
<p><code>key</code>也能用于强制替换元素/组件而不是复用, 比如:</p>
<ol>
<li>完整地触发组件的生命周期钩子(<code>beforeCreate</code>到<code>destroyed</code>, <code>v-if</code>指令条件渲染)</li>
<li>触发过渡(<code>&lt;transition&gt;</code>或者<code>transition-group</code>组件)</li>
</ol>
<h3 id="自定义指令"><a href="#自定义指令" class="headerlink" title="自定义指令"></a>自定义指令</h3><p>除了内置指令外, Vue 支持开发者注册自定义事件对 Vue 进行拓展, 减少DOM操作</p>
<p>全局注册:</p>
<pre class=" language-js"><code class="language-js">Vue<span class="token punctuation">.</span><span class="token function">directive</span><span class="token punctuation">(</span><span class="token string">'指令名字'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">/* 钩子函数 */</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>局部注册:</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    directives<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">'指令名字'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">/* 钩子函数 */</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>使用自定义指令:</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-自定义指令名字</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
</code></pre>
<p><font color="deepskyblue">注意点: 注册时不需要带<code>v-</code>, 使用时需要带上<code>v-</code></font>.</p>
<h4 id="钩子函数"><a href="#钩子函数" class="headerlink" title="钩子函数"></a>钩子函数</h4><ol>
<li><code>bind()</code>, 当指令绑定到元素时调用, <strong>只执行一次</strong>, 一般进行 <strong>初始化</strong> 设置</li>
<li><code>inserted()</code>, 被绑定元素插入父节点时调用( 父节点需要在内存中存在, 不一定插入文档中 )</li>
<li><code>update()</code>, 所在组件<code>VNode</code>(虚拟DOM)更新时, <strong>可能在子<code>VNode</code>更新前</strong> 调用</li>
<li><code>componentUpdated()</code>, 所在 <strong>组件及其子<code>VNode</code></strong>全部更新后调用</li>
<li><code>unbind()</code>, 指令与元素解绑时调用, <strong>只调用一次</strong></li>
</ol>
<h4 id="钩子函数接收的参数"><a href="#钩子函数接收的参数" class="headerlink" title="钩子函数接收的参数"></a>钩子函数接收的参数</h4><ol>
<li><code>el</code>, 绑定指令的元素, <strong>常用来直接操作DOM</strong></li>
<li><code>binding</code>, 一个对象, 包含<ul>
<li><code>name</code>, 指令名, 不含<code>v-</code>前缀</li>
<li><code>value</code>, 指令的绑定值/对象, 例如：<code>v-my-directive=&quot;1 + 1&quot;</code> 中，绑定值为 <code>2</code>。</li>
<li><code>oldValue</code>, 指令绑定的旧值, 仅在 <code>update</code> 和 <code>componentUpdated</code> 钩子中可用。无论值是否改变都可用。</li>
<li><code>expression</code>, 指令绑定的表达式, 例如 <code>v-my-directive=&quot;1 + 1&quot;</code> 中，表达式为 <code>&quot;1 + 1&quot;</code>。</li>
<li><code>arg</code>, 传给指令的参数, 例如 <code>v-my-directive:foo</code> 中，参数为 <code>&quot;foo&quot;</code>。</li>
<li><code>modifiers</code>, 包含修饰符的对象, 例如：<code>v-my-directive.foo.bar</code> 中，修饰符对象为 <code>{ foo: true, bar: true }</code>。</li>
</ul>
</li>
<li><code>vnode</code>, Vue 编译生成的虚拟节点</li>
<li><code>oldVnode</code>, 上一个虚拟节点, 仅在 <code>update</code> 和 <code>componentUpdated</code> 钩子中可用</li>
</ol>
<p>注意点: </p>
<ol>
<li><font color="deepskyblue">除了<code>el</code>, 其他参数都应该是只读的, 切勿进行修改</font>.</li>
<li>如需在各钩子间共享数据, 通过元素的<code>dataset</code>(即元素上的<code>data-*</code>属性)实现, 语法: <code>el.dataset.*</code></li>
</ol>
<h4 id="自定义指令实现输入框自动对焦"><a href="#自定义指令实现输入框自动对焦" class="headerlink" title="自定义指令实现输入框自动对焦"></a>自定义指令实现输入框自动对焦</h4><p><code>autofocus</code>特性在 <strong>移动版Safari</strong> 中失效, 通过自定义指令让<code>&lt;input&gt;</code>输入框自动聚焦:</p>
<pre class=" language-js"><code class="language-js"><span class="token comment" spellcheck="true">// 注册一个全局自定义指令 `v-focus`</span>
Vue<span class="token punctuation">.</span><span class="token function">directive</span><span class="token punctuation">(</span><span class="token string">'focus'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// 当被绑定的元素插入到 DOM 中时</span>
  inserted<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>el<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 聚焦元素</span>
    el<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<h3 id="获取实例属性API"><a href="#获取实例属性API" class="headerlink" title="获取实例属性API"></a>获取实例属性API</h3><ol>
<li><code>vm.$data</code>, 获取实例数据对象, 即<code>data</code>配置项</li>
<li><code>vm.$props</code>, 获取接收的<code>props</code>对象</li>
<li><code>vm.$options</code>, 获取实例的初始化选项, 一般用于获取自定义配置项</li>
<li><code>vm.$slots</code>, 访问 <strong>插槽分发</strong> 的内容, 以及每个具名插槽的相应属性(<code>name</code>)</li>
<li><code>vm.$scopedSlots</code>, 访问 <strong>作用域插槽</strong></li>
<li><code>vm.$attrs</code>, 获取 <strong>父作用域</strong> 中, 不被<code>props</code>接收的特性(<code>class</code>和<code>style</code>除外)</li>
<li><code>vm.$listeners</code>, 获取 <strong>父作用域</strong> 中的 <strong>事件监听器</strong></li>
</ol>
<h3 id="过渡与动画"><a href="#过渡与动画" class="headerlink" title="过渡与动画"></a>过渡与动画</h3><p>首先, Vue <font color="deep"><strong>不适合</strong></font>做过渡或者动画效果, 但 Vue 提供<code>&lt;transition&gt;</code>和<code>&lt;transition-group&gt;</code>两内置组件实现过渡与动画效果</p>
<p><font color="yellowgreen">Vue 在插入、更新、移除 DOM 时, 能触发过渡效果</font>.</p>
<h4 id="单元素-组件过渡"><a href="#单元素-组件过渡" class="headerlink" title="单元素/组件过渡"></a>单元素/组件过渡</h4><p>使用<code>&lt;transition&gt;</code>内置组件能让单元素/组件实现过渡效果, 以下是简单的案例</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">
        <span class="token comment" spellcheck="true">/* 使用过渡类名控制过渡样式 */</span>
        <span class="token selector"><span class="token class">.myTrans-enter-active</span>, <span class="token class">.myTrans-leave-active</span> </span><span class="token punctuation">{</span>
            <span class="token property">transition</span><span class="token punctuation">:</span> opacity <span class="token number">.5</span>s<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token selector"><span class="token class">.myTrans-enter</span>, <span class="token class">.myTrans-leave-to</span> </span><span class="token punctuation">{</span>
            <span class="token property">opacity</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>isShow<span class="token punctuation">=</span>!isShow<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>切换<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
    <span class="token comment" spellcheck="true">&lt;!-- v-if 和 v-show 都能触发过渡 --></span>
    <span class="token comment" spellcheck="true">&lt;!-- 给transition组件设置name特性, 自定义组件过渡效果 --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>myTrans<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>isShow<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>过渡测试<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>myTrans<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-show</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>isShow<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>过渡测试<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>js/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
    <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        el<span class="token punctuation">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
        data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            isShow<span class="token punctuation">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
</code></pre>
<h4 id="CSS过渡类名"><a href="#CSS过渡类名" class="headerlink" title="CSS过渡类名"></a>CSS过渡类名</h4><p>在整个过渡的过程, 元素/组件会进入6个状态, <code>v</code>为对应<code>&lt;transition&gt;</code>组件的<code>name</code>特性值</p>
<ol>
<li><code>v-enter</code>, 进场过渡的开始状态</li>
<li><code>v-enter-active</code>, 进场过渡的生效过程</li>
<li><code>v-enter-to</code>, 进场过渡的结束状态</li>
<li><code>v-leave</code>, 退场过渡的开始状态</li>
<li><code>v-leave-active</code>, 退场过渡的生效过程</li>
<li><code>v-leave-to</code>, 退场过渡的结束状态</li>
</ol>
<p><img src="/images/transition.png" alt="过渡过程"></p>
<p>总结:</p>
<ol>
<li>一般<code>v-enter</code>和<code>v-leave-to</code>状态是一致的, <code>v-enter-to</code>和<code>v-leave</code>状态是一致的, 即可用并集选择器设置相同样式</li>
<li><code>v-enter-active</code>和<code>v-leave-active</code>在进场/退场整个过程应用, 在这俩类名选择器中可以设置<code>transition</code>(过渡)或者<code>animation</code>(动画, 外面定义<code>@keyframes</code>) CSS属性</li>
</ol>
<h4 id="自定义过渡类名"><a href="#自定义过渡类名" class="headerlink" title="自定义过渡类名"></a>自定义过渡类名</h4><p>自定义过渡类名 <strong>优先级</strong> 高于普通类名, 一般配合第三方 CSS 动画库使用(如 <strong>Animate.css</strong> )</p>
<p>对应的6个自定义类名:</p>
<ol>
<li><code>enter-class</code></li>
<li><code>enter-active-class</code></li>
<li><code>enter-to-class</code></li>
<li><code>leave-class</code></li>
<li><code>leave-active-class</code></li>
<li><code>leave-to-class</code></li>
</ol>
<p>配合 <strong>Animate.css</strong> 使用时, 需需要设置<code>enter-active-class</code>和<code>leave-active-class</code>即可, 如</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>isShow <span class="token punctuation">=</span> !isShow<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>切换<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">enter-active-class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>animated fadeIn<span class="token punctuation">"</span></span>
                <span class="token attr-name">leave-active-class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>animated fadeOut<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>isShow<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>过渡测试<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
</code></pre>
<h4 id="过渡钩子"><a href="#过渡钩子" class="headerlink" title="过渡钩子"></a>过渡钩子</h4><p>Vue提供的8个过渡钩子</p>
<ol>
<li><code>v-on:before-enter</code>, 进场前状态</li>
<li><code>v-on:enter</code>, 进场过渡时</li>
<li><code>v-on:after-enter</code>, 进场结束状态</li>
<li><code>v-on:enter-cancelled</code>, 进场过渡取消时</li>
<li><code>v-on:before-leave</code>, 退场前状态</li>
<li><code>v-on:leave</code>, 退场过渡时</li>
<li><code>v-on:after-leave</code>, 退场结束状态</li>
<li><code>v-on:leave-cancelled</code>, 退场过渡取消时</li>
</ol>
<p>注意:</p>
<ol>
<li>8个钩子绑定的函数接收的第一个参数都是<code>el</code>, 即当前执行过渡效果的元素</li>
<li><code>enter</code>和<code>leave</code>还接收第二个参数<code>done</code>回调函数, 表示 <strong>异步</strong> 调用, 当只用 JavaScript 过渡时必须调用, 否则两钩子函数同步调用, 过渡效果失效</li>
<li>仅适用 JavaScript 过渡时, 建议给需要过渡的元素设置<code>v-bind:css=&quot;false&quot;</code>表示跳过CSS监测</li>
</ol>
<h4 id="列表过渡"><a href="#列表过渡" class="headerlink" title="列表过渡"></a>列表过渡</h4><p><code>&lt;transition&gt;</code>组件只能设置单个元素/组件的过渡, 如需设置列表过渡, 如配合<code>v-for</code>指令, 则需要使用<code>&lt;transition-group&gt;</code>组件</p>
<p>注意点:</p>
<ol>
<li><p><code>&lt;transition&gt;</code>组件在页面中不会被渲染成一个真正的元素, 而<code>&lt;transition-group&gt;</code>会被渲染成一个真正的元素</p>
</li>
<li><p><code>tag</code>特性, <code>&lt;transition-group&gt;</code>默认会被渲染成<code>&lt;span&gt;</code>元素, 可通过<code>tag</code>特性设置成其他元素, 如</p>
<pre class=" language-html"><code class="language-html"><span class="token comment" spellcheck="true">&lt;!-- 指定为ul元素 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition-group</span> <span class="token attr-name">tag</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ul<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>num in 10<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{{num}}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>{{num}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition-group</span><span class="token punctuation">></span></span>
</code></pre>
</li>
<li><p>内部元素 <strong>必须</strong> 设置<code>key</code>特性</p>
</li>
</ol>
<h4 id="过渡组件的其他特性"><a href="#过渡组件的其他特性" class="headerlink" title="过渡组件的其他特性"></a>过渡组件的其他特性</h4><ol>
<li><p><code>duration</code>设置过渡的持续时长</p>
<pre class=" language-html"><code class="language-html">// 单位毫秒(ms)
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">:duration</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1000<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition</span><span class="token punctuation">></span></span>
// 定制进场和退场的持续时间
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">:duration</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{enter: 600, leave: 800}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition</span><span class="token punctuation">></span></span>
</code></pre>
</li>
<li><p><code>type</code>指定监听的类型, Vue是通过监听<code>transitionend</code>或<code>animationend</code>事件判断过渡完成的, 当同时使用过渡(<code>transition</code>)和动画(<code>animation</code>)时, 需要设置<code>type</code>特性, 明确 Vue 监听的类型以判断过渡完成, 取值<code>transition</code>或<code>animation</code></p>
</li>
<li><p><code>appear</code>设置初次渲染的过渡, 与进场和出场过渡一样, 但只在元素/组件初次在页面中渲染时有效</p>
<p>a) 自定义类名: <code>appear-class</code>,<code>appear-active-class</code>,<code>appear-to-class</code></p>
<p>b) 自定义狗子: <code>@before-appear</code>,<code>@appear</code>,<code>@after-appear</code>,<code>@appear-cancelled</code></p>
</li>
<li><p><code>mode</code>设置过渡模式, 用于<code>v-if</code>,<code>v-else-if</code>,<code>v-else</code>渲染的多组件过渡, 取值<code>in-out</code>(新元素进场后当前元素退场), <code>out-in</code>(当前元素退场后新元素进场)</p>
</li>
</ol>
<h2 id="Vue路由"><a href="#Vue路由" class="headerlink" title="Vue路由"></a>Vue路由</h2><p><font color="yellowgreen"><strong>Vue Router</strong></font> 是 <strong>Vus.js</strong> 官方的路由管理器, 利用 Vue.js + Vue Router 能便捷的创建一个单页面应用( <strong>SPA</strong> )</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token comment" spellcheck="true">&lt;!-- router-link组件进行导航 --></span>
    <span class="token comment" spellcheck="true">&lt;!-- to特性设置跳转的路由路径 --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/home<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>首页<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/about<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>关于<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">></span></span>
    <span class="token comment" spellcheck="true">&lt;!-- router-view组件设置路由出口 --></span>
    <span class="token comment" spellcheck="true">&lt;!-- 路由匹配的组件将在这里渲染 --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-view</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!-- 引入Vue核心库 vue.js --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>js/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token comment" spellcheck="true">&lt;!-- 引入Vue Router插件 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>js/vue-router.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
    <span class="token comment" spellcheck="true">// 定义组件</span>
    <span class="token keyword">var</span> Home <span class="token operator">=</span> <span class="token punctuation">{</span>template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`&lt;h1>首页&lt;/h1>`</span></span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> About <span class="token operator">=</span> <span class="token punctuation">{</span>template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`&lt;h1>关于&lt;/h1>`</span></span><span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">// 定义路由</span>
    <span class="token keyword">var</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// 路由设置</span>
        routes<span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token comment" spellcheck="true">// 根路径处理</span>
            <span class="token punctuation">{</span>
                path<span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
                redirect<span class="token punctuation">:</span> <span class="token string">'/home'</span> <span class="token comment" spellcheck="true">// 网页重定向, 指向对应路由路径(path)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                path<span class="token punctuation">:</span> <span class="token string">'/home'</span><span class="token punctuation">,</span>
                <span class="token comment" spellcheck="true">// 将组件映射到对应路由中</span>
                component<span class="token punctuation">:</span> Home
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                path<span class="token punctuation">:</span> <span class="token string">'/about'</span><span class="token punctuation">,</span>
                component<span class="token punctuation">:</span> About
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        el<span class="token punctuation">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
        <span class="token comment" spellcheck="true">// 引入路由器</span>
        router<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
<h3 id="mode配置项"><a href="#mode配置项" class="headerlink" title="mode配置项"></a>mode配置项</h3><p><code>mode</code>配置项设置 Vue 路由的路径模式, 默认值<code>&quot;hash&quot;</code></p>
<p><img src="/images/hash.png" alt="hash模式"></p>
<p><strong>hash模式</strong> 下, Vue使用 URL 的 hash 来模拟一个完整的 URL, 于是 URL 改变时, 页面不会重新加载</p>
<p>但很显然, 这样的路由路径是比较丑的, 所以 Vue Router 提供了 <strong>history模式</strong>, 将<code>mode</code>配置项设置为<code>&quot;history&quot;</code>后</p>
<p><img src="/images/history.png" alt="history模式"></p>
<p><strong>history模式</strong> 下, 路由路径更像正常的 URL, 但需要 <strong>后台配置支持</strong>, 否则会报 <font color="tomato"><strong>404</strong></font> 找不到资源</p>
<h4 id="操作hash和history原生JS接口"><a href="#操作hash和history原生JS接口" class="headerlink" title="操作hash和history原生JS接口"></a>操作hash和history原生JS接口</h4><ol>
<li><p>操作<code>hash</code>(哈希)</p>
<p>操作<code>hash</code>, 通过<code>location.hash</code>进行</p>
<p><img src="/images/hashapi.png" alt="操作hash"></p>
</li>
<li><p>操作<code>history</code>(历史记录)</p>
<p>a) <code>history.back()</code>返回</p>
<p>b) <code>history.forward()</code>前进</p>
<p>c) <code>history.go(number|URL)</code>跳转到某历史记录</p>
<p>d) <code>history.pushState(data, title, URL)</code>, 其中<code>data</code>是对象, <code>title</code>是字符串, 添加(压栈)历史记录</p>
<p>e) <code>history.replaceState(data, title, URL)</code>, 用新的历史记录替换当前记录</p>
</li>
</ol>
<h4 id="router-link组件"><a href="#router-link组件" class="headerlink" title="router-link组件"></a>router-link组件</h4><p><code>&lt;router-link&gt;</code>组件在实例挂载时会被渲染成<code>&lt;a&gt;</code>标签, 本质是对<code>&lt;a&gt;</code>标签的封装:</p>
<ol>
<li>阻止<code>&lt;a&gt;</code>标签的默认跳转行为(<code>e.preventDefalut = true</code>)</li>
<li>根据<code>mode</code>配置项, <strong>hash模式</strong> 修改<code>location.hash</code>, <strong>history模式</strong> 调用<code>history.pushState()</code></li>
</ol>
<h3 id="动态路由"><a href="#动态路由" class="headerlink" title="动态路由"></a>动态路由</h3><p>Vue 路由也有符合 <font color="tomato"><strong>RESTful</strong></font> 设计风格的 <strong>动态路由</strong>, 如在 <strong>我的</strong> 路由中, 根据不同<code>id</code>匹配不同用户, 使用相同组件渲染页面:</p>
<ol>
<li><p>定义我的组件</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">var</span> User <span class="token operator">=</span> <span class="token punctuation">{</span>
    template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`&lt;div>用户&lt;/div>`</span></span><span class="token punctuation">,</span>
    <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
</li>
<li><p>添加路由设置</p>
<pre class=" language-js"><code class="language-js"><span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// :id 就是动态路径参数</span>
    path<span class="token punctuation">:</span> <span class="token string">'/user/:id'</span><span class="token punctuation">,</span>
    component<span class="token punctuation">:</span> User
<span class="token punctuation">}</span>
</code></pre>
</li>
</ol>
<p>设置完之后, 我们在路径上添加路径参数也能访问到对应路由组件了</p>
<p><img src="/images/restfulpath.png" alt="动态路由"></p>
<p>但是现在, 我们获取的仍是一个死的(静态)组件页面, 我们需要获取到 <strong>动态路径参数</strong>, 并渲染到页面上, 观察控制台打印的<code>this</code>( Vue 实例):</p>
<p><img src="/images/$route.png" alt="vm.$route"></p>
<p>在实例的<code>$route</code>属性中, 我们可以通过<code>vm.$route.params</code>获取到我们需要的 <strong>动态路由参数</strong>, 于是对组件进行改造</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">var</span> User <span class="token operator">=</span> <span class="token punctuation">{</span>
    template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`&lt;div>用户 {{$route.params.id}}&lt;/div>`</span></span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="嵌套路由"><a href="#嵌套路由" class="headerlink" title="嵌套路由"></a>嵌套路由</h3><p>除了 <strong>动态路由</strong> 外, 实际的应用界面通常由多层嵌套的组件组合而成, 如<code>http://path/user/1/info</code>和<code>http://path/user/1/wallet</code>等, 这时候就要用到 <strong>嵌套路由</strong></p>
<ol>
<li><p>对我的组件进行改造</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">var</span> User <span class="token operator">=</span> <span class="token punctuation">{</span>
    template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`
    &lt;div>
        &lt;p>用户 {{$route.params.id}}&lt;/p>
        &lt;router-link :to="'/user/'+$route.params.id+'/info'">详情&lt;/router-link>
        &lt;router-link :to="'/user/'+$route.params.id+'/wallet'">钱包&lt;/router-link>
        &lt;router-view>&lt;/router-view>
    &lt;/div>`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
</li>
<li><p>修改路由设置</p>
<pre class=" language-js"><code class="language-js"><span class="token punctuation">{</span>
    path<span class="token punctuation">:</span> <span class="token string">'/user/:id'</span><span class="token punctuation">,</span>
    component<span class="token punctuation">:</span> User<span class="token punctuation">,</span>
    <span class="token comment" spellcheck="true">// 设置嵌套路由, children配置项和routes配置项是一样的数组</span>
    children<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// 注意, 以 / 开头的嵌套路由路径会被当做根路径, 所以不能加 / </span>
            path<span class="token punctuation">:</span> <span class="token string">'info'</span><span class="token punctuation">,</span>
            component<span class="token punctuation">:</span> Info
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            path<span class="token punctuation">:</span> <span class="token string">'wallet'</span><span class="token punctuation">,</span>
            component<span class="token punctuation">:</span> Wallet
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
</li>
</ol>
<h3 id="命名路由"><a href="#命名路由" class="headerlink" title="命名路由"></a>命名路由</h3><p>在使用 <strong>嵌套路由</strong> 时, 我们会发现, 随着嵌套的层次越深, <code>&lt;router-link&gt;</code>的<code>to</code>特性就越复杂, 因此建议每个路由都带有<code>name</code>属性, 这就是 <strong>命名路由</strong></p>
<ol>
<li><p>对路由进行命名改造</p>
<pre class=" language-js"><code class="language-js"><span class="token punctuation">{</span>
    path<span class="token punctuation">:</span> <span class="token string">'/user/:id'</span><span class="token punctuation">,</span>
    name<span class="token punctuation">:</span> <span class="token string">'user'</span><span class="token punctuation">,</span>
    component<span class="token punctuation">:</span> User<span class="token punctuation">,</span>
    children<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            path<span class="token punctuation">:</span> <span class="token string">'info'</span><span class="token punctuation">,</span>
            name<span class="token punctuation">:</span> <span class="token string">'info'</span><span class="token punctuation">,</span>
            component<span class="token punctuation">:</span> Info
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            path<span class="token punctuation">:</span> <span class="token string">'wallet'</span><span class="token punctuation">,</span>
            name<span class="token punctuation">:</span> <span class="token string">'wallet'</span><span class="token punctuation">,</span>
            component<span class="token punctuation">:</span> Wallet
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
</li>
<li><p>对<code>&lt;router-link&gt;</code>组件进行修改</p>
<pre class=" language-html"><code class="language-html"><span class="token comment" spellcheck="true">&lt;!-- 根实例中 --></span>
<span class="token comment" spellcheck="true">&lt;!-- 通过动态to特性, 配置一个对象, 设置跳转的命名路由 --></span>
<span class="token comment" spellcheck="true">&lt;!-- 动态路径参数通过 params:{} 传递 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">:to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{name:<span class="token punctuation">'</span>user<span class="token punctuation">'</span>,params:{id:1}}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>我的<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!-- user组件中, 直接通过命名路由跳转 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">:to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{name:<span class="token punctuation">'</span>info<span class="token punctuation">'</span>}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>详情<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">:to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{name:<span class="token punctuation">'</span>wallet<span class="token punctuation">'</span>}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>钱包<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">></span></span>
</code></pre>
</li>
</ol>
<h3 id="路由的样式类名"><a href="#路由的样式类名" class="headerlink" title="路由的样式类名"></a>路由的样式类名</h3><p>设置完路由后, 我们的页面是这样的</p>
<p><img src="/images/nostyle.png" alt="没有样式的路由"></p>
<p>不看浏览器地址栏, 用户并不知道自己当前在哪个路由中, 用户希望是这种效果以确认自己的位置</p>
<p><img src="/images/withstyle.png" alt="有样式的路由"></p>
<p>因此, 我们在跳转到<code>/user/1/info</code>后审查元素</p>
<p><img src="/images/active.png" alt="路由类名"></p>
<p>切换到<code>/user/1/wallet</code>后</p>
<p><img src="/images/exact-active.png" alt="路由类名"></p>
<p>Vue给我们当前的路由设置<code>router-link-active</code>类名, <code>router-link-exact-active</code>精准定位到当前嵌套路由中, 因此可以通过这2类名设置对应样式, 但是, 这两类名还是比较复杂的, Vue Router 提供了2配置项, 让开发者重命名这2类名</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">var</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    routes<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token comment" spellcheck="true">/* 路由设置 */</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment" spellcheck="true">// 重命名2类名</span>
    linkActiveClass<span class="token punctuation">:</span> <span class="token string">'active'</span><span class="token punctuation">,</span>
    linkExactActiveClass<span class="token punctuation">:</span> <span class="token string">'exActive'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>重命名后, 我们就可以设置对应样式了</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">
    <span class="token selector"><span class="token class">.active</span> </span><span class="token punctuation">{</span>
        <span class="token property">color</span><span class="token punctuation">:</span> yellowgreen<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token selector"><span class="token class">.exActive</span> </span><span class="token punctuation">{</span>
        <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>
</code></pre>
<h3 id="编程式导航-JS跳转"><a href="#编程式导航-JS跳转" class="headerlink" title="编程式导航(JS跳转)"></a>编程式导航(JS跳转)</h3><p>除了通过<code>&lt;router-link&gt;</code>组件的<code>to</code>特性实现路由跳转外, 我们还可以通过JS代码进行跳转, <code>vm.$router</code>就是我们当前使用的 <strong>router 实例</strong></p>
<p><img src="/images/$router.png" alt="vm.$router"></p>
<p>Vue Router 对 <strong>路由跳转</strong> 的方法进行了封装(兼容 <strong>hash模式</strong> 和 <strong>history模式</strong> )</p>
<ol>
<li><code>go(number)</code>, 跳转到具体路由, 参照当前记录前进或者后退多少步</li>
<li><code>back()</code>, 后退</li>
<li><code>forward()</code>, 前进</li>
<li><code>push(location, onComplete, onAbort)</code>, 其中<code>location</code>表示路由路径, <code>onComplete</code>和<code>onAbort</code>是可选的2个 <strong>回调函数</strong>, 表示跳转成功和失败时调用的方法</li>
<li><code>replace(location, onComplete, onAbort)</code></li>
</ol>
<p>给一个按钮绑定点击事件实现跳转</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>jump<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>跳转<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
</code></pre>
<p>设置跳转方法</p>
<pre class=" language-js"><code class="language-js">methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">jump</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'/user/1'</span><span class="token punctuation">)</span>
        <span class="token comment" spellcheck="true">// 对于命名路由以下效果一样</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'user'</span><span class="token punctuation">,</span> params<span class="token punctuation">:</span> <span class="token punctuation">{</span>id<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="路由传参"><a href="#路由传参" class="headerlink" title="路由传参"></a>路由传参</h3><p>除了传递 <strong>动态路径参数</strong> 外, Vue 路由还可接收类似于 <code>GET</code> <strong>请求参数</strong>类似的 <code>query</code></p>
<ol>
<li><p>修改<code>/home</code>路由配置:</p>
<pre class=" language-js"><code class="language-js"><span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'/home'</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">'home'</span><span class="token punctuation">,</span> component<span class="token punctuation">:</span> Home<span class="token punctuation">}</span>
</code></pre>
</li>
<li><p><code>&lt;router-link&gt;</code>组件传递<code>query</code>对象</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">:to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{name:<span class="token punctuation">'</span>home<span class="token punctuation">'</span>,query:{msg:<span class="token punctuation">'</span>hello<span class="token punctuation">'</span>}}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>首页<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">></span></span>
</code></pre>
</li>
<li><p>在 Home 组件中获取<code>query</code>对象</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">var</span> Home <span class="token operator">=</span> <span class="token punctuation">{</span>
    template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`&lt;h1>首页&lt;/h1>`</span></span><span class="token punctuation">,</span>
    <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
</li>
</ol>
<h3 id="命名视图"><a href="#命名视图" class="headerlink" title="命名视图"></a>命名视图</h3><p>有时候, 我们需要一个路由页面同时显示多个视图组件, 而不是嵌套显示, 如头部搜索框<code>SearchBar</code>需要在路由<code>/home</code>和<code>/about</code>中同时显示, 而<code>/user</code>中不需要显示, 此时就需要用到 <strong>命名视图</strong></p>
<ol>
<li><p>修改路由</p>
<pre class=" language-js"><code class="language-js"><span class="token comment" spellcheck="true">// 定义头部搜索框组件</span>
<span class="token keyword">var</span> SearchBar <span class="token operator">=</span> <span class="token punctuation">{</span>template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`&lt;div>头部搜索框&lt;/div>`</span></span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    routes<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            path<span class="token punctuation">:</span> <span class="token string">'/home'</span><span class="token punctuation">,</span>
            name<span class="token punctuation">:</span> <span class="token string">'home'</span><span class="token punctuation">,</span>
            <span class="token comment" spellcheck="true">// 定义路由时, 不再只引入一个组件, components</span>
            <span class="token comment" spellcheck="true">// 通过对象方式引入多个组件</span>
            <span class="token comment" spellcheck="true">// default为必须项, 其他key可自定义, 与命名视图的name特性关联</span>
            components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token keyword">default</span><span class="token punctuation">:</span> Home<span class="token punctuation">,</span>
                searchbar<span class="token punctuation">:</span> SearchBar
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            path<span class="token punctuation">:</span> <span class="token string">'/about'</span><span class="token punctuation">,</span>
            components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token keyword">default</span><span class="token punctuation">:</span> About<span class="token punctuation">,</span>
                searchbar<span class="token punctuation">:</span> SearchBar
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
</li>
<li><p>使用命名视图</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">:to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{name:<span class="token punctuation">'</span>home<span class="token punctuation">'</span>,query:{msg:<span class="token punctuation">'</span>hello<span class="token punctuation">'</span>}}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>首页<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/about<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>关于<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">:to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{name:<span class="token punctuation">'</span>user<span class="token punctuation">'</span>,params:{id:1}}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>我的<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">></span></span>
    <span class="token comment" spellcheck="true">&lt;!-- 使用命名视图, name不设置默认为default --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>searchbar<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-view</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-view</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
</code></pre>
</li>
</ol>
<h3 id="props配置项"><a href="#props配置项" class="headerlink" title="props配置项"></a>props配置项</h3><p>在组件中使用 <code>$route</code> 会使之与其对应路由形成 <strong>高度耦合</strong>，从而使组件只能在某些特定的 URL 上使用，限制了其灵活性。使用 <code>props</code> 配置项将组件和路由解耦：</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">var</span> User <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 模板直接使用id</span>
    template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`
&lt;div>
    &lt;p>用户 {{id}}&lt;/p>
    &lt;router-link :to="{name:'info'}">详情&lt;/router-link>
    &lt;router-link :to="{name:'wallet'}">钱包&lt;/router-link>
    &lt;router-view>&lt;/router-view>
&lt;/div>`</span></span><span class="token punctuation">,</span>
    <span class="token comment" spellcheck="true">// 定义组件时, 通过props接收动态路径参数id</span>
    props<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    routes<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            path<span class="token punctuation">:</span> <span class="token string">'/user/:id'</span><span class="token punctuation">,</span>
            name<span class="token punctuation">:</span> <span class="token string">'user'</span><span class="token punctuation">,</span>
            component<span class="token punctuation">:</span> User<span class="token punctuation">,</span>
            <span class="token comment" spellcheck="true">// 设置路由时, 配置props: true, route.params将会被接收成为组件实例的属性</span>
            props<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            children<span class="token punctuation">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">{</span>
                    path<span class="token punctuation">:</span> <span class="token string">'info'</span><span class="token punctuation">,</span>
                    name<span class="token punctuation">:</span> <span class="token string">'info'</span><span class="token punctuation">,</span>
                    component<span class="token punctuation">:</span> Info
                <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
                    path<span class="token punctuation">:</span> <span class="token string">'wallet'</span><span class="token punctuation">,</span>
                    name<span class="token punctuation">:</span> <span class="token string">'wallet'</span><span class="token punctuation">,</span>
                    component<span class="token punctuation">:</span> Wallet
                <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="props的其他使用方法"><a href="#props的其他使用方法" class="headerlink" title="props的其他使用方法"></a>props的其他使用方法</h4><ol>
<li><p>对于包含 <strong>命名视图</strong> 的路由, 必须使用对象的形式给每个命名视图设置<code>props</code></p>
<pre class=" language-js"><code class="language-js"><span class="token comment" spellcheck="true">// 为`/user/:id`路由添加一个订单命名视图</span>
<span class="token keyword">var</span> Order <span class="token operator">=</span> <span class="token punctuation">{</span>template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`&lt;div>订单&lt;/div>`</span></span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//定义路由</span>
<span class="token keyword">var</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    routes<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            path<span class="token punctuation">:</span> <span class="token string">'/user/:id'</span><span class="token punctuation">,</span>
            name<span class="token punctuation">:</span> <span class="token string">'user'</span><span class="token punctuation">,</span>
            components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token keyword">default</span><span class="token punctuation">:</span> User<span class="token punctuation">,</span>
                order<span class="token punctuation">:</span> Order
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            props<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token comment" spellcheck="true">// 为每个命名视图配置props</span>
                <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                order<span class="token punctuation">:</span> falue
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            children<span class="token punctuation">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">{</span>
                    path<span class="token punctuation">:</span> <span class="token string">'info'</span><span class="token punctuation">,</span>
                    name<span class="token punctuation">:</span> <span class="token string">'info'</span><span class="token punctuation">,</span>
                    component<span class="token punctuation">:</span> Info
                <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
                    path<span class="token punctuation">:</span> <span class="token string">'wallet'</span><span class="token punctuation">,</span>
                    name<span class="token punctuation">:</span> <span class="token string">'wallet'</span><span class="token punctuation">,</span>
                    component<span class="token punctuation">:</span> Wallet
                <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
</li>
<li><p>给 <strong>没有命名视图</strong> 的路由可通过对象形式传递 <strong>静态参数</strong></p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">var</span> Test <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 定义组件时接收并使用</span>
    template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`&lt;h1>{{msg}}&lt;/h1>`</span></span><span class="token punctuation">,</span>
    props<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    routes<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            path<span class="token punctuation">:</span> <span class="token string">'/test'</span><span class="token punctuation">,</span>
            name<span class="token punctuation">:</span> <span class="token string">'test'</span><span class="token punctuation">,</span>
            component<span class="token punctuation">:</span> Test<span class="token punctuation">,</span>
            <span class="token comment" spellcheck="true">// 传递静态参数</span>
            props<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                msg<span class="token punctuation">:</span> <span class="token string">'hello'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
</li>
<li><p>以 <strong>函数</strong> 形式返回<code>props</code>, 高级用法</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token comment" spellcheck="true">&lt;!-- 跳转路由时, 传入params和query --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">:to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{name:<span class="token punctuation">'</span>user<span class="token punctuation">'</span>,params:{id:1},query:{num:520}}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>我的<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-view</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>order<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-view</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
    <span class="token keyword">var</span> User <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// 在模板中直接使用</span>
        template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`
    &lt;div>
        &lt;p>用户 {{id}}&lt;/p>
        &lt;p>{{msg}}&lt;/p>
        &lt;p>{{num}}&lt;/p>
        &lt;router-link :to="{name:'info'}">详情&lt;/router-link>
        &lt;router-link :to="{name:'wallet'}">钱包&lt;/router-link>
        &lt;router-view>&lt;/router-view>
    &lt;/div>`</span></span><span class="token punctuation">,</span>
        <span class="token comment" spellcheck="true">// 定义组件时, 接收路径参数id, 请求参数num以及静态参数msg</span>
        props<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'msg'</span><span class="token punctuation">,</span> <span class="token string">'num'</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        routes<span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                path<span class="token punctuation">:</span> <span class="token string">'/user/:id'</span><span class="token punctuation">,</span>
                name<span class="token punctuation">:</span> <span class="token string">'user'</span><span class="token punctuation">,</span>
                components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    <span class="token keyword">default</span><span class="token punctuation">:</span> User<span class="token punctuation">,</span>
                    order<span class="token punctuation">:</span> Order
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                props<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    <span class="token comment" spellcheck="true">// 定义路由时通过函数方式返回props</span>
                    <span class="token keyword">default</span><span class="token punctuation">:</span> route <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
                        id<span class="token punctuation">:</span> route<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
                        num<span class="token punctuation">:</span> route<span class="token punctuation">.</span>query<span class="token punctuation">.</span>num<span class="token punctuation">,</span>
                        msg<span class="token punctuation">:</span> <span class="token string">'hello'</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    order<span class="token punctuation">:</span> <span class="token boolean">false</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                children<span class="token punctuation">:</span> <span class="token punctuation">[</span>
                    <span class="token punctuation">{</span>
                        path<span class="token punctuation">:</span> <span class="token string">'info'</span><span class="token punctuation">,</span>
                        name<span class="token punctuation">:</span> <span class="token string">'info'</span><span class="token punctuation">,</span>
                        component<span class="token punctuation">:</span> Info
                    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
                        path<span class="token punctuation">:</span> <span class="token string">'wallet'</span><span class="token punctuation">,</span>
                        name<span class="token punctuation">:</span> <span class="token string">'wallet'</span><span class="token punctuation">,</span>
                        component<span class="token punctuation">:</span> Wallet
                    <span class="token punctuation">}</span>
                <span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
</li>
</ol>
<h3 id="命名视图传参"><a href="#命名视图传参" class="headerlink" title="命名视图传参"></a>命名视图传参</h3><p>在命名视图<code>&lt;router-view&gt;</code>组件中通过<code>v-bind:prop</code>可传递参数到对应视图组件中</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>searchbar<span class="token punctuation">"</span></span> <span class="token attr-name">msg</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>头部搜索框<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-view</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
    <span class="token keyword">var</span> SearchBar <span class="token operator">=</span> <span class="token punctuation">{</span>
        template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`&lt;div>{{msg}}&lt;/div>`</span></span><span class="token punctuation">,</span>
        props<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
<h3 id="keep-alive组件和相关生命周期钩子"><a href="#keep-alive组件和相关生命周期钩子" class="headerlink" title="keep-alive组件和相关生命周期钩子"></a>keep-alive组件和相关生命周期钩子</h3><p>使用一个简单的路由系统介绍<code>&lt;keep-alive&gt;</code>组件</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token comment" spellcheck="true">&lt;!-- 使用导航组件和路由视图组件 --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-nav</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-nav</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-view</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>my-nav<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>(item,index) in list<span class="token punctuation">"</span></span> <span class="token attr-name">:to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{name:item.name}<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>index<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>{{item.title}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>js/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>js/vue-router.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
    <span class="token comment" spellcheck="true">// 设置导航组件</span>
    <span class="token keyword">var</span> MyNav <span class="token operator">=</span> <span class="token punctuation">{</span>
        template<span class="token punctuation">:</span> <span class="token string">'#my-nav'</span><span class="token punctuation">,</span>
        <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                list<span class="token punctuation">:</span> <span class="token punctuation">[</span>
                    <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'home'</span><span class="token punctuation">,</span> title<span class="token punctuation">:</span> <span class="token string">'主页'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'category'</span><span class="token punctuation">,</span> title<span class="token punctuation">:</span> <span class="token string">'分类'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'topic'</span><span class="token punctuation">,</span> title<span class="token punctuation">:</span> <span class="token string">'话题'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'cart'</span><span class="token punctuation">,</span> title<span class="token punctuation">:</span> <span class="token string">'购物车'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'user'</span><span class="token punctuation">,</span> title<span class="token punctuation">:</span> <span class="token string">'我的'</span><span class="token punctuation">}</span>
                <span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">// 设置路由视图组件, 每个组件创建后发一个请求获取数据</span>
    <span class="token keyword">var</span> Home <span class="token operator">=</span> <span class="token punctuation">{</span>
        template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`&lt;div>主页&lt;/div>`</span></span><span class="token punctuation">,</span>
        <span class="token keyword">async</span> <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'./data/home.json'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> Category <span class="token operator">=</span> <span class="token punctuation">{</span>
        template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`&lt;div>分类&lt;/div>`</span></span><span class="token punctuation">,</span>
        <span class="token keyword">async</span> <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'./data/category.json'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> Topic <span class="token operator">=</span> <span class="token punctuation">{</span>
        template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`&lt;div>话题&lt;/div>`</span></span><span class="token punctuation">,</span>
        <span class="token keyword">async</span> <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'./data/topic.json'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> Cart <span class="token operator">=</span> <span class="token punctuation">{</span>
        template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`&lt;div>购物车&lt;/div>`</span></span><span class="token punctuation">,</span>
        <span class="token keyword">async</span> <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'./data/cart.json'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> User <span class="token operator">=</span> <span class="token punctuation">{</span>
        template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`&lt;div>我的&lt;/div>`</span></span><span class="token punctuation">,</span>
        <span class="token keyword">async</span> <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'./data/user.json'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">// 设置简单路由</span>
    <span class="token keyword">var</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        routes<span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> redirect<span class="token punctuation">:</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'home'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'/home'</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">'home'</span><span class="token punctuation">,</span> component<span class="token punctuation">:</span> Home<span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'/category'</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">'category'</span><span class="token punctuation">,</span> component<span class="token punctuation">:</span> Category<span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'/topic'</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">'topic'</span><span class="token punctuation">,</span> component<span class="token punctuation">:</span> Topic<span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'/cart'</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">'cart'</span><span class="token punctuation">,</span> component<span class="token punctuation">:</span> Cart<span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'/user'</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">'user'</span><span class="token punctuation">,</span> component<span class="token punctuation">:</span> User<span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">// 定义根实例</span>
    <span class="token keyword">var</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        el<span class="token punctuation">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
        router<span class="token punctuation">,</span>
        components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            MyNav
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
<p>观察 Vue 官方提供的 <font color="yellowgreen"><strong>Devtools</strong></font> (谷歌浏览器插件)</p>
<p><img src="/images/devtools-home.png" alt="&quot;主页&quot;页面"></p>
<p><img src="/images/devtools-category.png" alt="&quot;我的&quot;页面"></p>
<p><img src="/images/devtools-topic.png" alt="&quot;话题&quot;页面"></p>
<p><img src="/images/devtools-cart.png" alt="&quot;购物车&quot;页面"></p>
<p><img src="/images/devtools-user.png" alt="&quot;我的&quot;页面"></p>
<p>每次切换路由, <code>&lt;Anoymous Component&gt;</code>匿名组件就是我们<code>&lt;router-view&gt;</code>展示的组件, 再看一下网络请求以及控制台打印结果</p>
<p><img src="/images/netrequest.png" alt="网络请求"></p>
<p>来回切换路由时, 会 <strong>重复</strong> (重新)发起请求, 这无疑会消耗占用用户的宽带, 而且, 重新发起请求证明组件的<code>created</code>钩子函数重新触发, 即组件重新渲染( <font color="tomato">re-render</font> ), 然而在大多情况下, 同一次会话( session )中, 页面一般不会有太大的改变, 即不需要重复请求获取数据, 此时我们需要用到<code>&lt;keep-alive&gt;</code>组件, 把组件缓存起来, 而不是让它重新渲染</p>
<p><span id="keepalive"></span></p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-nav</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-nav</span><span class="token punctuation">></span></span>
    <span class="token comment" spellcheck="true">&lt;!-- keep-alive组件和transition组件一样, 内部只能放置一个组件/元素 --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>keep-alive</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-view</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>keep-alive</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
</code></pre>
<p>使用<code>&lt;keep-alive&gt;</code>组件后, 多次切换路由的 Devtools 和 控制台打印结果</p>
<p><img src="/images/keep-alive.png" alt="keep-alive组件效果"></p>
<p><strong>首次切换</strong> 路由时, 加载对应视图组件并 <strong>缓存</strong> 起来; <strong>再次切换</strong> 时, 当前视图组件进入<code>activeated</code>( <font color="yellowgreen">激活时调用</font> ), 已缓存的视图组件进入<code>deactivated</code>( <font color="yellowgreen">停用时调用</font> )</p>
<h2 id="Webpack"><a href="#Webpack" class="headerlink" title="Webpack"></a>Webpack</h2><p>webpack 是前端自动化构建工具, <strong>核心概念</strong>:</p>
<ol>
<li>入口( entry ), 工程的入口文件配置</li>
<li>输出( output ), 打包的输出文件配置</li>
<li>加载器( loader ), 用于处理不同类型的模块, 可拓展</li>
<li>插件( plugins ), 在打包过程中执行一些任务, 如清除打包目录, 复制静态文件等</li>
<li>模式( mode ), <code>development</code>开发模式, <code>production</code>生产模式</li>
</ol>
<p><font color="deepskyblue">在 webpack 中, 所有静态资源都可以被处理为一个 <strong>模块</strong>, 包括图片、CSS、JS等等</font>.</p>
<h3 id="webpack与gulp、grunt区别"><a href="#webpack与gulp、grunt区别" class="headerlink" title="webpack与gulp、grunt区别"></a>webpack与gulp、grunt区别</h3><p>webpack是 <strong>模块化</strong> 打包工具, gulp、grunt是 <strong>流程化</strong> 任务工具</p>
<p><strong>webpack</strong> 的工作方式: 将所有资源通过<code>commonJS</code>或者<code>ES6模块化</code>形式引入到主(入口)文件<code>main.js</code>中, 通过<code>loader</code>加载器将不同的文件资源处理成模块( <strong>按需加载</strong> ), 最后打包成浏览器识别的JS文件, 打包方式可通过命令行( <strong>开箱即用</strong> )或者 <strong>配置文件</strong></p>
<p><strong>gulp</strong> 的工作方式: <code>stream流</code>, 必须编写配置文件<code>gulpfile.js</code>, 创建任务<code>task</code>流式(<code>pipe</code>)处理每种资源还有项目依赖, <font color="tomato">历遍源文件</font>→<font color="tomato">匹配规则</font>→<font color="tomato">打包</font>( <strong>不能按需加载</strong> )</p>
<h3 id="与webpack类似的工具"><a href="#与webpack类似的工具" class="headerlink" title="与webpack类似的工具"></a>与webpack类似的工具</h3><p>基于入口的打包工具: webpack、rollup、parcel</p>
<p>应用场景:</p>
<ul>
<li><strong>webpack</strong> 适用于大型复杂前端项目构建</li>
<li><strong>rollup</strong> 适用于基础库(JS库)打包, 如vue, react</li>
<li><strong>parcel</strong> 适用于简单的实验性项目, 会自动将使用到的依赖下载到本地</li>
</ul>
<p>webpack 目前正在往 parcel 方向设计, 真正达到开箱即用</p>
<h3 id="起步"><a href="#起步" class="headerlink" title="起步"></a>起步</h3><h4 id="全局安装"><a href="#全局安装" class="headerlink" title="全局安装"></a>全局安装</h4><pre class=" language-node"><code class="language-node">npm i -g webpack webpack-cli
</code></pre>
<h4 id="本地项目安装"><a href="#本地项目安装" class="headerlink" title="本地项目安装"></a>本地项目安装</h4><pre class=" language-node"><code class="language-node">npm init -y
npm i -D webpack webpack-cli
</code></pre>
<h4 id="命令行打包"><a href="#命令行打包" class="headerlink" title="命令行打包"></a>命令行打包</h4><p><code>webpack 本地文件 --output 输出目录地址文件</code>, 其中<code>--output</code>可以简写成<code>-o</code>, 如</p>
<pre class=" language-node"><code class="language-node">webpack src/main.js -o dist/bundle.js
</code></pre>
<h4 id="配置文件打包"><a href="#配置文件打包" class="headerlink" title="配置文件打包"></a>配置文件打包</h4><p>使用命令行打包需要我们每次都去编写并执行命令行, 所以一般我们执行配置文件<code>webpack.config.js</code>进行打包</p>
<pre class=" language-js"><code class="language-js"><span class="token comment" spellcheck="true">// 配置文件仅支持common.js</span>
<span class="token comment" spellcheck="true">// 需要使用node内置模块进行路径拼接</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 封装方法</span>
<span class="token keyword">function</span> <span class="token function">resolve</span><span class="token punctuation">(</span>paths<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> paths<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 入口文件</span>
    entry<span class="token punctuation">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'./src/main.js'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment" spellcheck="true">// 输出目录文件</span>
    output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        path<span class="token punctuation">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'./dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        filename<span class="token punctuation">:</span> <span class="token string">"bundle.js"</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>然后在命令行中, 可直接使用<code>webpack</code>执行打包</p>
<pre class=" language-node"><code class="language-node">webpack
</code></pre>
<p>或者, 在<code>package.json</code>配置<code>script</code>脚本</p>
<pre class=" language-json"><code class="language-json"><span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">"start"</span><span class="token operator">:</span> <span class="token string">"webpack"</span>
<span class="token punctuation">}</span>
</code></pre>
<p>然后在命令行中</p>
<pre class=" language-node"><code class="language-node">npm start
</code></pre>
<h3 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h3><p><code>main.js</code>就是我们整个项目打包的入口文件, 我们将会在这个文件中引入各种模块(包括图片, css, js), 我们只需在页面<code>index.html</code>引入<code>bundle.js</code>即可</p>
<h4 id="html-webpack-plugin插件"><a href="#html-webpack-plugin插件" class="headerlink" title="html-webpack-plugin插件"></a>html-webpack-plugin插件</h4><p>使用<code>html-webpack-plugin</code>插件, 能让webpack在打包过程中自动将<code>bundle.js</code>引入到<code>index.html</code>中</p>
<ol>
<li><p>安装</p>
<pre class=" language-node"><code class="language-node">npm i -D html-webpack-plugin
</code></pre>
</li>
<li><p>使用</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// 引入插件</span>
<span class="token keyword">const</span> HtmlPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">resolve</span><span class="token punctuation">(</span>paths<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> paths<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 开发者模式</span>
    mode<span class="token punctuation">:</span> <span class="token string">'development'</span><span class="token punctuation">,</span>
    entry<span class="token punctuation">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'./src/main.js'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        path<span class="token punctuation">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'./dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        filename<span class="token punctuation">:</span> <span class="token string">"bundle.js"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment" spellcheck="true">// 使用插件</span>
    plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">HtmlPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            template<span class="token punctuation">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'./src/index.html'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            filename<span class="token punctuation">:</span> <span class="token string">"index.html"</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
</li>
<li><p>运行<code>npm start</code></p>
</li>
</ol>
<h4 id="热更新服务"><a href="#热更新服务" class="headerlink" title="热更新服务"></a>热更新服务</h4><p>现在我们每次更新代码都需要手动运行命令行并刷新浏览器才能看到效果, 使用<code>webpack-dev-server</code>可以让 webpack 自动打包并刷新浏览器</p>
<ol>
<li><p>安装</p>
<pre class=" language-node"><code class="language-node">npm i -D webpack-dev-server
</code></pre>
</li>
<li><p>修改<code>package.json</code></p>
<pre class=" language-json"><code class="language-json"><span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">"start"</span><span class="token operator">:</span> <span class="token string">"webpack-dev-server --open --port 3000 --hot"</span>
<span class="token punctuation">}</span>
</code></pre>
</li>
<li><p>运行<code>npm start</code></p>
</li>
</ol>
<h4 id="加载器-loader"><a href="#加载器-loader" class="headerlink" title="加载器 loader"></a>加载器 loader</h4><p>在 webpack 打包过程中, 所有静态资源都是通过 <strong>ES6模块</strong> 引入进<code>main.js</code>中实现打包的</p>
<h5 id="引入-js-模块文件"><a href="#引入-js-模块文件" class="headerlink" title="引入 js 模块文件"></a>引入 <font color="deepskyblue"><strong>js</strong></font> 模块文件</h5><p>引入js模块文件不需要加载器, 如</p>
<ol>
<li><p>编写一个工具类模块<code>src/js/utils.js</code></p>
<pre class=" language-js"><code class="language-js"><span class="token comment" spellcheck="true">/**
 * 数组去重
 * @param arr 需要去重的数组
 * @returns 处理后的新数组
 */</span>
<span class="token keyword">function</span> <span class="token function">duplicate</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> arr<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>tar<span class="token punctuation">,</span> cur<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
        tar<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>cur<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> tar<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>cur<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> tar
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> utils <span class="token operator">=</span> <span class="token punctuation">{</span>
    duplicate
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> utils
</code></pre>
</li>
<li><p>在<code>main.js</code>中引入模块文件并使用</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">import</span> utils <span class="token keyword">from</span> <span class="token string">"./js/utils"</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> res <span class="token operator">=</span> utils<span class="token punctuation">.</span><span class="token function">duplicate</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
</li>
</ol>
<h5 id="引入-css-文件"><a href="#引入-css-文件" class="headerlink" title="引入 css 文件"></a>引入 <font color="deepskyblue"><strong>css</strong></font> 文件</h5><ol>
<li><p>下载<code>style-loader</code>,<code>css-loader</code></p>
<pre class=" language-node"><code class="language-node">npm i -D style-loader css-loader
</code></pre>
</li>
<li><p>修改配置文件</p>
<pre class=" language-js"><code class="language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    mode<span class="token punctuation">:</span> <span class="token string">'development'</span><span class="token punctuation">,</span>
    entry<span class="token punctuation">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'./src/main.js'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        path<span class="token punctuation">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'./dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        filename<span class="token punctuation">:</span> <span class="token string">"bundle.js"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">HtmlPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            template<span class="token punctuation">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'./src/index.html'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            filename<span class="token punctuation">:</span> <span class="token string">"index.html"</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// 编写所有加载器使用规则</span>
        rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>test<span class="token punctuation">:</span> <span class="token regex">/\.css$/</span><span class="token punctuation">,</span> use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'style-loader'</span><span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
</li>
<li><p><code>main.js</code>中引入css文件</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token string">"./css/reset.css"</span>
</code></pre>
</li>
</ol>
<h5 id="引入-less-文件"><a href="#引入-less-文件" class="headerlink" title="引入 less 文件"></a>引入 <font color="deepskyblue">less</font> 文件</h5><ol>
<li><p>下载<code>less-loader</code>,<code>less</code></p>
<pre class=" language-node"><code class="language-node">npm i -D less less-loader
</code></pre>
</li>
<li><p>添加<code>rules</code></p>
<pre class=" language-js"><code class="language-js"><span class="token punctuation">{</span>test<span class="token punctuation">:</span> <span class="token regex">/\.less$/</span><span class="token punctuation">,</span> use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'style-loader'</span><span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">,</span> <span class="token string">'less-loader'</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
</code></pre>
</li>
<li><p><code>main.js</code>中引入less文件</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token string">"./less/style.less"</span>
</code></pre>
</li>
</ol>
<h5 id="引入-scss-文件"><a href="#引入-scss-文件" class="headerlink" title="引入 scss 文件"></a>引入 <font color="deepskyblue">scss</font> 文件</h5><ol>
<li><p>下载<code>sass-loader</code>,<code>node-sass</code></p>
<pre class=" language-node"><code class="language-node">npm i -D sass-loader node-sass
</code></pre>
</li>
<li><p>添加<code>rules</code></p>
<pre class=" language-js"><code class="language-js"><span class="token punctuation">{</span>test<span class="token punctuation">:</span> <span class="token regex">/\.scss$/</span><span class="token punctuation">,</span> use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'style-loader'</span><span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">,</span> <span class="token string">'sass-loader'</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
</code></pre>
</li>
<li><p><code>main.js</code>中引入scss文件</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token string">'./scss/style.scss'</span>
</code></pre>
</li>
</ol>
<h5 id="热更新index-html"><a href="#热更新index-html" class="headerlink" title="热更新index.html"></a>热更新index.html</h5><ol>
<li><p>下载<code>raw-loader</code></p>
<pre class=" language-node"><code class="language-node">npm i -D raw-loader
</code></pre>
</li>
<li><p>添加<code>rules</code></p>
<pre class=" language-js"><code class="language-js"><span class="token punctuation">{</span>test<span class="token punctuation">:</span> <span class="token regex">/\.html?$/i</span><span class="token punctuation">,</span> use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'raw-loader'</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
</code></pre>
</li>
<li><p><code>main.js</code>中引入<code>./index.html</code></p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token string">"./index.html"</span>
</code></pre>
</li>
</ol>
<h5 id="处理图片"><a href="#处理图片" class="headerlink" title="处理图片"></a>处理图片</h5><ol>
<li><p>下载<code>url-loader</code>,<code>html-withimg-loader</code></p>
<pre class=" language-node"><code class="language-node">npm i -D url-loader html-withimg-loader
</code></pre>
</li>
<li><p>添加<code>rules</code></p>
<pre class=" language-js"><code class="language-js"><span class="token punctuation">{</span>test<span class="token punctuation">:</span> <span class="token regex">/\.(png|jpe?g|gif)$/i</span><span class="token punctuation">,</span> use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'url-loader'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token comment" spellcheck="true">// 处理html中的img标签需要html-withimg-loader(国人开发), 与raw-loader冲突, 只能使用一个</span>
<span class="token punctuation">{</span>test<span class="token punctuation">:</span> <span class="token regex">/\.html?$/i</span><span class="token punctuation">,</span> use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'html-withimg-loader'</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
</code></pre>
</li>
</ol>
<h6 id="url-loader更多配置"><a href="#url-loader更多配置" class="headerlink" title="url-loader更多配置"></a><strong>url-loader更多配置</strong></h6><p><code>url-loader</code>默认将图片路径转成<code>Base64</code>编码, 然而对于一些高清图, 转码起来耗时长且消耗性能多, 所以可以设置一个限制值( 单位字节 bytes ), 大于该值时, 会使用<code>file-loader</code>(默认)打包图片</p>
<ol>
<li><p>下载<code>file-loader</code></p>
<pre class=" language-node"><code class="language-node">npm i -D file-loader
</code></pre>
</li>
<li><p>修改<code>rules</code>, 一般限制不超过 <strong>8kb</strong></p>
<pre class=" language-js"><code class="language-js"><span class="token punctuation">{</span>test<span class="token punctuation">:</span> <span class="token regex">/\.(png|jpe?g|gif)$/i</span><span class="token punctuation">,</span> use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>loader<span class="token punctuation">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span> options<span class="token punctuation">:</span> <span class="token punctuation">{</span>limit<span class="token punctuation">:</span> <span class="token number">8192</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
</code></pre>
</li>
</ol>
<p>使用<code>Base64</code>编码时, 我们还可以设置<code>mimetype</code>将图片转成统一格式的<code>Base64</code>编码, 一般设为<code>image/png</code></p>
<pre class=" language-js"><code class="language-js"><span class="token punctuation">{</span>test<span class="token punctuation">:</span> <span class="token regex">/\.(png|jpe?g|gif)$/i</span><span class="token punctuation">,</span> use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>loader<span class="token punctuation">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span> options<span class="token punctuation">:</span> <span class="token punctuation">{</span>limit<span class="token punctuation">:</span> <span class="token number">8192</span><span class="token punctuation">,</span> mimetype<span class="token punctuation">:</span> <span class="token string">'image/png'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
</code></pre>
<p>当图片大小超过<code>limit</code>值时, 我们还可以设置<code>callback</code>用其他加载器打包图片</p>
<ol>
<li><p>下载<code>responsive-loader</code>,<code>jimp</code>(简单压缩), 如需压缩大量图片使用(<code>sharp</code>)</p>
<pre class=" language-node"><code class="language-node">npm i -D responsive-loader jimp
</code></pre>
</li>
<li><p>修改<code>rules</code>, 压缩图片</p>
<pre class=" language-js"><code class="language-js"><span class="token punctuation">{</span>test<span class="token punctuation">:</span> <span class="token regex">/\.(png|jpe?g|gif)$/i</span><span class="token punctuation">,</span> use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>loader<span class="token punctuation">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span> options<span class="token punctuation">:</span> <span class="token punctuation">{</span>limit<span class="token punctuation">:</span> <span class="token number">8192</span><span class="token punctuation">,</span> callback<span class="token punctuation">:</span> <span class="token string">'responsive-loader'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
</code></pre>
</li>
</ol>
<p>使用<code>file-loader</code>或者<code>responsive-loader</code>时, 默认文件名是文件内容的<code>MD5</code>哈希值和原拓展名, 可以设置<code>name</code>将图片文件的名字取代<code>MD5</code>哈希值</p>
<pre class=" language-js"><code class="language-js"><span class="token punctuation">{</span>test<span class="token punctuation">:</span> <span class="token regex">/\.(png|jpe?g|gif)$/i</span><span class="token punctuation">,</span> use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>loader<span class="token punctuation">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span> options<span class="token punctuation">:</span> <span class="token punctuation">{</span>limit<span class="token punctuation">:</span> <span class="token number">8192</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">'[path][name].[ext]'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
</code></pre>
<p>为了解决缓存问题, 一般会带上<code>MD5</code>哈希值的前8位</p>
<pre class=" language-js"><code class="language-js"><span class="token punctuation">{</span>test<span class="token punctuation">:</span> <span class="token regex">/\.(png|jpe?g|gif)$/i</span><span class="token punctuation">,</span> use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>loader<span class="token punctuation">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span> options<span class="token punctuation">:</span> <span class="token punctuation">{</span>limit<span class="token punctuation">:</span> <span class="token number">8192</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">'[path][name]-[hash:8].[ext]'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
</code></pre>
<h5 id="使用Babel"><a href="#使用Babel" class="headerlink" title="使用Babel"></a>使用Babel</h5><p>为了让我们的js代码兼容各大浏览器, 使用babel将ES6, ES7语法转成ES5语法</p>
<ol>
<li><p>下载<code>babel</code>相关依赖</p>
<pre class=" language-node"><code class="language-node">npm i -D babel-loader@7.1.5 babel-core babel-preset-env babel-preset-stage-0 babel-plugin-transform-runtime
</code></pre>
<p>a) <a href="mailto:`babel-loader@7.1.5" target="_blank" rel="noopener">`babel-loader@7.1.5</a><code>, 指定加载器版本, 为了使用</code>babel-preset-stage-0`, 兼容跟多浏览器</p>
<p>b) <code>babel-core</code>, babel核心库, 是<code>babel-loader</code>的依赖项</p>
<p>c) <code>babel-preset-env</code>和<code>babel-preset-stage-0</code>, babel预设, <code>stage</code>有4个阶段, 可按需加载对应阶段功能, 其中<code>0</code>涵盖所有阶段的功能</p>
<p>d) <code>babel-plugin-transform-runtime</code>, babel插件, 对不同js文件中引用同一模块, 该模块只打包一次</p>
</li>
<li><p>配置<code>rules</code></p>
<pre class=" language-js"><code class="language-js"><span class="token comment" spellcheck="true">// exclude 忽视npm或者bower下载的第三方库</span>
<span class="token punctuation">{</span>test<span class="token punctuation">:</span> <span class="token regex">/\.m?js$/</span><span class="token punctuation">,</span> exclude<span class="token punctuation">:</span> <span class="token regex">/(node_modules|bower_components)/</span><span class="token punctuation">,</span> use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'babel-loader'</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
</code></pre>
</li>
<li><p>配置<code>.babelrc</code>文件</p>
<pre class=" language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"presets"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">"env"</span><span class="token punctuation">,</span>
    <span class="token string">"stage-0"</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"plugins"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">"transform-runtime"</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
</li>
</ol>
<h4 id="调试工具-devtool"><a href="#调试工具-devtool" class="headerlink" title="调试工具 devtool"></a>调试工具 devtool</h4><p><code>devtool</code>有多个配置项, 开发时建议使用<code>cheap-module-eval-souce-map</code>, 快速定位到对应模块文件的对应位置</p>
<pre class=" language-js"><code class="language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  mode<span class="token punctuation">:</span> <span class="token string">'development'</span><span class="token punctuation">,</span>
  entry<span class="token punctuation">:</span> <span class="token string">''</span><span class="token comment" spellcheck="true">/* 入口路径 */</span><span class="token punctuation">,</span>
  output<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">/* 输出 */</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token comment" spellcheck="true">/* 插件 */</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">/* 模块 */</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  resolve<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">/* 问题处理 */</span><span class="token punctuation">}</span>
  devtool<span class="token punctuation">:</span> <span class="token string">"cheap-module-eval-source-map"</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="Vue-Loader"><a href="#Vue-Loader" class="headerlink" title="Vue Loader"></a>Vue Loader</h2><p>Vue Loader 是一个 webpack 的加载器, 允许你以 <font color="yellowgreen"><strong>单文件组件(SFCs)</strong></font> 格式撰写 Vue 组件</p>
<h3 id="起步-1"><a href="#起步-1" class="headerlink" title="起步"></a>起步</h3><ol>
<li><p>下载<code>vue-loader</code>,<code>vue-style-loader</code>,<code>vue-template-complier</code>,<code>vue</code></p>
<pre class=" language-node"><code class="language-node">npm install -D vue-loader vue-style-loader vue-template-compiler
npm install -S vue
</code></pre>
</li>
<li><p>配置<code>webpack.config.js</code></p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> HtmlPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> VueLoaderPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'vue-loader/lib/plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">resolve</span><span class="token punctuation">(</span>paths<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> paths<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    mode<span class="token punctuation">:</span> <span class="token string">'development'</span><span class="token punctuation">,</span>
    entry<span class="token punctuation">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'./src/main.js'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        path<span class="token punctuation">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'./dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        filename<span class="token punctuation">:</span> <span class="token string">"bundle.js"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">HtmlPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            template<span class="token punctuation">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'./src/index.html'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            filename<span class="token punctuation">:</span> <span class="token string">"index.html"</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment" spellcheck="true">// 必须使用插件, 让其他loader识别到vue的三种顶级语言块</span>
        <span class="token keyword">new</span> <span class="token class-name">VueLoaderPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token comment" spellcheck="true">// 能匹配到普通的`.css`文件以及`.vue`文件的`&lt;style>`</span>
            <span class="token punctuation">{</span>test<span class="token punctuation">:</span> <span class="token regex">/\.css$/</span><span class="token punctuation">,</span> use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'vue-style-loader'</span><span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>test<span class="token punctuation">:</span> <span class="token regex">/\.less$/</span><span class="token punctuation">,</span> use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'vue-style-loader'</span><span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">,</span> <span class="token string">'less-loader'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>test<span class="token punctuation">:</span> <span class="token regex">/\.scss$/</span><span class="token punctuation">,</span> use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'vue-style-loader'</span><span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">,</span> <span class="token string">'sass-loader'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>test<span class="token punctuation">:</span> <span class="token regex">/\.(png|jpe?g|gif)$/i</span><span class="token punctuation">,</span> use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>loader<span class="token punctuation">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span> options<span class="token punctuation">:</span> <span class="token punctuation">{</span>limit<span class="token punctuation">:</span> <span class="token number">8192</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">'[name]-[hash:8].[ext]'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token comment" spellcheck="true">// 能匹配到普通的`.js`文件以及`.vue`文件的`&lt;script>`</span>
            <span class="token punctuation">{</span>test<span class="token punctuation">:</span> <span class="token regex">/\.m?js$/</span><span class="token punctuation">,</span> exclude<span class="token punctuation">:</span> <span class="token regex">/(node_modules|bower_components)/</span><span class="token punctuation">,</span> use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'babel-loader'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>test<span class="token punctuation">:</span> <span class="token regex">/\.vue$/</span><span class="token punctuation">,</span> use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'vue-loader'</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
</li>
</ol>
<h3 id="单文件组件"><a href="#单文件组件" class="headerlink" title="单文件组件"></a>单文件组件</h3><p><code>.vue</code>文件是一个自定义的文件类型, 用类 HTML 语法描述一个 Vue 组件, 一个<code>.vue</code>文件包含三种类型的顶级语言块<code>&lt;template&gt;</code>,<code>&lt;script&gt;</code>,<code>&lt;style&gt;</code></p>
<p><code>vue-loader</code> 会解析文件, 提取每个语言块, 如有必要会通过其它 loader 处理, 最后将他们组装成一个 ES6模块, 它的默认导出是一个 Vue.js <strong>组件选项的对象</strong></p>
<pre class=" language-html"><code class="language-html"><span class="token comment" spellcheck="true">&lt;!-- .vue文件名建议使用大驼峰命名 App.vue --></span>
<span class="token comment" spellcheck="true">&lt;!-- 一个.vue文件只能有一个template --></span>
<span class="token comment" spellcheck="true">&lt;!-- template的内容将被vue-template-compiler预处理为JS渲染函数, 注入到script导出的组件中 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
    <span class="token comment" spellcheck="true">&lt;!-- 必须有一个父容器包裹模板内容 --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
        App
        <span class="token comment" spellcheck="true">&lt;!-- 模板内容 --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!-- 一个.vue文件只能有一个script --></span>
<span class="token comment" spellcheck="true">&lt;!-- 默认导出组件选项对象, 也可以导出 Vue.extend() 创建的扩展对象 --></span>
<span class="token comment" spellcheck="true">&lt;!-- 匹配/.\js$/的webpack模板规则 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
    <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// 具名组件</span>
        name<span class="token punctuation">:</span> <span class="token string">"App"</span>
        <span class="token comment" spellcheck="true">/* 此处编写Vue实例的配置项 */</span>
    <span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token comment" spellcheck="true">&lt;!-- 一个.vue文件可以包含多个style --></span>
<span class="token comment" spellcheck="true">&lt;!-- scoped表示该样式表是对该文件(组件)的元素生效 --></span>
<span class="token comment" spellcheck="true">&lt;!-- 子组件的根节点会受父组件的作用域样式表影响, 这样设计为了让父组件可以以布局角度出发 --></span>
<span class="token comment" spellcheck="true">&lt;!-- 父组件的作用域样式表不会渗透到子组件的模板内容中 --></span>
<span class="token comment" spellcheck="true">&lt;!-- v-html创建的DOM不会受作用域样式表影响 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">></span></span><span class="token style language-css">
    <span class="token comment" spellcheck="true">/* 作用域样式表 */</span>
    <span class="token comment" spellcheck="true">/* 可通过深度选择器渗透到子组件或者v-html创建的DOM中 */</span>
    <span class="token comment" spellcheck="true">/* 深度选择器: 在正常的CSS选择器前加 >>> 或者 /deep/ */</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">
    <span class="token comment" spellcheck="true">/* 全局样式表 */</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>
<span class="token comment" spellcheck="true">&lt;!-- 默认匹配/\.css$/, 设置lang="less"后, 匹配/\.less$/ --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>less<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token style language-css">
    <span class="token comment" spellcheck="true">/* 使用预处理器less编辑样式 */</span>
    <span class="token comment" spellcheck="true">/* 注意: 使用less时, 深度选择器只能使用 /deep/ */</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>
</code></pre>
<p><span id="render"></span></p>
<h3 id="render函数"><a href="#render函数" class="headerlink" title="render函数"></a>render函数</h3><p> 在<code>main.js</code>中使用<code>App.vue</code></p>
<pre class=" language-js"><code class="language-js"><span class="token comment" spellcheck="true">// 引入vue</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">"vue"</span>
<span class="token comment" spellcheck="true">// 引入单文件组件App.vue</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">"./App.vue"</span>

<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// 在index定义挂载元素</span>
  el<span class="token punctuation">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
  <span class="token comment" spellcheck="true">// 绑定App.vue组件</span>
  components<span class="token punctuation">:</span> <span class="token punctuation">{</span>App<span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment" spellcheck="true">// 在模板中直接使用&lt;app>组件</span>
  template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`&lt;app>&lt;/app>`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>但是运行<code>npm start</code>后, 浏览器会报错:</p>
<p><img src="/images/runtime-only.png" alt="runtime-only"></p>
<p>这是因为 Vue 的NPM包<code>dist</code>目录下有多个版本的 Vue.js 构建版本, 在 <strong>webpack</strong> 等构建工具中有2版本<code>vue.esm.js</code>(完整版),<code>vue.runtime.esm.js</code>(运行时), 完整版包含 <strong>编译器</strong>, 用来将模板字符串(即<code>&lt;template&gt;</code>)编译成JS渲染函数的代码, 而<code>import</code>引入的默认是运行时<code>vue.runtime.esm.js</code>版本</p>
<p>如需使用 <strong>完整版</strong>, 需要修改<code>webpack.config.js</code>配置文件</p>
<pre class=" language-js"><code class="language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// ...其他配置项</span>
  resolve<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 起别名, 将import路径以vue结尾替换成vue/dist/vue.esm.js</span>
    <span class="token comment" spellcheck="true">// 即使用完整版</span>
    alias<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string">'vue$'</span><span class="token punctuation">:</span> <span class="token string">'vue/dist/vue.esm.js'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment" spellcheck="true">// 在resolve配置项中, 还可以设置import时省略的文件后缀名</span>
    extensions<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'.js'</span><span class="token punctuation">,</span> <span class="token string">'.vue'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>因为在绑定组件后立即使用组件作为根节点, 所以<code>main.js</code>可简写为</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">"vue"</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">"./App"</span>

<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>当然默认使用运行时版本也是有道理的, 因为在打包时, 包的体积会比使用完整版时的小<code>30%</code>, 使用</p>
<p>运行时版本, <strong>编译快</strong>, <strong>体积小</strong></p>
<p>使用 <strong>运行时</strong> 版本, 需要使用 <code>render()</code>函数</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">"vue"</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">"./App"</span>

<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>render<span class="token punctuation">:</span> h <span class="token operator">=</span><span class="token operator">></span> <span class="token function">h</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p><code>render</code>函数中接收的<code>h</code>参数其实是<code>createElement</code>的 <strong>别名</strong>, <code>createElement</code>函数返回的是<code>VNode</code>(虚拟节点), 它的作用是告诉 Vue 页面上需要渲染什么样的节点( 真实DOM节点 ), 每个<code>VNode</code>包括自身及其子节点的描述信息, 所有<code>VNode</code>组成的树叫做 <strong>虚拟DOM</strong></p>
<h4 id="虚拟DOM"><a href="#虚拟DOM" class="headerlink" title="虚拟DOM"></a>虚拟DOM</h4><p>首先先了解一下浏览器内核 <font color="yellowgreen"><strong>渲染引擎</strong></font> 的 <strong>渲染机制</strong> (各大内核大致相同):</p>
<ol>
<li><p>使用HTML分析器, 扫描文档文本, 提取标签转成DOM节点, 形成 <strong>DOM树</strong> (DOM tree)</p>
</li>
<li><p>使用CSS分析器, 将CSS代码转成 <strong>CSSOM</strong> ( CSS Object Model )</p>
</li>
<li><p>结合 DOM 和 CSSOM, 每个DOM节点调用<code>attach</code>方法 <strong>接收样式信息</strong>, 并<strong>返回</strong><code>render</code>对象, 组合形成 <strong>Render树</strong> (包含每个节点的视觉信息)</p>
</li>
<li><p>通过 Render树 生成 <strong>布局</strong> ( Layout ), 即为每个 Render树 上的节点确定一个在屏幕显示的准确坐标</p>
</li>
<li><p>调用每个节点的<code>paint</code>方法, 将 布局 <strong>绘制</strong> ( Paint ) 在屏幕上</p>
<p><img src="/images/render.png" alt="渲染引擎工作过程"></p>
</li>
</ol>
<p>注意点:</p>
<ol>
<li><strong>DOM树</strong> 的构建是 <strong>渐进</strong> 的, 不会等文档加载完才开始, 为了提高用户体验, 尽快将内容显示到页面上</li>
<li><strong>DOM树</strong> 和 <strong>CSSOM树</strong> 的基本可以当成是同步开始构建的</li>
<li><strong>DOM树</strong> , <strong>CSSOM树</strong> 和 <strong>Render树</strong>, 三者的构建是 <strong>交叉</strong> 的, 会出现 <font color="yellowgreen">一边加载、一边解析、一边渲染 </font>的工作现象</li>
<li>CSS的 <strong>读取</strong> 顺序: UA defaults(浏览器默认样式) → stylesheets (文档和外部样式表) → style=””(元素的行内样式)</li>
<li>CSS的 <strong>解析</strong> 是从 <strong>右往左逆向解析</strong> 的( 即选择器从内到外 ), 这样是为了 <strong>提高解析效率</strong>, 所以 <strong>组合选择器层次越复杂, 解析越慢</strong></li>
</ol>
<h4 id="重排-回流-和重绘"><a href="#重排-回流-和重绘" class="headerlink" title="重排(回流)和重绘"></a><strong>重排(回流)和重绘</strong></h4><p>网页的生成, 最耗时的是 <strong>“生成布局(排版)”(flow)和”绘制”(paint)</strong>, 合称 <strong>“渲染”(render)</strong></p>
<p>注意点:</p>
<ol>
<li>生成一个网页, <strong>至少会渲染一次</strong>, 用户的每次访问/操作, 都会引起重新渲染</li>
<li>以下三种情况会因此重新渲染: a) 修改DOM b) 修改CSS c) 用户事件(鼠标悬停, 页面滚动等)</li>
<li>重新渲染包括重新生成布局和重新绘制, 前者叫 <strong>重排(回流, reflow)</strong>, 后者叫 <strong>重绘(repaint)</strong>, <strong>“重绘”不一定要”重排”</strong>, <strong>“重排”一定导致”重绘”</strong></li>
</ol>
<h4 id="JS直接操作真实DOM"><a href="#JS直接操作真实DOM" class="headerlink" title="JS直接操作真实DOM"></a><strong>JS直接操作真实DOM</strong></h4><p>浏览器的每次渲染都会从构建 <strong>DOM树</strong> 开始, <strong>从头到尾</strong> 执行一遍, 比如说, 一次操作中, 我们同时修改了10个 DOM 节点, 浏览器在接收到第一个DOM更新请求后并不知道后面还有9次更新操作, 因此它会马上执行重新渲染, 导致一次操作重新渲染了10次</p>
<p>因此, 通过JS直接操作真实DOM <strong>开销非常大</strong>, <font color="yellowgreen">为了提高页面的性能, 应尽可能降低 <strong>“重排”</strong> 和 <strong>“重绘”</strong> 的频率和成本</font>.</p>
<h5 id="提高性能的技巧"><a href="#提高性能的技巧" class="headerlink" title="提高性能的技巧:"></a><strong>提高性能的技巧:</strong></h5><ol>
<li><p><strong>新增</strong> 或 <strong>删除</strong> 节点, 通过 <strong>字符串拼接</strong>(有大小限制) 或者 <strong>数组操作</strong> 在 <strong>内存中</strong> 执行修改, 然后通过<code>innerHTML</code>执行浏览器 <strong>重新渲染</strong></p>
<pre class=" language-js"><code class="language-js"><span class="token comment" spellcheck="true">// 模拟网络请求, 为新闻发布页面已存在 ul#target 新增3条li</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'内容1'</span><span class="token punctuation">,</span> <span class="token string">'内容2'</span><span class="token punctuation">,</span> <span class="token string">'内容3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

data<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>item <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// 字符串拼接</span>
  str <span class="token operator">=</span> <span class="token template-string"><span class="token string">`&lt;p></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/p>`</span></span> <span class="token operator">+</span> str<span class="token punctuation">;</span>
  <span class="token comment" spellcheck="true">// 数组操作</span>
  arr<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`&lt;p></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/p>`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// innderHTML 重新渲染</span>
<span class="token keyword">let</span> renderUl <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'target'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// renderUl.innderHTML = str + renderUl.innderHTML;</span>
renderUl<span class="token punctuation">.</span>innderHTML <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token operator">+</span> renderUl<span class="token punctuation">.</span>innderHTML<span class="token punctuation">;</span>
</code></pre>
</li>
<li><p><strong>修改样式</strong> 通过 <strong>克隆节点</strong> 在 <strong>内存中</strong> 执行修改, 然后 <strong>替换节点</strong> 执行 <strong>重新渲染</strong></p>
<pre class=" language-js"><code class="language-js"><span class="token comment" spellcheck="true">// 修改页面中 div#target 的样式</span>
<span class="token keyword">let</span> tarEl <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'target'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> cloneEl <span class="token operator">=</span> tarEl<span class="token punctuation">.</span><span class="token function">cloneNode</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/* 执行样式修改 cloneEl.style = ... */</span>
<span class="token comment" spellcheck="true">// 替换节点, 重新渲染</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">replaceChild</span><span class="token punctuation">(</span>cloneEl<span class="token punctuation">,</span> tarEl<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
</li>
</ol>
<h4 id="虚拟DOM-1"><a href="#虚拟DOM-1" class="headerlink" title="虚拟DOM"></a><strong>虚拟DOM</strong></h4><p>虽然通过以上操作能减少重新渲染的频率, 然而频繁调用 WEB API, 导致代码量大, 后期难以维护, 虚拟DOM的设计就是为了 <strong>解决浏览器性能问题, 减轻维护成本</strong>, 每次操作更新, 虚拟DOM不会立即操作真实DOM, 而是将更新的<code>diff</code>内容保存到本地JS对象中, 最终把这个JS对象一次性<code>attach</code>到DOM树上, 再进行渲染</p>
<pre class=" language-js"><code class="language-js"><span class="token comment" spellcheck="true">// 描述 &lt;p title="段落">这是p标签 &lt;span>这是span标签&lt;/span>&lt;/p></span>
<span class="token comment" spellcheck="true">// 模拟虚拟DOM设计</span>
<span class="token keyword">let</span> VNode <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'p'</span><span class="token punctuation">,</span>
  props<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    title<span class="token punctuation">:</span> <span class="token string">'段落'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  children<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token string">'这是p标签'</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      name<span class="token punctuation">:</span> <span class="token string">'span'</span><span class="token punctuation">,</span>
      props<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      children<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token string">'这是span标签'</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
<h4 id="Diff算法"><a href="#Diff算法" class="headerlink" title="Diff算法"></a><strong>Diff算法</strong></h4><p>虚拟DOM 和 真实DOM 是 <strong>强映射</strong> 关系, 内容更新通过 <strong>Diff算法</strong> 实现</p>
<ul>
<li><p>tree diff: <strong>DOM级别</strong>, 对比新旧DOM树, <strong>逐层对比</strong></p>
</li>
<li><p>component diff: <strong>组件级别</strong>, 在对比每一层DOM树时, 组件之间的对比, 先对比组件的<strong>类型</strong>(<code>name</code>), 类型相同, 暂时认为不需要被更新, 类型不同, 用新组件替换旧组件的位置</p>
</li>
<li><p>element diff: <strong>元素级别</strong>, 在组件中, 对比每个元素</p>
</li>
<li><p><code>key</code>: 元素/组件的<code>key</code>属性可以把 <strong>真实DOM</strong> 和 <strong>虚拟DOM</strong> 做一层 <strong>关联关系</strong></p>
<p><img src="/images/Diff.png" alt="Diff算法"></p>
</li>
</ul>
<h4 id="createElement接收的参数"><a href="#createElement接收的参数" class="headerlink" title="createElement接收的参数"></a>createElement接收的参数</h4><pre class=" language-js"><code class="language-js"><span class="token function">createElement</span><span class="token punctuation">(</span>
    <span class="token comment" spellcheck="true">/**
     * @param1: [String, Object, Function]
     * required: true
     * HTML标签名字符串 或 组件选项对象
     * Vue 推荐使用 单文件组件(即组件选项对象)
     */</span>
    <span class="token string">'div'</span><span class="token punctuation">,</span>
    <span class="token comment" spellcheck="true">/**
     * @param2: Object
     * 一个与模板中属性对应的数据对象
     */</span>
    <span class="token punctuation">{</span>
      <span class="token comment" spellcheck="true">// class需要用'', 因为class在JS中是关键词</span>
      <span class="token comment" spellcheck="true">// 使用与 v-bind:class 相同, 可以是字符串, 数组或对象</span>
      <span class="token string">'class'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment" spellcheck="true">// 使用与 v-bind:style 相同, 可以是字符串, 对象或对象组成的数组</span>
      style<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment" spellcheck="true">// 普通HTML特性, 如 id 等</span>
      attrs<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment" spellcheck="true">// 组件 prop</span>
      props<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment" spellcheck="true">// DOM属性</span>
      domProps<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment" spellcheck="true">// 事件监听器, 不支持修饰符</span>
      on<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment" spellcheck="true">// 自定义指令</span>
      directives<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token comment" spellcheck="true">// 作用域插槽, name: props => VNode</span>
      scopedSlots<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token keyword">null</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment" spellcheck="true">// 命名插槽</span>
      slot<span class="token punctuation">:</span> <span class="token string">'name-of-slot'</span><span class="token punctuation">,</span>
      <span class="token comment" spellcheck="true">// 其他组件顶层特性</span>
      key<span class="token punctuation">:</span> <span class="token string">'myKey'</span><span class="token punctuation">,</span>
      ref<span class="token punctuation">:</span> <span class="token string">'myRef'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment" spellcheck="true">/**
     * @param3: [String, Array]
     * 文本虚拟节点 或 子集虚拟节点 (VNodes), 通过`createElement()`构建
     */</span>
    <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span>
</code></pre>
<h4 id="使用JSX"><a href="#使用JSX" class="headerlink" title="使用JSX"></a>使用JSX</h4><p>使用<code>JSX</code>能简化渲染函数的编写, 让<code>createElement</code>函数创建虚拟DOM更像编写<code>&lt;template&gt;</code>模板, 如:</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">/* 渲染一个简单的虚拟DOM
  &lt;div class="my-div">
      文本节点
      &lt;p title="欢迎">这是p标签&lt;span data-msg="dataset">这是span标签&lt;/span>&lt;/p>
      &lt;label for="user">用户&lt;/label>
      &lt;input type="text" id="user">
  &lt;/div>
  */</span>
  render<span class="token punctuation">:</span> h <span class="token operator">=</span><span class="token operator">></span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">'class'</span><span class="token punctuation">:</span> <span class="token string">'my-div'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
    <span class="token string">'文本节点'</span><span class="token punctuation">,</span>
    <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>attrs<span class="token punctuation">:</span> <span class="token punctuation">{</span>title<span class="token punctuation">:</span> <span class="token string">'欢迎'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
      <span class="token string">'这是p标签'</span><span class="token punctuation">,</span>
      <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>attrs<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'data-msg'</span><span class="token punctuation">:</span> <span class="token string">'dataset'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'这是span标签'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'label'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>attrs<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token keyword">for</span><span class="token punctuation">:</span> <span class="token string">'user'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'用户'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>attrs<span class="token punctuation">:</span> <span class="token punctuation">{</span>type<span class="token punctuation">:</span> <span class="token string">'text'</span><span class="token punctuation">,</span> id<span class="token punctuation">:</span> <span class="token string">'user'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>使用<code>JSX</code>语法糖后:</p>
<pre class=" language-jsx"><code class="language-jsx"><span class="token keyword">let</span> msg <span class="token operator">=</span> <span class="token string">'这是msg'</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'内容1'</span><span class="token punctuation">,</span> <span class="token string">'内容2'</span><span class="token punctuation">,</span> <span class="token string">'内容3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// JSX 语法糖还是调用 createElement 函数, 所以 h 形参必须接收</span>
  <span class="token comment" spellcheck="true">// 与 template 模板一样, 有且仅有一个根节点</span>
  <span class="token comment" spellcheck="true">// 括号提高优先级, 隔行使用JSX, 防止报错, 让JSX编写的虚拟DOM结构更明显</span>
  <span class="token comment" spellcheck="true">// 与react不同, vue中的class和for不必担心与js关键词/保留字冲突</span>
  <span class="token comment" spellcheck="true">// {} 内部是JS环境, 可书写JS表达式, 如使用变量, 三目表达式, 函数调用等</span>
  <span class="token comment" spellcheck="true">// jsx中注释通过 {</span><span class="token comment" spellcheck="true">/* 注释 */</span><span class="token punctuation">}</span> 书写<span class="token punctuation">,</span> 使用 <span class="token comment" spellcheck="true">// 注释注意转行</span>
  render<span class="token punctuation">:</span> h <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>my-div<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        文本节点
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>欢迎<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>这是p标签<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">data-msg</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>dataset<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>这是span标签<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>user<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>用户<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>user<span class="token punctuation">"</span>/</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token punctuation">{</span>msg<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
        <span class="token punctuation">{</span><span class="token comment" spellcheck="true">/*这是注释*/</span><span class="token punctuation">}</span>
        <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// 使用 // 注释, 不推荐这种注释 </span>
        <span class="token punctuation">}</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token punctuation">{</span>arr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token punctuation">=</span><span class="token punctuation">{</span>index<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>item<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h5 id="使用JSX的准备工作"><a href="#使用JSX的准备工作" class="headerlink" title="使用JSX的准备工作"></a><strong>使用<code>JSX</code>的准备工作</strong></h5><ol>
<li><p>安装<code>babel</code>预设依赖</p>
<pre class=" language-node"><code class="language-node">npm install babel-preset-jsx babel-transform-vue-jsx babel-helper-vue-jsx-merge-props
</code></pre>
</li>
<li><p>修改<code>.babelrc</code></p>
<pre class=" language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"presets"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">"env"</span><span class="token punctuation">,</span>
    <span class="token string">"stage-0"</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"plugins"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">"transform-runtime"</span><span class="token punctuation">,</span>
    <span class="token string">"transform-vue-jsx"</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
</li>
</ol>
<h3 id="设置路由系统"><a href="#设置路由系统" class="headerlink" title="设置路由系统"></a>设置路由系统</h3><ol>
<li><p>安装<code>vue-router</code></p>
<pre class=" language-node"><code class="language-node">npm i -S vue-router
</code></pre>
</li>
<li><p><code>src</code>目录下新建<code>router</code>文件夹, 文件夹下新建<code>index.js</code></p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">"vue"</span>
<span class="token comment" spellcheck="true">// 引入vue-router</span>
<span class="token keyword">import</span> VueRouter <span class="token keyword">from</span> <span class="token string">"vue-router"</span>
<span class="token comment" spellcheck="true">// src目录下新建views文件夹, 存放路由页面组件</span>
<span class="token keyword">import</span> Home <span class="token keyword">from</span> <span class="token string">"../views/Home"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Topic <span class="token keyword">from</span> <span class="token string">"../views/Topic"</span>
<span class="token keyword">import</span> Category <span class="token keyword">from</span> <span class="token string">"../views/Category"</span>
<span class="token keyword">import</span> Cart <span class="token keyword">from</span> <span class="token string">"../views/Cart"</span>
<span class="token keyword">import</span> Mine <span class="token keyword">from</span> <span class="token string">"../views/Mine"</span>

<span class="token comment" spellcheck="true">// 安装vue插件, 相当于扩展Vue的原型对象</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>VueRouter<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 定义路由系统</span>
<span class="token keyword">let</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  routes<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> redirect<span class="token punctuation">:</span> <span class="token string">'/home'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'/home'</span><span class="token punctuation">,</span> component<span class="token punctuation">:</span> Home<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'/category'</span><span class="token punctuation">,</span> component<span class="token punctuation">:</span> Category<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'/topic'</span><span class="token punctuation">,</span> component<span class="token punctuation">:</span> Topic<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'/cart'</span><span class="token punctuation">,</span> component<span class="token punctuation">:</span> Cart<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'/mine/:id'</span><span class="token punctuation">,</span> component<span class="token punctuation">:</span> Mine<span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 导出路由系统</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> router<span class="token punctuation">;</span>
</code></pre>
</li>
<li><p>改造<code>main.js</code></p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">"vue"</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">"./App"</span>
<span class="token comment" spellcheck="true">// 引入路由系统</span>
<span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">"./router"</span>

<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  router<span class="token punctuation">,</span>
  render<span class="token punctuation">:</span> h <span class="token operator">=</span><span class="token operator">></span> <span class="token function">h</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
</li>
</ol>
<h4 id="异步组件-懒加载"><a href="#异步组件-懒加载" class="headerlink" title="异步组件(懒加载)"></a>异步组件(懒加载)</h4><p>在当前路由系统中, 所有路由页面组件是在访问网页时全部加载到<code>bundle.js</code>中的, 随着项目的增大, 这可能会导致 <strong>页面加载速度变慢</strong></p>
<p><img src="/images/allReq.png" alt="同步加载所有组件"></p>
<p>此时需要改造路由系统, 让<code>/category</code>,<code>/topic</code>,<code>/cart</code>,<code>/mine</code>路由对应的视图组件, 异步加载, 即 <strong>进入路由后再加载</strong></p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">let</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  routes<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> redirect<span class="token punctuation">:</span> <span class="token string">'/home'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'/home'</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">'home'</span><span class="token punctuation">,</span> component<span class="token punctuation">:</span> Home<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'/category'</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">'category'</span><span class="token punctuation">,</span> component<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'../views/Category'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'/topic'</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">'topic'</span><span class="token punctuation">,</span> component<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'../views/Topic'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'/cart'</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">'cart'</span><span class="token punctuation">,</span> component<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'../views/Cart'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'/mine/:id'</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">'mine'</span><span class="token punctuation">,</span> component<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'../views/Mine'</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p><img src="/images/asyncReq.png" alt="异步加载组件"></p>
<p>网页初次加载时, 使用了异步加载的路由系统的<code>bundle.js</code>会比全部加载的小( 大小与项目大小有关 )</p>
<p>切换路由时, 对应的<code>(0-3).bundle.js</code> 就是我们异步加载的视图组件( <strong>按需加载</strong> )</p>
<p><img src="/images/asyncCom.png" alt="切换路由时网络请求"></p>
<p>为了区分是加载的是哪个组件</p>
<ol>
<li><p>在<code>webpack.config.js</code>输出<code>output</code>字段中设置<code>chunkFileName</code></p>
<pre class=" language-js"><code class="language-js">output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  path<span class="token punctuation">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'./dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  filename<span class="token punctuation">:</span> <span class="token string">"bundle.js"</span><span class="token punctuation">,</span>
  chunkFilename<span class="token punctuation">:</span> <span class="token string">"[name].bundle.js"</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
</li>
<li><p>异步引入时,<code>()=&gt;import(/* webpackChuckName: &#39;compName&#39; */ URL)</code></p>
<pre class=" language-js"><code class="language-js">routes<span class="token punctuation">:</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> redirect<span class="token punctuation">:</span> <span class="token string">'/home'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'/home'</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">'home'</span><span class="token punctuation">,</span> component<span class="token punctuation">:</span> Home<span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'/category'</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">'category'</span><span class="token punctuation">,</span> component<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment" spellcheck="true">/* webpackChunkName: 'category' */</span> <span class="token string">'../views/Category'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'/topic'</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">'topic'</span><span class="token punctuation">,</span> component<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment" spellcheck="true">/* webpackChunkName: 'topic' */</span> <span class="token string">'../views/Topic'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'/cart'</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">'cart'</span><span class="token punctuation">,</span> component<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment" spellcheck="true">/* webpackChunkName: 'cart' */</span> <span class="token string">'../views/Cart'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'/mine/:id'</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">'mine'</span><span class="token punctuation">,</span> component<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment" spellcheck="true">/* webpackChunkName: 'mine' */</span> <span class="token string">'../views/Mine'</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre>
<p><img src="/images/chunkname.png" alt="webpackChunkName"></p>
</li>
</ol>
<h4 id="使用历史-HistoryAPI-模式"><a href="#使用历史-HistoryAPI-模式" class="headerlink" title="使用历史(HistoryAPI)模式"></a>使用历史(HistoryAPI)模式</h4><p>在 <font color="yellowgreen"><strong>vue-router</strong></font> 部分, 我们提及过使用<code>history</code>模式时需要 <strong>后台配置支持</strong>, 不然刷新页面会报 <font color="tomato"><strong>404</strong></font> 错误, 在webpack中, 我们可以通过<code>devserver</code><strong>配置项</strong>实现使用<code>history</code>模式</p>
<ol>
<li><p>路由系统<code>src/router/index.js</code>中配置<code>mode:&#39;history&#39;</code></p>
</li>
<li><p>修改<code>webpack.config.js</code></p>
<pre class=" language-js"><code class="language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  mode<span class="token punctuation">:</span> <span class="token string">'development'</span><span class="token punctuation">,</span>
  entry<span class="token punctuation">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'./src/main.js'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    path<span class="token punctuation">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'./dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    filename<span class="token punctuation">:</span> <span class="token string">"bundle.js"</span><span class="token punctuation">,</span>
    chunkFilename<span class="token punctuation">:</span> <span class="token string">"[name].bundle.js"</span><span class="token punctuation">,</span>
    <span class="token comment" spellcheck="true">// 解决动态路由404问题</span>
    publicPath<span class="token punctuation">:</span> <span class="token string">"/"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token comment" spellcheck="true">/* 插件 */</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">/* 模块处理 */</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  resolve<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">/* 问题处理 */</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  devServer<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 以下三项就是 `package.json`中 "script" 字段 "start" 脚本的配置项</span>
    open<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    port<span class="token punctuation">:</span> <span class="token number">9999</span><span class="token punctuation">,</span>
    hot<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment" spellcheck="true">// 开启history API</span>
    historyApiFallback<span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  devtool<span class="token punctuation">:</span> <span class="token string">"cheap-module-eval-source-map"</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
</li>
</ol>
<h2 id="Vuex"><a href="#Vuex" class="headerlink" title="Vuex"></a>Vuex</h2><p>Vuex 是 Vue 官方为 Vue.js 应用程序开发维护的 <strong>状态管理模式</strong>, 它采用集中式存储管理用用的所有组件的状态, 并以相应的规则保证状态以一种可预测的方式发生变化</p>
<h3 id="状态管理模式"><a href="#状态管理模式" class="headerlink" title="状态管理模式"></a>状态管理模式</h3><p>首先, 每个单文件组件(<code>.vue</code>)就是一个 <strong>状态自管理应用</strong>, 如以下一个简单的 <strong>计步器</strong> 应用</p>
<pre class=" language-html"><code class="language-html">// view
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>当前步数: {{num}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>increment<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>加一<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>decrement<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>减一<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">"App"</span><span class="token punctuation">,</span>
    <span class="token comment" spellcheck="true">// state</span>
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        num<span class="token punctuation">:</span> <span class="token number">0</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment" spellcheck="true">// actions</span>
    methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>num<span class="token operator">++</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">decrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>num<span class="token operator">--</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
<p>一个 <strong>状态自管理应用</strong> 包含:</p>
<ul>
<li><strong>state</strong>, 驱动应用的数据源</li>
<li><strong>view</strong>, 以声明的方式将 <strong>state</strong> 映射到视图中</li>
<li><strong>actions</strong>, 响应在 <strong>view</strong> 的用户操作导致的 <strong>state</strong> 变化</li>
</ul>
<p>三者形成一个 <strong>单向数据流</strong> </p>
<p><img src="/images/flow.png" alt="单向数据流"></p>
<p>然而, 如果是 <strong>多组件共享状态</strong> 时, 单向数据流就会被破坏:</p>
<ul>
<li>多个 <strong>view</strong> 依赖于同一个 <strong>state</strong></li>
<li>不同组件的 <strong>actions</strong> 更改同一个 <strong>state</strong></li>
</ul>
<p>在 <strong>组件通信</strong> 部分, 我们提及到组件间通信, 可通过</p>
<ol>
<li>嵌套组件, 父向子 <strong>传参</strong></li>
<li>嵌套组件, 通过 <strong>自定义事件</strong> 实现子向父通信</li>
</ol>
<p>然而如果是 <strong>多层嵌套</strong> 的组件, <strong>传参</strong> 或者 <strong>自定义事件</strong> 都会相当繁琐, 而且对于 <strong>兄弟组件</strong> 的状态传递无能为力, 这时候您可能会想到使用 <strong>中央事件总线</strong>, 然而这种方法在 <strong>模块化开发</strong> 时, 并不好维护:</p>
<ol>
<li><p><code>src</code>目录下创建<code>Bus.js</code></p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">"vue"</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> Bus <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Bus
</code></pre>
</li>
<li><p>将 <strong>计步器</strong> 应用拆分成3个组件, 存放在<code>src/components</code>中</p>
<p>a) <code>App.vue</code>中</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>show-num</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>show-num</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>incre-btn</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>incre-btn</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>decre-btn</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>decre-btn</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
  <span class="token keyword">import</span> ShowNum <span class="token keyword">from</span> <span class="token string">"./components/ShowNum"</span><span class="token punctuation">;</span>
  <span class="token keyword">import</span> IncreBtn <span class="token keyword">from</span> <span class="token string">"./components/IncreBtn"</span><span class="token punctuation">;</span>
  <span class="token keyword">import</span> DecreBtn <span class="token keyword">from</span> <span class="token string">"./components/DecreBtn"</span><span class="token punctuation">;</span>

  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">"App"</span><span class="token punctuation">,</span>
    components<span class="token punctuation">:</span> <span class="token punctuation">{</span>DecreBtn<span class="token punctuation">,</span> IncreBtn<span class="token punctuation">,</span> ShowNum<span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
<p>b) ShowNum 组件</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>当前步数: {{num}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
  <span class="token comment" spellcheck="true">// 导入 Bus</span>
  <span class="token keyword">import</span> Bus <span class="token keyword">from</span> <span class="token string">"../Bus"</span><span class="token punctuation">;</span>

  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">"ShowNum"</span><span class="token punctuation">,</span>
    <span class="token comment" spellcheck="true">// 私有数据</span>
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        num<span class="token punctuation">:</span> <span class="token number">0</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment" spellcheck="true">// 私有数据初始化完成后, 给Bus绑定2自定义事件, 操作私有数据num</span>
      Bus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'add'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">this</span><span class="token punctuation">.</span>num<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      Bus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'subtract'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">this</span><span class="token punctuation">.</span>num<span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>

</code></pre>
<p>c) IncreBtn 组件</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>increment<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>加一<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
  <span class="token comment" spellcheck="true">// 导入 Bus</span>
  <span class="token keyword">import</span> Bus <span class="token keyword">from</span> <span class="token string">"../Bus"</span><span class="token punctuation">;</span>

  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">"IncreBtn"</span><span class="token punctuation">,</span>
    methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// 触发Bus自定义事件 add</span>
        Bus<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'add'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
<p>d) DecreBtn组件</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>decrement<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>减一<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
  <span class="token keyword">import</span> Bus <span class="token keyword">from</span> <span class="token string">"../Bus"</span><span class="token punctuation">;</span>

  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">"DecreBtn"</span><span class="token punctuation">,</span>
    methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token function">decrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Bus<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'subtract'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
</li>
</ol>
<p>这样改造后, 能达到不同组件的 <strong>actions</strong> 影响同一 <strong>state</strong> 的效果, 要想实现多组件共享同一 <strong>state</strong>, 需要继续改造:</p>
<ol>
<li><p><code>Bus.js</code></p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">"vue"</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> Bus <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// state</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    num<span class="token punctuation">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment" spellcheck="true">// actions</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>num<span class="token operator">++</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">subtract</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>num<span class="token operator">--</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Bus
</code></pre>
</li>
<li><p><code>ShowNum.vue</code></p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>当前步数: {{num}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
  <span class="token keyword">import</span> Bus <span class="token keyword">from</span> <span class="token string">"../Bus"</span><span class="token punctuation">;</span>

  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">"ShowNum"</span><span class="token punctuation">,</span>
    computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token comment" spellcheck="true">// 通过computed获取Bus.num</span>
      num<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> Bus<span class="token punctuation">.</span>num
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment" spellcheck="true">// 必须加setter, 否则vue会报错</span>
        <span class="token keyword">set</span><span class="token punctuation">(</span>newVal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
</li>
<li><p><code>IncreBtn.vue</code></p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>{{num}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>increment<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>加一<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
  <span class="token keyword">import</span> Bus <span class="token keyword">from</span> <span class="token string">"../Bus"</span><span class="token punctuation">;</span>

  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">"IncreBtn"</span><span class="token punctuation">,</span>
    computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      num<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> Bus<span class="token punctuation">.</span>num
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token keyword">set</span><span class="token punctuation">(</span>newVal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// 触发Bus的add方法</span>
        Bus<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
</li>
<li><p><code>DecreBtn.vue</code></p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>{{num}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>decrement<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>减一<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
  <span class="token keyword">import</span> Bus <span class="token keyword">from</span> <span class="token string">"../Bus"</span><span class="token punctuation">;</span>

  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">"DecreBtn"</span><span class="token punctuation">,</span>
    computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      num<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> Bus<span class="token punctuation">.</span>num
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token keyword">set</span><span class="token punctuation">(</span>newVal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token function">decrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Bus<span class="token punctuation">.</span><span class="token function">subtract</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
</li>
</ol>
<p>显然, 使用<code>Bus</code>实现 <strong>多组件共享状态</strong> 有以下缺点:</p>
<ol>
<li>每个组件需要导入<code>Bus.js</code></li>
<li>获取共享 <strong>state</strong> 需要通过<code>computed</code>, 而且必须有<code>setter</code></li>
</ol>
<h3 id="起步-2"><a href="#起步-2" class="headerlink" title="起步"></a>起步</h3><p>Vuex 应用的核心就是<code>store</code>(仓库), <code>store</code>是一个容器, 包含应用中的 <strong>共享状态( state )</strong>, 和单纯的全局对象有2点不同:</p>
<ol>
<li><p>Vuex 的状态存储是响应式的, 即当 Vue 组件从<code>store</code>中读取状态时, 如果<code>store</code>中状态发生变化, 组件也会相应的高效更新</p>
</li>
<li><p>你不能直接改变<code>store</code>中的状态, 改变<code>store</code>状态唯一的途径是显式地 <strong>提交 (commit) mutation</strong>, 这使我们可以方便地追踪每一个状态的变化, 从而让我们能够实现一些工具帮助我们更好地了解我们的应用</p>
<p><img src="/images/vuex.png" alt="Vuex"></p>
</li>
</ol>
<h3 id="创建第一个store"><a href="#创建第一个store" class="headerlink" title="创建第一个store"></a>创建第一个store</h3><ol>
<li><p>下载<code>vuex</code></p>
<pre class=" language-node"><code class="language-node">npm i -S vuex
</code></pre>
</li>
<li><p>创建<code>store</code>, 在<code>src/store</code>目录下创建<code>index.js</code></p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">"vue"</span>
<span class="token keyword">import</span> Vuex <span class="token keyword">from</span> <span class="token string">"vuex"</span>

<span class="token comment" spellcheck="true">// 显式安装Vuex, 相当于当前项目所有Vue实例(组件)共享store</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Vuex<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// 详细的配置项即概念在下一节介绍</span>
  state<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    num<span class="token punctuation">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  mutations<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">increment</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>num<span class="token operator">++</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">decrement</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>num<span class="token operator">--</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> store
</code></pre>
</li>
<li><p>导入<code>store</code></p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">"vue"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">"./App"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">"./store"</span><span class="token punctuation">;</span>

<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  store<span class="token punctuation">,</span>
  render<span class="token punctuation">:</span> h <span class="token operator">=</span><span class="token operator">></span> <span class="token function">h</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
</li>
<li><p>在<code>App.vue</code>中打印<code>this</code></p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>show-num</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>show-num</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>incre-btn</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>incre-btn</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>decre-btn</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>decre-btn</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
  <span class="token keyword">import</span> ShowNum <span class="token keyword">from</span> <span class="token string">"./components/ShowNum"</span><span class="token punctuation">;</span>
  <span class="token keyword">import</span> IncreBtn <span class="token keyword">from</span> <span class="token string">"./components/IncreBtn"</span><span class="token punctuation">;</span>
  <span class="token keyword">import</span> DecreBtn <span class="token keyword">from</span> <span class="token string">"./components/DecreBtn"</span><span class="token punctuation">;</span>

  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">"App"</span><span class="token punctuation">,</span>
    components<span class="token punctuation">:</span> <span class="token punctuation">{</span>DecreBtn<span class="token punctuation">,</span> IncreBtn<span class="token punctuation">,</span> ShowNum<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
<p><img src="/images/$store.png" alt="vm.$store"></p>
<p>此时, Vue 实例中, <code>vm.$store</code>就是我们刚创建的仓库<code>store</code></p>
</li>
<li><p>修改<code>ShowNum.vue</code></p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>当前步数: {{num}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">"ShowNum"</span><span class="token punctuation">,</span>
    computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token comment" spellcheck="true">// 依然通过computed读取共享state</span>
      <span class="token function">num</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>num
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
</li>
<li><p>修改<code>IncreBtn.vue</code></p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>{{num}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>increment<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>加一<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">"IncreBtn"</span><span class="token punctuation">,</span>
    computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token function">num</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>num
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// 通过commit触发mutation修改共享state</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'increment'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
</li>
<li><p>修改<code>DecreBtn.vue</code></p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>{{num}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>decrement<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>减一<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">"DecreBtn"</span><span class="token punctuation">,</span>
    computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token function">num</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>num
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token function">decrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'decrement'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
</li>
</ol>
<h3 id="核心概念"><a href="#核心概念" class="headerlink" title="核心概念"></a>核心概念</h3><h4 id="State"><a href="#State" class="headerlink" title="State"></a>State</h4><p>Vuex 使用 <strong>单一状态树</strong>, 即用一个对象管理一个单页面应用( <strong>SPA</strong> )所有的共享状态, 因此, 每个应用有且仅有一个<code>store</code>实例, 这样的处理能让我们直接快速地定位到某一特定的状态片段</p>
<p><strong>注意点: 在 Vue 根实例中设置<code>store</code>配置项后, 所有子组件将共享仓库( 即将 store 实例注入到每个组件中 )</strong> </p>
<p>Vuex 的状态存储是 <strong>响应式</strong> 的, 储存到<code>state</code>中, 而组件想获取 <strong>store</strong> 实例中的状态, 可以通过<code>vm.$store.state</code>获取共享状态对象, 如</p>
<pre class=" language-html"><code class="language-html">// src/components/ShowNum.vue 中
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
  <span class="token comment" spellcheck="true">&lt;!-- 在模板中直接使用 --></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>当前步数: {{$store.state.num}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>
</code></pre>
<p>为了保持模板简洁, 最简单的方法是在 <font color="yellowgreen"><strong>计算属性</strong></font> (<code>computed</code>)中返回某个状态</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>当前步数: {{num}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">"ShowNum"</span><span class="token punctuation">,</span>
    computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token function">num</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>num
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
<p>然而, 当一个组件要获取 <strong>store</strong> 实例中多个状态时, 如</p>
<pre class=" language-js"><code class="language-js"><span class="token comment" spellcheck="true">// src/store/index.js 中</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  state<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    num<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    msg<span class="token punctuation">:</span> <span class="token string">'共享状态'</span><span class="token punctuation">,</span>
    list<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'el1'</span><span class="token punctuation">,</span> <span class="token string">'el2'</span><span class="token punctuation">,</span> <span class="token string">'el3'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<pre class=" language-js"><code class="language-js"><span class="token comment" spellcheck="true">// src/components/ShowNum.vue 中</span>
computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token function">num</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>num
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">msg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>msg
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>list
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>随着需要的状态增多, <code>computed</code>中代码就会显得非常臃肿, 不方便维护, 此时, Vue 提供了<code>mapState</code>辅助函数帮助我们生成计算属性</p>
<pre class=" language-js"><code class="language-js"><span class="token comment" spellcheck="true">// 引入辅助函数</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>mapState<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vuex"</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// ...省略</span>
computed<span class="token punctuation">:</span> <span class="token function">mapState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// 使用箭头函数, 让代码更简洁  </span>
  num<span class="token punctuation">:</span> state <span class="token operator">=</span><span class="token operator">></span> state<span class="token punctuation">.</span>num<span class="token punctuation">,</span>
  <span class="token comment" spellcheck="true">// 传字符串, 相当于 numAlias: state => state.num</span>
  <span class="token comment" spellcheck="true">// 重命名</span>
  numAlias<span class="token punctuation">:</span> <span class="token string">'num'</span><span class="token punctuation">,</span>
  msg<span class="token punctuation">:</span> <span class="token string">'msg'</span><span class="token punctuation">,</span>
  list<span class="token punctuation">:</span> <span class="token string">'list'</span><span class="token punctuation">,</span>
  <span class="token comment" spellcheck="true">// 返回值需要this时, 必须使用普通函数</span>
  <span class="token function">localMsg</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>msg <span class="token operator">+</span> <span class="token string">'local'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>当键值对一样时, 如<code>msg: &#39;msg&#39;</code>, 可以给<code>mapState</code>传入一个字符串数组</p>
<pre class=" language-js"><code class="language-js">computed<span class="token punctuation">:</span> <span class="token function">mapState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'num'</span><span class="token punctuation">,</span> <span class="token string">'msg'</span><span class="token punctuation">,</span> <span class="token string">'list'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre>
<p>以上改造可知, <code>mapState</code>函数返回的是一个对象, 我们可以通过<code>ES6</code>的对象扩散符<code>...</code>将它和局部计算属性混合使用</p>
<pre class=" language-js"><code class="language-js">computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span><span class="token function">mapState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'num'</span><span class="token punctuation">,</span> <span class="token string">'msg'</span><span class="token punctuation">,</span> <span class="token string">'list'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">localMsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>msg <span class="token operator">+</span> <span class="token string">'local'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p><strong>注意点: 使用<code>mapState</code>辅助函数后, 在<code>vue-devtools</code>中的数据展示更直观:</strong></p>
<p><img src="/images/mapState.png" alt="mapState"></p>
<h4 id="Getter"><a href="#Getter" class="headerlink" title="Getter"></a>Getter</h4><p>与 Vue 实例的<code>computed</code>类似, 相当于<code>store</code>的计算属性, <code>getter</code>的返回值会根据它的依赖被缓存起来, 依赖发生变化才会被重新计算, 如一个简单的 <strong>todo list</strong></p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  state<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 全部任务</span>
    todo<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>id<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> text<span class="token punctuation">:</span> <span class="token string">'内容1'</span><span class="token punctuation">,</span> done<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> urgent<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>id<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> text<span class="token punctuation">:</span> <span class="token string">'内容2'</span><span class="token punctuation">,</span> done<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> urgent<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>id<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> text<span class="token punctuation">:</span> <span class="token string">'内容3'</span><span class="token punctuation">,</span> done<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> urgent<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>id<span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span> text<span class="token punctuation">:</span> <span class="token string">'内容4'</span><span class="token punctuation">,</span> done<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> urgent<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>id<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> text<span class="token punctuation">:</span> <span class="token string">'内容5'</span><span class="token punctuation">,</span> done<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> urgent<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  getters<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 接收 state 作为第一个参数</span>
    <span class="token comment" spellcheck="true">// 筛选已完成任务</span>
    <span class="token function">done</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> state<span class="token punctuation">.</span>todo<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>item <span class="token operator">=</span><span class="token operator">></span> item<span class="token punctuation">.</span>done<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment" spellcheck="true">// 筛选未完成任务</span>
    <span class="token function">undo</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> state<span class="token punctuation">.</span>todo<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>item <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">!</span>item<span class="token punctuation">.</span>done<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment" spellcheck="true">// 接收 getters 作为第二个参数</span>
    <span class="token comment" spellcheck="true">// 筛选紧急的未完成任务</span>
    <span class="token function">urgent</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> getters<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> getters<span class="token punctuation">.</span>undo<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>item <span class="token operator">=</span><span class="token operator">></span> item<span class="token punctuation">.</span>urgent<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>在组件中打印<code>this.$store</code></p>
<p><img src="/images/getters.png" alt="getters"></p>
<p><code>getters</code>的三个列表以存储在<code>this.$store.getters</code>中, 与<code>state</code>一样, 通过<code>computed</code>获取返回三个列表</p>
<pre class=" language-js"><code class="language-js">computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>getters<span class="token punctuation">.</span>done
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">undo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>getters<span class="token punctuation">.</span>undo
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">urgent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>getters<span class="token punctuation">.</span>urgent
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Vue 同样提供<code>mapGetters</code>辅助函数, 便捷地将<code>getters</code>对象的属性扩散到局部计算属性中</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span>mapGetters<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vuex"</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// ...省略</span>
computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span><span class="token function">mapGetters</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'done'</span><span class="token punctuation">,</span> <span class="token string">'undo'</span><span class="token punctuation">,</span> <span class="token string">'urgent'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<p><font color="tomato"><strong>注意点</strong></font>: <code>mapGetters</code>与<code>mapState</code>不同, 没有<strong>函数的形式</strong>, 但可以通过<strong>对象形式重命名</strong></p>
<h4 id="Mutation"><a href="#Mutation" class="headerlink" title="Mutation"></a>Mutation</h4><p>更改 Vuex 中的状态的唯一方法是提交<code>mutation</code>, Vuex 中的<code>mutation</code>与事件非常类似, 即每个<code>mutation</code>都有一个字符串的 <strong>事件类型( type )</strong> 和一个 <strong>回调函数( handler )</strong>, 这个回调函数就是实际更新状态的地方, 如 <strong>计步器</strong></p>
<pre class=" language-js"><code class="language-js">mutations<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// 接收 state 作为第一个参数</span>
  <span class="token function">increment</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span>num<span class="token operator">++</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment" spellcheck="true">// 第二个参数 payload(载荷), 在提交 mutation 时, 传入额外的参数 </span>
  <span class="token comment" spellcheck="true">// payload 建议是一个对象, 这样处理可以让 mutation 更容易读取</span>
  <span class="token function">setNum</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> payload<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// state.num = payload</span>
    state<span class="token punctuation">.</span>num <span class="token operator">=</span> payload<span class="token punctuation">.</span>nelVal
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>在组件中提交<code>mutation</code>, 必须需要调用<code>commit</code>方法</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
    {{$store.state.num}}
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>$store.commit(<span class="token punctuation">'</span>increment<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>加一<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>$store.commit(<span class="token punctuation">'</span>setNum<span class="token punctuation">'</span>,{newVal:0})<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>重置<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
    <span class="token comment" spellcheck="true">&lt;!-- 还可以直接传入一个对象的, 事件类型通过 type: 'type' 传递 --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>$store.commit({type:<span class="token punctuation">'</span>setNum<span class="token punctuation">'</span>,newVal:10})<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>重置到10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>
</code></pre>
<p>同样, Vue 也提供<code>mapMutations</code>辅助函数, 将<code>mutations</code>中的方法混入到<code>methods</code>中</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
    <span class="token comment" spellcheck="true">&lt;!-- 使用 --></span>
    {{num}}
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>increment<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>加一<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>setNum({newVal:0})<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>重置<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>setNum({newVal:10})<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>重置到10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
  <span class="token keyword">import</span> <span class="token punctuation">{</span>mapMutations<span class="token punctuation">,</span> mapState<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vuex"</span><span class="token punctuation">;</span>

  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">"ListContent"</span><span class="token punctuation">,</span>
    <span class="token comment" spellcheck="true">// 使用辅助函数扩散</span>
    computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span><span class="token function">mapState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token comment" spellcheck="true">// 与mapGetters用法一样</span>
      <span class="token operator">...</span><span class="token function">mapMutations</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'increment'</span><span class="token punctuation">,</span> <span class="token string">'setNum'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
<p>注意点:</p>
<ol>
<li>Vuex 中的状态是响应式的, 所以<code>mutation</code>必须遵循 Vue 的响应规则, 具体查看 <strong>数组和对象的更新监测</strong></li>
<li><code>mutation</code><strong>必须是同步函数</strong>, Vuex 提供<code>action</code>专门处理异步操作</li>
</ol>
<h4 id="Action"><a href="#Action" class="headerlink" title="Action"></a>Action</h4><p><code>action</code>与<code>mutation</code>类似, 区别在于:</p>
<ol>
<li><code>action</code>提交的是<code>mutation</code>, 而不是直接更改状态</li>
<li><code>action</code>可以包含任何 <strong>异步操作</strong></li>
</ol>
<p>注册一个<code>action</code></p>
<pre class=" language-js"><code class="language-js">actions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// 接收一个 context 参数, 表示当前action的上下文环境</span>
  <span class="token function">test</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>触发(分发,  <strong>diapatch</strong> )<code>action</code></p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
    <span class="token comment" spellcheck="true">&lt;!-- 直接使用vm.$store.dispatch调用 --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>$store.dispatch(<span class="token punctuation">'</span>test<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>dispatch<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
    <span class="token comment" spellcheck="true">&lt;!-- 使用辅助函数简化 --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>test<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>辅助函数<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
  <span class="token keyword">import</span> <span class="token punctuation">{</span>mapActions<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vuex"</span><span class="token punctuation">;</span>

  <span class="token comment" spellcheck="true">// ...省略</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// 与mutation相同, 使用辅助函数`mapActions`将`diapatch`映射到局部`method`中</span>
  <span class="token operator">...</span><span class="token function">mapActions</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'test'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
<p>分发<code>action</code>, 查看控制台打印结果</p>
<p><img src="/images/action.png" alt="context上下文"></p>
<p>从打印结果看, <code>context</code>上下文环境与<code>store</code>实例具有相同的方法和属性: <code>state</code>,<code>getters</code>,<code>commit</code>和<code>dispatch</code>, 但注意 <font color="tomato"><strong>它不是 store 实例本身</strong></font>, 在下一节 <strong>Modules</strong> 中介绍</p>
<p>在使用过程中, <code>context</code>参数一般通过 <strong>ES6</strong> 参数解构简化使用, 如 <strong>计步器</strong> 中</p>
<pre class=" language-js"><code class="language-js">actions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">{</span>state<span class="token punctuation">,</span> getters<span class="token punctuation">,</span> commit<span class="token punctuation">,</span> dispatch<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 之前提及过, 改变vuex中状态只能通过提交(commit) mutation 的方式改变</span>
    <span class="token comment" spellcheck="true">// 所以 context 上下文中的 state getters 最好只是读取属性</span>
    <span class="token comment" spellcheck="true">// 虽然 state.num++ 也会生效, 但违反了 vuex 的状态管理规则, 强烈不建议这样使用</span>
    <span class="token comment" spellcheck="true">// 此处是同步代码, 按顺序运行</span>
    <span class="token comment" spellcheck="true">// 因此打印的是 旧的 num</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'increment'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// 打印的是 更新后的 num</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p><code>action</code>同样支持载荷和对象方式进行分发:</p>
<ol>
<li><p><code>store</code>实例中定义<code>setNumAsync</code></p>
<pre class=" language-js"><code class="language-js">actions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token function">setNumAsync</span><span class="token punctuation">(</span><span class="token punctuation">{</span>commit<span class="token punctuation">}</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'setNum'</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</li>
<li><p>组件中分发<code>setNumAsync</code></p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>$store.dispatch({type:<span class="token punctuation">'</span>setNumAsync<span class="token punctuation">'</span>,newVal:10})<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>dispatch<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>setNumAsync({newVal:10})<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>辅助函数<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>
</code></pre>
</li>
</ol>
<p>在 <strong>计步器</strong> 案例中, 你可能会觉得使用 <strong>分发( dispatch )</strong> <code>action</code>会显得麻烦, 因为<code>increment</code>和<code>setNum</code>都是同步的, 但 <strong>涉及到调用异步API和分发多重mutation时</strong>, 就必须使用<code>action</code>, 如</p>
<pre class=" language-js"><code class="language-js"><span class="token comment" spellcheck="true">// 根据 payload 判断提交哪个 mutation</span>
<span class="token function">setNumAsync</span><span class="token punctuation">(</span><span class="token punctuation">{</span>commit<span class="token punctuation">}</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// payload 注意点</span>
  <span class="token comment" spellcheck="true">// 使用 @click="setNumAsync()" 即使用了括号时, 不传参数, payload为undefined</span>
  <span class="token comment" spellcheck="true">// 使用 @click="setNumAsync" payload为整个事件对象</span>
  <span class="token comment" spellcheck="true">// 直接使用 @click="setNumAsync('setNumAsync')" 不传参, payload为undefined</span>
  <span class="token comment" spellcheck="true">// 直接使用 @click="setNumAsync({type:'setNumAsync'})", payload就是{type:'setNumAsync'}</span>
  <span class="token comment" spellcheck="true">// mutation的payload同理</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>payload<span class="token punctuation">.</span>newVal<span class="token punctuation">)</span> <span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'setNum'</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">else</span> <span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'increment'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h5 id="组合action-高级用法"><a href="#组合action-高级用法" class="headerlink" title="组合action(高级用法)"></a>组合<code>action</code>(高级用法)</h5><p>因为<code>action</code>通常是处理异步操作, 而且接收当前<code>action</code>的上下文<code>context</code>, 因此可以通过组合<code>action</code>的方式处理复杂的异步操作</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  state<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    msg<span class="token punctuation">:</span> <span class="token string">'你好'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  mutations<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">update</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>msg <span class="token operator">=</span> <span class="token string">'我爱你'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">replace</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> payload<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>msg <span class="token operator">=</span> payload<span class="token punctuation">.</span>msg<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/(you|u|你|您)/gi</span><span class="token punctuation">,</span> <span class="token string">'Tenderness'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  actions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">actionA</span><span class="token punctuation">(</span><span class="token punctuation">{</span>state<span class="token punctuation">,</span> commit<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment" spellcheck="true">// actionA 返回一个Promise</span>
      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
          <span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'update'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token function">resolve</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">actionB</span><span class="token punctuation">(</span><span class="token punctuation">{</span>commit<span class="token punctuation">,</span> dispatch<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment" spellcheck="true">// diapatch 处理 actionA 返回的 Promise</span>
      <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'actionA'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
        <span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'replace'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>msg<span class="token punctuation">:</span> res<span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>最后还可以使用<code>async/await</code>让异步代码编写起来像同步代码, 方便维护, 如使用<code>fetch</code>(JS内置的Promise风格接口, 不支持IE)发送请求</p>
<pre class=" language-js"><code class="language-js">actions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">actionA</span><span class="token punctuation">(</span><span class="token punctuation">{</span>commit<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'urlA'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'saveDataA'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">async</span> <span class="token function">actionB</span><span class="token punctuation">(</span><span class="token punctuation">{</span>commit<span class="token punctuation">,</span> dispatch<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 等待 actionA 完成再发起新的请求</span>
    <span class="token keyword">await</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'actionA'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'urlB'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'saveDataB'</span><span class="token punctuation">,</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h4 id="Module"><a href="#Module" class="headerlink" title="Module"></a>Module</h4><p>由于 Vuex 使用单一状态树, 应用的所有共享状态都会集中在一个比较大的对象中, 因此随着项目的增大, <code>store</code>实例将会变得越来越臃肿, 为了解决这个问题, Vuex 允许我们将<code>store</code>分割成 <strong>模块( module )</strong>, 单独管理每个模块的<code>state</code>,<code>getter</code>,<code>mutation</code>,<code>action</code>, 甚至是字模块<code>module</code></p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  state<span class="token punctuation">:</span> <span class="token punctuation">{</span>msg<span class="token punctuation">:</span> <span class="token string">'根store'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  getters<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">resolveMsg</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token string">'这是'</span> <span class="token operator">+</span> state<span class="token punctuation">.</span>msg
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  mutations<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">update</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> payload<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'根store'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      state<span class="token punctuation">.</span>msg <span class="token operator">=</span> <span class="token string">'更新根store'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  actions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">doAction</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'根store'</span><span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  modules<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    moduleA<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">:</span> <span class="token punctuation">{</span>msg<span class="token punctuation">:</span> <span class="token string">'A模块'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      getters<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token function">resolveMsg</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment" spellcheck="true">// getter接收的state是当前模块的局部状态</span>
          <span class="token keyword">return</span> <span class="token string">'这是'</span> <span class="token operator">+</span> state<span class="token punctuation">.</span>msg
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      mutations<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// mutation接收的state也是当前模块的局部状态</span>
        <span class="token function">update</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> payload<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'模块A'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          state<span class="token punctuation">.</span>msg <span class="token operator">=</span> <span class="token string">'更新A模块'</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      actions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// context也是局部的, 在后面介绍</span>
        <span class="token function">doAction</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'模块A'</span><span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    moduleB<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">/* 状态 */</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      getters<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">/* 计算属性 */</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      mutations<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">/* 同步方法 */</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      actions<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">/* 异步方法 */</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      modules<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">/* 字模块 */</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>分割完模块, 在<code>App.js</code>中打印<code>this.$store.state</code></p>
<p><img src="/images/moduleState.png" alt="模块化state"></p>
<p>此时<code>state</code>已经分割成模块, 读取模块A的状态通过<code>vm.$store.state.moduleA.msg</code></p>
<p>然后, 我们再打印<code>this.$store.getters</code></p>
<p><img src="/images/moduleGetters.png" alt="模块化getters"></p>
<p>此时, 还有根store实例的<code>resolveMsg</code>, 并且 <strong>警告<code>resolveMsg</code>重复</strong></p>
<p>而且, 调用<code>this.$store.commit(&#39;update&#39;)</code>和<code>this.$store.dispatch(&#39;doAction&#39;)</code>, 将会同时调用根store以及模块A的<code>mutation</code>和<code>action</code></p>
<p><img src="/images/moduleM&amp;A.png" alt="同时触发mutation和action"></p>
<p>这是因为在 <strong>默认情况下</strong>, 模块内部<code>getter</code>,<code>mutation</code>和<code>action</code>是注册在 <strong>全局命名空间</strong> 的, 这样是为了 <strong>使多个模块对同一个<code>mutation</code>或<code>action</code>做出响应</strong>, 如果你想模块具有更高的 <strong>复用性</strong> 和 <strong>复用性</strong>, 需要通过配置<code>namespaced: true</code>让其成为带命名空间的模块:</p>
<pre class=" language-js"><code class="language-js">moduleA<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  namespaced<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token comment" spellcheck="true">// ...其他配置选项</span>
<span class="token punctuation">}</span>
</code></pre>
<p>配置完后, 打印结果</p>
<p><img src="/images/namespaced.png" alt="namespaced命名空间"></p>
<p>此时, <code>getter</code>已经区分了, 读取通过<code>this.$store.getters[&#39;moduleA/resolveMsg&#39;]</code></p>
<p>而调用<code>this.$store.commit(&#39;update&#39;)</code>和<code>this.$store.dispatch(&#39;doAction&#39;)</code>只会触发根store实例的方法</p>
<p>那么怎么触发模块的<code>mutation</code>和<code>action</code>呢? 再打印一下<code>this.$store</code></p>
<p><img src="/images/namespacedM&amp;A.png" alt="_mutation和_action"></p>
<p>在<code>_mutation</code>和<code>_action</code>中, 我们能发现模块A的<code>mutation</code>和<code>action</code>已经分块了, 也是只能通过<code>commit</code>和<code>dispatch</code>触发, 即:</p>
<ol>
<li><code>this.$store.commit(&#39;moduleA/update&#39;)</code></li>
<li><code>this.$store.dispatch(&#39;moduleA/doAction&#39;)</code></li>
</ol>
<p>编写到这, 你可能会觉得代码繁琐, 想起了 <strong>辅助函数</strong></p>
<pre class=" language-js"><code class="language-js">computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span><span class="token function">mapState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'moduleA'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token operator">...</span><span class="token function">mapGetters</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'moduleA/resolveMsg'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span><span class="token function">mapMutations</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'moduleA/update'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token operator">...</span><span class="token function">mapActions</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'moduleA/doAction'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre>
<p>这样做也确实扩散到当前组件实例中了</p>
<p><img src="/images/moduleMapState.png" alt="模块使用辅助函数"></p>
<p>在组件中<code>&lt;script&gt;</code>中使用是完全没有问题的</p>
<pre class=" language-js"><code class="language-js"><span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// 组件挂载完就打印模块A中的状态以及调用mutation和action</span>
  <span class="token comment" spellcheck="true">// 由于 '/' 在JS中是运算符, 因此只能通过[]中括号形式获取</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>moduleA<span class="token punctuation">.</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">[</span><span class="token string">'moduleA/resolveMsg'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">[</span><span class="token string">'moduleA/update'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">[</span><span class="token string">'moduleA/doAction'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>然而, 在<code>&lt;template&gt;</code>中, 需要手动绑定<code>this</code>去使用, 这也容易出现语法错误</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
    {{this['moduleA/resolveMsg']}}
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">:title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>this[<span class="token punctuation">'</span>moduleA/resolveMsg<span class="token punctuation">'</span>]<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>段落<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>this[<span class="token punctuation">'</span>moduleA/update<span class="token punctuation">'</span>]<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>按钮<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>
</code></pre>
<p>解决方案: 通过对象的形式使用(重命名), 后面的例子只修改<code>getter</code>, 其他2项改法一样</p>
<pre class=" language-js"><code class="language-js">computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span><span class="token function">mapState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// state也可以通过这方法, 模板中直接使用 a_msg</span>
    a_msg<span class="token punctuation">:</span> state <span class="token operator">=</span><span class="token operator">></span> state<span class="token punctuation">.</span>moduleA<span class="token punctuation">.</span>msg
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token operator">...</span><span class="token function">mapGetters</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 在模板直接使用 a_resolveMsg</span>
    <span class="token comment" spellcheck="true">// 相当于 state => state['moduleA/resolveMsg']</span>
    a_resolveMsg<span class="token punctuation">:</span> <span class="token string">'moduleA/resolveMsg'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<p>但是, 随着模块中<code>state</code>的增多,  甚至涉及到到多层 <strong>嵌套模块</strong> 时, 编写会越来麻烦, 如</p>
<pre class=" language-js"><code class="language-js">computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// a模块中嵌套sub模块, 提取sub模块的`msg`和`num`</span>
  <span class="token operator">...</span><span class="token function">mapState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    sub_msg<span class="token punctuation">:</span> state <span class="token operator">=</span><span class="token operator">></span> state<span class="token punctuation">.</span>moduleA<span class="token punctuation">.</span>sub<span class="token punctuation">.</span>msg<span class="token punctuation">,</span>
    sub_msg<span class="token punctuation">:</span> state <span class="token operator">=</span><span class="token operator">></span> state<span class="token punctuation">.</span>moduleA<span class="token punctuation">.</span>sub<span class="token punctuation">.</span>num<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<p>模块层级结构, 即<code>state.moduleA.sub</code>会重复多次, 此时你可以将命名空间名称字符串作为第一个参数传到辅助函数中</p>
<pre class=" language-js"><code class="language-js">computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span><span class="token function">mapState</span><span class="token punctuation">(</span><span class="token string">'moduleA/sub'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    sub_msg<span class="token punctuation">:</span> state <span class="token operator">=</span><span class="token operator">></span> state<span class="token punctuation">.</span>msg<span class="token punctuation">,</span>
    sub_num<span class="token punctuation">:</span> state <span class="token operator">=</span><span class="token operator">></span> state<span class="token punctuation">.</span>num<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<p>此时, 如果没有重名的<code>state</code>, (<code>getter</code>,<code>mutation</code>,<code>action</code>也一样), 可以改回数组形式</p>
<pre class=" language-js"><code class="language-js">computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span><span class="token function">mapState</span><span class="token punctuation">(</span><span class="token string">'moduleA/sub'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">,</span> <span class="token string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<p>最后, Vuex 还提供了了一个帮助函数<code>createNamespacedHelpers</code>, 用于创建基于某个命名空间的辅助函数, 它返回一个对象, 该对象有对应命名空间的辅助函数</p>
<pre class=" language-js"><code class="language-js"><span class="token comment" spellcheck="true">// 引入</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>createNamespacedHelpers<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vuex"</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// 解构, 如需创建多个模块的的辅助函数, 可以通过解构重命名解决</span>
<span class="token comment" spellcheck="true">// 如 const {mapState: subState, mapGetters: subGetters, mapMutations: subMutations, mapActions: subActions} = new createNamespacedHelpers('moduleA/sub');</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span>mapState<span class="token punctuation">,</span> mapGetters<span class="token punctuation">,</span> mapMutations<span class="token punctuation">,</span> mapActions<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">createNamespacedHelpers</span><span class="token punctuation">(</span><span class="token string">'moduleA/sub'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 使用</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span><span class="token function">mapState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">,</span> <span class="token string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">...</span><span class="token function">mapGetters</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token comment" spellcheck="true">/* 映射sub模块的getter */</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span><span class="token function">mapMutations</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token comment" spellcheck="true">/* 映射sub模块的mutation */</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">...</span><span class="token function">mapActions</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token comment" spellcheck="true">/* 映射sub模块的action */</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>在 <strong>Action</strong> 部分, 我们提及过<code>action</code>中接收的<code>context</code>参数 <strong>并不是 store 实例</strong>, 而是 <strong>当前 action 的上下文环境</strong></p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  state<span class="token punctuation">:</span> <span class="token punctuation">{</span>msg<span class="token punctuation">:</span> <span class="token string">'根store'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  actions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">doAction</span><span class="token punctuation">(</span><span class="token punctuation">{</span>state<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  modules<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    moduleA<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      namespaced<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      state<span class="token punctuation">:</span> <span class="token punctuation">{</span>msg<span class="token punctuation">:</span> <span class="token string">'A模块'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      actions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token function">doAction</span><span class="token punctuation">(</span><span class="token punctuation">{</span>state<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment" spellcheck="true">// 分发模块A的`doAction` 打印的是 'A模块'</span>
          <span class="token comment" spellcheck="true">// 同样context的getters, commit, dispatch也是局部的</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>然而, 带命名空间的模块有时也需要 <strong>访问全局内容</strong>, 因此在模块中, <code>rootState</code>和<code>rootGetters</code>会作为 <strong>第三和第四个参数传到<code>getter</code>中</strong>, 并 <strong>通过<code>context</code>传进<code>action</code>中</strong></p>
<pre class=" language-js"><code class="language-js">getters<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token function">getRootState</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> getter<span class="token punctuation">,</span> rootState<span class="token punctuation">,</span> rootGetters<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 获取全局state的msg</span>
    <span class="token keyword">return</span> rootState<span class="token punctuation">.</span>msg
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
actions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token function">doAction</span><span class="token punctuation">(</span><span class="token punctuation">{</span>rootState<span class="token punctuation">,</span> rootGetters<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 打印全局state的msg</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>rootState<span class="token punctuation">.</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>在模块<code>action</code>中, 如果想分发 <strong>提交全局</strong><code>mutation</code>或者 <strong>分发全局</strong><code>action</code>, 可将<code>{root: true}</code>作为第三参数传入当前上下文环境<code>context</code>的<code>commit</code>或<code>dispatch</code>即可</p>
<pre class=" language-js"><code class="language-js">actions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token function">doAction</span><span class="token punctuation">(</span><span class="token punctuation">{</span>commit<span class="token punctuation">,</span> dispatch<span class="token punctuation">,</span> rootState<span class="token punctuation">,</span> rootGetters<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 打印更新前的全局msg '根store'</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>rootState<span class="token punctuation">.</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// 提交全局的 update, 更新全局msg</span>
    <span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'update'</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>root<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// 分发全局的 doAction, 打印更新后的全局msg, '更新根store'</span>
    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'doAction'</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>root<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>命名空间模块的<code>action</code>还能 <strong>注册到全局</strong> 中</p>
<pre class=" language-js"><code class="language-js">actions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  doAction<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 设置 root: true 后, 当前命名空间模板将没有doAction</span>
    <span class="token comment" spellcheck="true">// 组件分发需要 this.$store.dispatch('doAction')</span>
    <span class="token comment" spellcheck="true">// 注意 action 类型重复</span>
    root<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token function">handler</span><span class="token punctuation">(</span>namespacedCtx<span class="token punctuation">,</span> payload<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment" spellcheck="true">// context 还是当前action的上下文</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>namespacedCtx<span class="token punctuation">.</span>state<span class="token punctuation">.</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="Vuex的表单处理"><a href="#Vuex的表单处理" class="headerlink" title="Vuex的表单处理"></a>Vuex的表单处理</h3><p>因为 Vuex 中改变状态的唯一方式是通过提交<code>mutation</code>, 所以, 当表单元素使用<code>v-model</code>绑定 Vuex 中状态时, <code>v-model</code>会 <strong>试图直接修改状态</strong>, 这明显违背了 Vuex 的规则</p>
<p>解决方法1:</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
  <span class="token comment" spellcheck="true">&lt;!-- 通过v-bind:value绑定msg状态, 监听input事件 --></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">:value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>msg<span class="token punctuation">"</span></span> <span class="token attr-name">@input</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>update<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
  <span class="token comment" spellcheck="true">// 省略import</span>
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 省略其他配置项</span>
    computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span><span class="token function">mapState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span><span class="token function">mapMutations</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'updateMsg'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token function">update</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// input事件提交mutation, 将输入框value值传进payload</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateMsg</span><span class="token punctuation">(</span><span class="token punctuation">{</span>newVal<span class="token punctuation">:</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
<p>解决方法2:</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
  <span class="token comment" spellcheck="true">&lt;!-- 通过v-model绑定msg --></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>msg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 省略其他配置项</span>
    computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token comment" spellcheck="true">// 通过getter, setter方式实现双向数据绑定</span>
      msg<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// getter 读取 msg 状态</span>
        <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>msg
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment" spellcheck="true">// setter 提交 mutation</span>
        <span class="token keyword">set</span><span class="token punctuation">(</span>newVal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'updateMsg'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>newVal<span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>

            </div>
            <hr>

            

            <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    <div class="social-share" data-disabled="qzone" data-wechat-qrcode-helper="<p>微信里点“发现”->“扫一扫”二维码便可查看分享。</p>"></div>
    
</div>

<script src="/libs/share/js/social-share.min.js"></script>

            

    <div class="reprint" id="reprint-statement">
        <p class="reprint-tip">
            <i class="fa fa-exclamation-triangle"></i>&nbsp;&nbsp;
            <span>转载规则</span>
        </p>
        
            <div class="center-align">
                <a rel="license" href="https://creativecommons.org/licenses/by/4.0/deed.zh">
                    <img alt style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png">
                </a>
            </div>
            <br>
            <span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/Text" property="dct:title" rel="dct:type">
                    《Vue + Webpack》
                </span> 由
            <a xmlns:cc="http://creativecommons.org/ns#" href="/2018/06/14/vue/" property="cc:attributionName" rel="cc:attributionURL">
                Tenderness
            </a> 采用
            <a rel="license" href="https://creativecommons.org/licenses/by/4.0/deed.zh">
                知识共享署名 4.0 国际许可协议
            </a>进行许可。
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>


        </div>
    </div>

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6 overflow-policy" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fa fa-dot-circle-o"></i>&nbsp;本篇
            </div>
            <div class="card">
                <a href="/2018/06/14/vue/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/14.jpg" class="responsive-img" alt="Vue + Webpack">
                        
                        <span class="card-title">Vue + Webpack</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            Vue和webpack总结
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="fa fa-clock-o fa-fw icon-date"></i>2018-06-14
                            </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Vue/" class="post-category" target="_blank">
                                    Vue
                                </a>
                            
                            
                        </span>
                    </div>
                </div>

                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Vue/" target="_blank">
                        <span class="chip bg-color">Vue</span>
                    </a>
                    
                    <a href="/tags/Webpack/" target="_blank">
                        <span class="chip bg-color">Webpack</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6 overflow-policy" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fa fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2018/06/08/js-obj-arr-str/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/1.jpg" class="responsive-img" alt="JS - 基础对象、数组、字符串">
                        
                        <span class="card-title">JS - 基础对象、数组、字符串</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            基础对象、数组和字符串的属性和方法
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="fa fa-clock-o fa-fw icon-date"></i>2018-06-08
                            </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/JavaScript/" class="post-category" target="_blank">
                                    JavaScript
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/String/" target="_blank">
                        <span class="chip bg-color">String</span>
                    </a>
                    
                    <a href="/tags/Object/" target="_blank">
                        <span class="chip bg-color">Object</span>
                    </a>
                    
                    <a href="/tags/Array/" target="_blank">
                        <span class="chip bg-color">Array</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>
</div>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="fa fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fa fa-list"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            // headingsOffset: -205,
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).slideUp(500);
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).slideDown(500);
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>
    

</main>


<footer class="page-footer bg-color">
    <div class="container row center-align">
        <div class="col s12 m8 l8 copy-right">
            本站由&copy;<a href="https://github.com/TendernessCJS" target="_blank">Tenderness</a>基于
            <a href="https://hexo.io/" target="_blank">Hexo</a> 的
            <a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">hexo-theme-matery</a>主题搭建.

            
                &nbsp;<i class="fa fa-area-chart"></i>&nbsp;站点总字数:&nbsp;
                <span class="white-color">47.8k</span>
            

            
			
                <br>
                
                <span id="busuanzi_container_site_pv">
                    <i class="fa fa-heart-o"></i>
                    本站总访问量 <span id="busuanzi_value_site_pv" class="white-color"></span>
                </span>
                
                
                <span id="busuanzi_container_site_uv">
                    <i class="fa fa-users"></i>
                    次,&nbsp;访客数 <span id="busuanzi_value_site_uv" class="white-color"></span> 人.
                </span>
                
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/TendernessCJS" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fa fa-github"></i>
    </a>



    <a href="mailto:ec_brucechen@163.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fa fa-envelope-open"></i>
    </a>



    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=403740868" class="tooltipped" data-tooltip="QQ联系我: 403740868" data-position="top" data-delay="50">
        <i class="fa fa-qq"></i>
    </a>


</div>
    </div>
</footer>

<div class="progress-bar"></div>


<!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fa fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字" class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
});
</script>
<!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fa fa-angle-up"></i>
    </a>
</div>


<script src="/libs/materialize/materialize.min.js"></script>
<script src="/libs/masonry/masonry.pkgd.min.js"></script>
<script src="/libs/aos/aos.js"></script>
<script src="/libs/scrollprogress/scrollProgress.min.js"></script>
<script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
<script src="/js/matery.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->



    <script src="/libs/others/clicklove.js"></script>


    <script async src="/libs/others/busuanzi.pure.mini.js"></script>


</body>
</html>